__d("BaseToast.react",["BaseInlinePressable.react","BaseTheme.react","BaseView.react","FocusRegion.react","focusScopeQueries","react","useCurrentDisplayMode"],function(t,e,n,r,i,o,s){"use strict";function t(t){var e=t.action,i=t.addOnStart,o=t.closeButton,s=t.linkWrapper,d=t.message,f=t.onDismiss,g=t.size;g=void 0===g?"full-width":g;var p=t.testid;p=t.toastRef,t=void 0===(t=t.useInvertedDisplayMode)||t;var _=n("useCurrentDisplayMode")();_="dark"===_?"light":"dark";var m=u(),v=l(function(){return null!=e?{}:{"aria-atomic":!0,role:"alert"}},[e]);return i=a.jsxs(a.Fragment,{children:[null!=i&&a.jsx(n("BaseView.react"),{xstyle:h.item,children:i}),a.jsx(n("BaseView.react"),babelHelpers["extends"]({xstyle:[h.item,h.itemText]},v,{children:d({toastMessageId:m})})),null!=e&&a.jsx(r("FocusRegion.react").FocusRegion,{autoFocusQuery:r("focusScopeQueries").tabbableScopeQuery,children:a.jsx(n("BaseView.react"),{"aria-labelledby":m,role:"group",xstyle:h.item,children:null!=e.element?e.element:e.labelRenderer&&e.labelRenderer(a.jsx(n("BaseInlinePressable.react"),{onPress:function(t){f(),e.onPress(t)},testid:void 0,xstyle:h.link,children:e.label}))})}),null!=o&&a.jsx(n("BaseView.react"),{xstyle:h.item,children:o})]}),i=null!=s?s(i):i,t?a.jsx(n("BaseTheme.react"),{config:c,displayMode:_,ref:p,testid:void 0,xstyle:[h.root,"full-width"===g&&h.rootFullWidth],children:i}):a.jsx(n("BaseView.react"),{ref:p,testid:void 0,xstyle:[h.root,"full-width"===g&&h.rootFullWidth],children:i})}var a=r("react"),u=(e=r("react")).useId,l=e.useMemo,c={dark:"__fb-dark-mode ",light:"__fb-light-mode ",type:"CLASSNAMES"},h={item:{display:"x78zum5",flexDirection:"xdt5ytf",paddingBottom:"x19yoh24",paddingEnd:"xpowjs8",paddingStart:"xrxijuk",paddingTop:"x6enp1t",$$css:!0},itemText:{flexGrow:"x1iyjqo2",$$css:!0},link:{wordBreak:"xdnwjd9",$$css:!0},root:{alignItems:"x6s0dn4",backgroundColor:"x1wkzo03",borderTopStartRadius:"x1192kqh",borderTopEndRadius:"xjfsc2c",borderBottomEndRadius:"xg8fqjl",borderBottomStartRadius:"x1kdh5me",boxShadow:"xi1c1fh",display:"x78zum5",flexShrink:"x2lah0s",maxWidth:"x1cs6qxi",minWidth:"x1hqenl9",paddingStart:"xuv3zuj",paddingEnd:"xd3owfx",paddingTop:"x192rfv7",paddingBottom:"x13jxccy",$$css:!0},rootFullWidth:{width:"xh8yej3",$$css:!0}};t.displayName=t.name+" [from "+o.id+"]",s["default"]=t},98),__d("CometToast.react",["fbt","ix","BaseToast.react","CometCircleButton.react","CometPressable.react","TetraText.react","fbicon","react"],function(t,e,n,r,i,o,s,a,u){"use strict";function t(t){var e=t.action,i=t.href,o=t.icon,s=t.impressionLoggingRef,d=t.message,f=t.onDismiss,g=t.supressCloseButton;g=void 0!==g&&g;var p=t.target,_=t.testid;_=void 0===_?"Toast":_;var m=void 0===(_=t.truncateText)||_,v=babelHelpers.objectWithoutPropertiesLoose(t,["action","href","icon","impressionLoggingRef","message","onDismiss","supressCloseButton","target","testid","truncateText"]),E=c(function(){return null!=i?{target:p,url:i}:void 0},[i,p]);return l.jsx(n("BaseToast.react"),{action:null!=e?{label:e.label,labelRenderer:function(t){return l.jsx(n("TetraText.react"),{color:"blueLink",numberOfLines:1,type:"body3",children:t})},onPress:e.onPress,testid:e.testid}:void 0,addOnStart:o,closeButton:!0!==g&&l.jsx(n("CometCircleButton.react"),{icon:r("fbicon")._(u("478231"),12),label:a._("Close"),onPress:f,size:24}),linkWrapper:null!=v.onPress||null!=E?function(t){return l.jsx(n("CometPressable.react"),babelHelpers["extends"]({},v,{expanding:!0,linkProps:E,xstyle:h.pressable,children:t}))}:void 0,message:function(t){return t=t.toastMessageId,l.jsx(n("TetraText.react"),{color:"primary",id:t,numberOfLines:m?4:void 0,type:"body3",children:d})},onDismiss:f,testid:void 0,toastRef:s})}var l=r("react"),c=r("react").useMemo,h={pressable:{alignItems:"x6s0dn4",display:"x78zum5",flexDirection:"x1q0g3np",width:"xh8yej3",$$css:!0}};t.displayName=t.name+" [from "+o.id+"]",s["default"]=t},98),__d("VideoPlayerWithLiveVideoInterruptedOverlay.react",["fbt","CometLoadingAnimation.react","TetraTextPairing.react","VideoPlayerHooks","VideoPlayerInteractionOverlay.react","react"],function(t,e,n,r,i,o,s,a){"use strict";function t(){var t=r("VideoPlayerHooks").useStreamInterrupted(),e=r("VideoPlayerHooks").useIsLiveRewindActive();return!t||e?null:u.jsx(r("VideoPlayerInteractionOverlay.react").VideoPlayerInteractionOverlay,{children:u.jsxs("div",{className:"x6s0dn4 x18l40ae x1ey2m1c x9f619 x78zum5 xds687c xdt5ytf xl56j7k x10l6tqk x17qophe x13vifvy",children:[u.jsx("div",{children:u.jsx(n("TetraTextPairing.react"),{body:a._("The broadcast is waiting for a signal. It should resume shortly."),bodyColor:"white",headline:a._("Waiting for Live Video Signal"),headlineColor:"white",level:2,textAlign:"center"})}),u.jsx("div",{className:"xc9qbxq x1sy10c2 x1n2onr6 x14qfxbe",children:u.jsx(n("CometLoadingAnimation.react"),{size:36})})]})})}var u=r("react");t.displayName=t.name+" [from "+o.id+"]",s["default"]=t},98),__d("EventListenerImplForCacheStorage",["CometEventListener"],function(t,e,n,r,i,o){"use strict";o["default"]=e("CometEventListener")},66),__d("TrustedTypesNoOpPolicy_DO_NOT_USE",["TrustedTypes","TrustedTypesUtils"],function(t,e,n,r,i,o,s){"use strict";t={createScriptURL:r("TrustedTypesUtils").noop,createHTML:r("TrustedTypesUtils").noop,createScript:r("TrustedTypesUtils").noop},i=n("TrustedTypes").createPolicy("noop-do-not-use",t),s["default"]=i},98),__d("TrustedTypesLinkTagHTMLPolicy",["TrustedTypes","err"],function(t,e,n,r,i,o,s){"use strict";t={createHTML:function(t){if("<link />"===t)return t;throw n("err")("Violating Trusted Type policies. Only works for '<link />' strings.")}},r=n("TrustedTypes").createPolicy("link-tag-html",t),s["default"]=r},98),__d("getMarkupWrap",["invariant","ExecutionEnvironment","TrustedTypesLinkTagHTMLPolicy"],function(t,e,n,r,i,o,s,a){function t(t){return t=t,!u&&a(0,144),Object.prototype.hasOwnProperty.call(h,t)||(t="*"),Object.prototype.hasOwnProperty.call(l,t)||(u.innerHTML="*"===t?n("TrustedTypesLinkTagHTMLPolicy").createHTML("<link />"):"<"+t+"></"+t+">",l[t]=!u.firstChild),l[t]?h[t]:null}var u=n("ExecutionEnvironment").canUseDOM?document.createElement("div"):null,l={},c=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],h={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:e=[1,'<select multiple="true">',"</select>"],option:e,caption:r=[1,"<table>","</table>"],colgroup:r,tbody:r,tfoot:r,thead:r,td:i=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:i};["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"].forEach(function(t){h[t]=c,l[t]=!0}),s["default"]=t},98),__d("createNodesFromMarkup",["invariant","ExecutionEnvironment","TrustedTypesNoOpPolicy_DO_NOT_USE","getMarkupWrap"],function(t,e,n,r,i,o,s,a){function u(t){return(t=t.match(c))&&t[1].toLowerCase()}function t(t,e){var r=l;!l&&a(0,5001);var i=u(t);if(i=i&&n("getMarkupWrap")(i))for(r.innerHTML=i[1]+t+i[2],i=i[0];i--;)r=r.lastChild;else r.innerHTML=n("TrustedTypesNoOpPolicy_DO_NOT_USE").createHTML(t);for((i=r.getElementsByTagName("script")).length&&(e||a(0,5002),Array.from(i).forEach(e)),t=Array.from(r.childNodes);r.lastChild;)r.removeChild(r.lastChild);return t}var l=n("ExecutionEnvironment").canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;s["default"]=t},98),__d("evalGlobal",[],function(t,e,n,r,i,o){function t(t){if("string"!=typeof t)throw new TypeError("JS sent to evalGlobal is not a string. Only strings are permitted.");if(t){var e=document.createElement("script");try{e.appendChild(document.createTextNode(t))}catch(n){e.text=t}(t=document.getElementsByTagName("head")[0]||document.documentElement).appendChild(e),t.removeChild(e)}}o["default"]=t},66),__d("HTML",["invariant","Bootloader","FBLogger","createNodesFromMarkup","emptyFunction","evalGlobal"],function(t,e,n,r,i,o,s){var a=/(<(\w+)[^>]*?)\/>/g,u={abbr:!0,area:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0};t=function(){"use strict";function t(n){if(n&&"string"==typeof n.__html&&(n=n.__html),!(this instanceof t))return n instanceof t?n:new t(n);if(n){var r=typeof n;"string"===r||s(0,277,r)}this._markup=n||"",this._defer=!1,this._nodes=null,this._inlineJS=e("emptyFunction"),this._rootNode=null,this._hasInlineJs=!1}var n=t.prototype;return n.toString=function(){return this._markup},n.getContent=function(){return this._markup},n.getNodes=function(){return this._fillCache(),this._nodes},n.getRootNode=function(){this._rootNode&&s(0,278);var t=this.getNodes();if(1===t.length)this._rootNode=t[0];else{for(var e=document.createDocumentFragment(),n=0;n<t.length;n++)e.appendChild(t[n]);this._rootNode=e}return this._rootNode},n.getAction=function(){var t=this;this._fillCache();var e=function(){t._inlineJS()};return this._defer?function(){setTimeout(e,0)}:e},n._fillCache=function(){if(null===this._nodes)if(this._markup){var t=this._markup.replace(a,function(t,e,n){return u[n.toLowerCase()]?t:e+"></"+n+">"}),n=null;t=e("createNodesFromMarkup")(t,function(t){e("FBLogger")("staticresources").warn("HTML: encountered script node while parsing, hasSrc=%s, type=%s",Boolean(t.src),null==t.type||""===t.type?"<unknown>":t.type),"application/ld+json"!==t.type&&"application/json"!==t.type&&((n=n||[]).push(t.src?e("Bootloader").requestJSResource_UNSAFE_NEEDS_REVIEW_BY_SECURITY_AND_XFN.bind(e("Bootloader"),t.src):e("evalGlobal").bind(null,t.innerHTML)),t.parentNode.removeChild(t))}),n&&(this._hasInlineJs=!0,this._inlineJS=function(){for(var t=0;t<n.length;t++)n[t]()}),this._nodes=t}else this._nodes=[]},n.setDeferred=function(t){return this._defer=!!t,this},n.hasInlineJs=function(){return this._hasInlineJs},t.isHTML=function(e){return!!e&&(e instanceof t||void 0!==e.__html)},t.replaceJSONWrapper=function(e){return e&&void 0!==e.__html?new t(e.__html):e},t}(),i.exports=t},null),__d("PolarisDiscoveryModuleFalcoEvent",["PolarisFalcoLogger","PolarisLogger","PolarisLoggerUtils"],function(t,e,n,r,i,o,s){"use strict";function a(t){return babelHelpers["extends"]({},r("PolarisLogger").getExtra(t),{objid:r("PolarisLoggerUtils").trimAndSanitizeUrl(window.location.href)})}var u={falco:!0,pigeon:!1};e={log:function(t){t=babelHelpers["extends"]({},a(t())),r("PolarisFalcoLogger").FalcoLogger.log("instagram_web_discovery_module",t,{},u)}},s["default"]=e},98),__d("PolarisLoggedOutExploreModuleLogger",["PolarisDiscoveryModuleFalcoEvent"],function(t,e,n,r,i,o,s){"use strict";function t(t){var e=t.component,r=t.containermodule,i=t.eventName,o=t.key;n("PolarisDiscoveryModuleFalcoEvent").log(function(){return babelHelpers["extends"]({containermodule:r,event_name:i,component:e},null!=o&&{category:o})})}s.logExploreModuleEvent=t},98),__d("ArbiterMixin",["Arbiter","guid"],function(t,e,n,r,i,o,s){var a="arbiter$"+n("guid")(),u=Object.prototype.hasOwnProperty;e={_getArbiterInstance:function(){return u.call(this,a)?this[a]:this[a]=new(n("Arbiter"))},inform:function(t,e,n){return this._getArbiterInstance().inform(t,e,n)},subscribe:function(t,e,n){return this._getArbiterInstance().subscribe(t,e,n)},subscribeOnce:function(t,e,n){return this._getArbiterInstance().subscribeOnce(t,e,n)},unsubscribe:function(t){this._getArbiterInstance().unsubscribe(t)},unsubscribeCurrentSubscription:function(){this._getArbiterInstance().unsubscribeCurrentSubscription()},releaseCurrentPersistentEvent:function(){this._getArbiterInstance().releaseCurrentPersistentEvent()},registerCallback:function(t,e){return this._getArbiterInstance().registerCallback(t,e)},query:function(t){return this._getArbiterInstance().query(t)}},s["default"]=e},98),__d("createArrayFromMixed",["invariant"],function(t,e,n,r,i,o,s,a){function u(t){var e=t.length;if(!Array.isArray(t)&&("object"==typeof t||"function"==typeof t)||a(0,3914),"number"==typeof e||a(0,3915),0===e||e-1 in t||a(0,3916),"function"!=typeof t.callee||a(0,3917),t.hasOwnProperty)try{return Array.prototype.slice.call(t)}catch(t){}for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}function l(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"length"in t&&!("setInterval"in t)&&"number"!=typeof t.nodeType&&(Array.isArray(t)||"callee"in t||"item"in t)}function t(t){return l(t)?Array.isArray(t)?t.slice():u(t):[t]}s["default"]=t},98),__d("isElementNode",["isNode"],function(t,e,n,r,i){function t(t){return e("isNode")(t)&&1==t.nodeType}i.exports=t},null),__d("DOMQuery",["CSS","FBLogger","containsNode","createArrayFromMixed","createObjectFrom","ge","ifRequired","isElementNode","isNode"],function(t,e,n,r,i,o,s){function a(t,e){return t.hasAttribute?t.hasAttribute(e):null!==t.getAttribute(e)}function t(t,e){return(t=u(t,e))[0]}function e(t,e,n){return e=u(t,e),t=u(t,n),(n=1===e.length&&1===t.length&&e[0]===t[0]?e:e.concat(t))[0]}function u(t,e){if(!t||!t.getElementsByTagName)return[];e=e.split(" ");for(var i=[t],o=0;o<e.length&&0!==i.length;o++)if(""!==e[o]){var s=e[o],u=e[o],l=[],c=!1;if("^"==s.charAt(0)){if(0!==o)return[];c=!0,s=s.slice(1)}var h=(s=(s=s.replace(/\[(?:[^=\]]*=(?:\"[^\"]*\"|\'[^\']*\'))?|[.#]/g," $&")).split(" "))[0]||"*",f="*"==h,g=s[1]&&"#"==s[1].charAt(0);if(g){if((g=n("ge")(s[1].slice(1),t,h))&&(f||g.tagName.toLowerCase()==h))for(var p=0;p<i.length;p++){if(c&&n("containsNode")(g,i[p])){l=[g];break}if(document==i[p]||n("containsNode")(i[p],g)&&i[p]!==g){l=[g];break}}}else{g=[],p=i.length;for(var _,m=!c&&u.indexOf("[")<0&&document.querySelectorAll,v=0;v<p;v++){if(c){_=[];for(var E=i[v].parentNode;n("isElementNode")(E);)(f||E.tagName.toLowerCase()==h)&&_.push(E),E=E.parentNode}else _=m?d.test(u)?i[v].getElementsByClassName(u.substring(1)):i[v].querySelectorAll(u):i[v].getElementsByTagName(h);E=_.length;for(var y=0;y<E;y++)g.push(_[y])}if(!m)for(_=1;_<s.length;_++)for(y="."==(E=s[_]).charAt(0),f=E.substring(1),v=0;v<g.length;v++)if((p=g[v])&&1===p.nodeType)if(y)r("CSS").hasClass(p,f)||delete g[v];else if((h=(u=E.slice(1,E.length-1)).indexOf("="))<0){if(!a(p,u)){delete g[v];continue}}else if(m=u.substr(0,h),u=(u=u.substr(h+1)).slice(1,u.length-1),p.getAttribute(m)!=u){delete g[v];continue}for(v=0;v<g.length&&(!g[v]||(l.push(g[v]),!c));v++);}i=l}return i}function i(){var t=window.getSelection;return t?t()+"":(t=document.selection)?t.createRange().text:null}function o(t,e){return("string"==typeof t||"string"==typeof e)&&n("FBLogger")("dom_query").info("Support for node IDs is deprecated. Use containsNode(ge(<id1>), ge(<id2>)) instead"),n("containsNode")(n("ge")(t),n("ge")(e))}function l(){return n("ifRequired")("Quickling",function(t){return t.isActive()?n("ge")("content"):null})||document.body}function c(t,e){return e=n("createArrayFromMixed")(e).join("|").toUpperCase().split("|"),e=n("createObjectFrom")(e),n("isNode")(t)&&t.nodeName in e}function h(t){return c(t,["input","textarea"])||"true"===t.contentEditable}var d=/^\.-?[_a-zA-Z]+[\w-]*$/;s.find=t,s.findPushSafe=e,s.scry=u,s.getSelection=i,s.contains=o,s.getRootElement=l,s.isNodeOfType=c,s.isInputNode=h},98),__d("DOMEvent",["invariant"],function(t,e,n,r,i,o,s,a){t=function(){function t(t){this.event=t||window.event,"unknown"!=typeof this.event.srcElement||a(0,5798),this.target=this.event.target||this.event.srcElement}var e=t.prototype;return e.preventDefault=function(){var t=this.event;return t.preventDefault?(t.preventDefault(),"defaultPrevented"in t||(t.defaultPrevented=!0)):t.returnValue=!1,this},e.isDefaultPrevented=function(){var t=this.event;return"defaultPrevented"in t?t.defaultPrevented:!1===t.returnValue},e.stopPropagation=function(){var t=this.event;return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this},e.kill=function(){return this.stopPropagation().preventDefault(),this},t.killThenCall=function(e){return function(n){return new t(n).kill(),e()}},t}(),s["default"]=t},98),__d("dedupString",[],function(t,e,n,r,i,o){"use strict";function t(t){var e;return Object.keys((e={},e[t]=0,e))[0]}o["default"]=t},66),__d("wrapFunction",[],function(t,e,n,r,i,o){function t(t,e,n){var r=e in s?s[e](t,n):t;return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.apply(this,e)}}var s={};t.setWrapper=function(t,e){s[e]=t},o["default"]=t},66),__d("DOMEventListener",["invariant","dedupString","emptyFunction","passiveEventListenerUtil","wrapFunction"],function(t,e,n,r,i,o,s){var a,u,l=e("passiveEventListenerUtil").isPassiveEventListenerSupported;window.addEventListener?(a=function(t,n,r,i){void 0===i&&(i=!1),r.wrapper=e("wrapFunction")(r,"entry",e("dedupString")("DOMEventListener.add "+n)),t.addEventListener(n,r.wrapper,!!l&&i)},u=function(t,e,n,r){void 0===r&&(r=!1),t.removeEventListener(e,n.wrapper,!!l&&r)}):window.attachEvent?(a=function(t,n,r){r.wrapper=e("wrapFunction")(r,"entry","DOMEventListener.add "+n),t.attachEvent||s(0,2798),t.attachEvent("on"+n,r.wrapper)},u=function(t,e,n){t.detachEvent||s(0,2799),t.detachEvent("on"+e,n.wrapper)}):u=a=e("emptyFunction"),t={add:function(t,e,n,r){return void 0===r&&(r=!1),a(t,e,n,r),{remove:function(){u(t,e,n,r)}}},remove:u},i.exports=t},null),__d("EventProfiler",["cr:708886"],function(t,e,n,r,i,o,s){s["default"]=e("cr:708886")},98),__d("Scroll",[],function(t,e,n,r,i,o){function s(t,e){return!!e&&(t===e.documentElement||t===e.body)}function t(t){var e;if(null==t)return 0;var n=t.ownerDocument;return s(t,n)?(null==n?void 0:null==(e=n.body)?void 0:e.scrollTop)||(null==n?void 0:null==(e=n.documentElement)?void 0:e.scrollTop)||0:t.scrollTop||0}function e(t,e){if(null!=t){var n=t.ownerDocument;s(t,n)?((null==n?void 0:n.body)&&(n.body.scrollTop=e||0),(null==n?void 0:n.documentElement)&&(n.documentElement.scrollTop=e||0)):t.scrollTop=e||0}}function n(t){var e,n=t.ownerDocument;return s(t,n)?(null==n?void 0:null==(e=n.body)?void 0:e.scrollLeft)||(null==n?void 0:null==(e=n.documentElement)?void 0:e.scrollLeft)||0:t.scrollLeft||0}function r(t,e){var n=t.ownerDocument;s(t,n)?((null==n?void 0:n.body)&&(n.body.scrollLeft=e||0),(null==n?void 0:n.documentElement)&&(n.documentElement.scrollLeft=e||0)):t.scrollLeft=e||0}o.getTop=t,o.setTop=e,o.getLeft=n,o.setLeft=r},66),__d("FlowMigrationUtilsForLegacyFiles",["FBLogger"],function(t,e,n,r,i,o,s){"use strict";function t(t){return n("FBLogger")(a).blameToPreviousFile().event(a+".bad_call").mustfix(t),new Error("["+a+"] "+t)}var a="flow_typing_for_legacy_code";s.invariantViolation=t},98),__d("getDocumentScrollElement",["FlowMigrationUtilsForLegacyFiles"],function(t,e,n,r,i,o,s){"use strict";function t(t){return(t=t||document).scrollingElement?t.scrollingElement:((t=a||"CSS1Compat"!==t.compatMode?t.body:t.documentElement)||r("FlowMigrationUtilsForLegacyFiles").invariantViolation("null result in getDocumentScrollElement"),t)}var a="undefined"!=typeof navigator&&navigator.userAgent.indexOf("AppleWebKit")>-1;s["default"]=t},98),__d("getObjectValues",[],function(t,e,n,r,i,o){function t(t){var e=[];for(var n in t)e.push(t[n]);return e}o["default"]=t},66),__d("Event",["$","Arbiter","DOMEvent","DOMEventListener","DOMQuery","DataStore","ErrorGuard","EventProfiler","ExecutionEnvironment","FBLogger","Parent","Scroll","TimeSlice","UserAgent","dedupString","fb-error","getDocumentScrollElement","getObjectValues"],function(t,e,n,r,i,o){function s(t){("click"===t.type||"mouseover"===t.type||"keydown"===t.type)&&e("Arbiter").inform("Event/stop",{event:t})}function a(t){if(t instanceof f)return t;if(t||(t=!window.addEventListener&&document.createEventObject&&window.event?document.createEventObject(window.event):{}),!t._inherits_from_prototype)for(var e in Event.prototype)try{t[e]=Event.prototype[e]}catch(t){}return t}function u(t){return!!t.href.endsWith("#")&&(t.href===document.location.href||t.href===document.location.href+"#")}function l(t,e){return"INPUT"===t.nodeName&&t.type===e}var c,h=e("fb-error").TAAL,d="Event.listeners";Event.prototype||(Event.prototype={});var f=function(){"use strict";function t(t,e,n){this.cancelBubble=!1,this.target=t,this.type=e,this.data=n}var n=t.prototype;return n.getData=function(){return this.data=this.data||{},this.data},n.stop=function(){return Event.stop(this)},n.prevent=function(){return Event.prevent(this)},n.isDefaultPrevented=function(){return Event.isDefaultPrevented(this)},n.kill=function(){return Event.kill(this)},n.getTarget=function(){return new(e("DOMEvent"))(this).target||null},t}();Object.assign(Event.prototype,{_inherits_from_prototype:!0,getRelatedTarget:function(){var t=this.relatedTarget||(this.fromElement===this.srcElement?this.toElement:this.fromElement);return t&&t.nodeType?t:null},getModifiers:function(){var t={control:!!this.ctrlKey,shift:!!this.shiftKey,alt:!!this.altKey,meta:!!this.metaKey};return t.access=e("UserAgent").isPlatform("Mac OS X")?t.control:t.alt,t.any=t.control||t.shift||t.alt||t.meta,t},isRightClick:function(){return this.which?3===this.which:this.button&&2===this.button},isMiddleClick:function(){return this.which?2===this.which:this.button&&4===this.button},isDefaultRequested:function(){return this.getModifiers().any||this.isMiddleClick()||this.isRightClick()}},f.prototype),n={listen:function(t,n,r,i,o){if("function"==typeof r&&(r=e("TimeSlice").guard(r,e("dedupString")("Event.js "+n+" handler"))),o=o&&"boolean"!=typeof o?{passive:o.passive||!1}:{passive:!1},!e("ExecutionEnvironment").canUseDOM)return new E(t,r,null,n,i,null,o);if("string"==typeof t&&(t=e("$")(t)),void 0===i&&(i=Event.Priority.NORMAL),"object"==typeof n){var s={};for(var a in n)s[a]=Event.listen(t,a,n[a],i,o);return s}if(n.match(/^on/i))throw new TypeError("Bad event name `"+n+"': use `click', not `onclick'.");if(!t)throw a=h.blameToPreviousFrame(new Error("Cannot listen to an undefined element.")),e("FBLogger")("event").catching(a).mustfix("Tried to listen to element of type %s",n),a;"LABEL"==t.nodeName&&"click"==n?t=1==(s=t.getElementsByTagName("input")).length?s[0]:t:t===window&&"scroll"===n&&(a=e("getDocumentScrollElement")())!==document.documentElement&&a!==document.body&&(t=a),s=e("DataStore").get(t,d,{}),(a=g[n])&&(n=a.base,a.wrap&&(r=a.wrap(r))),m(t,s,n,o),i in(a=s[n])||(a[i]=[]);var u=a[i].length;return r=new E(t,r,s,n,i,u,o),a[i][u]=r,a.numHandlers++,o.passive||(a.numNonPassiveHandlers++,_(t,s[n],n)),r},stop:function(t){return s(new(e("DOMEvent"))(t).stopPropagation().event),t},prevent:function(t){return new(e("DOMEvent"))(t).preventDefault(),t},isDefaultPrevented:function(t){return new(e("DOMEvent"))(t).isDefaultPrevented(t)},kill:function(t){return s((t=new(e("DOMEvent"))(t).kill()).event),!1},getKeyCode:function(t){if(!(t=new(e("DOMEvent"))(t).event))return!1;switch(t.keyCode){case 63232:return 38;case 63233:return 40;case 63234:return 37;case 63235:return 39;case 63272:case 63273:case 63275:return null;case 63276:return 33;case 63277:return 34}if(t.shiftKey)switch(t.keyCode){case 33:case 34:case 37:case 38:case 39:case 40:return null}return t.keyCode},getPriorities:function(){if(!p){var t=e("getObjectValues")(Event.Priority);t.sort(function(t,e){return t-e}),p=t}return p},fire:function(t,e,n){var r;n=new f(t,e,n);do{var i=Event.__getHandler(t,e);i&&(r=i(n)),t=t.parentNode}while(t&&!1!==r&&!n.cancelBubble);return!1!==r},__fire:function(t,e,n){if(t=Event.__getHandler(t,e))return t(a(n))},__getHandler:function(t,n){var r=e("DataStore").get(t,d);return r&&r[n]?r[n].domHandler:t["on"+n]},getPosition:function(t){t=new(e("DOMEvent"))(t).event;var n=e("getDocumentScrollElement")();return{x:t.clientX+e("Scroll").getLeft(n),y:t=t.clientY+e("Scroll").getTop(n)}}},Object.assign(Event,n);var g,p=null;r=function(t){return function(n){if(!e("DOMQuery").contains(this,n.getRelatedTarget()))return t.call(this,n)}},g=window.navigator.msPointerEnabled?{mousedown:{base:"MSPointerDown"},mousemove:{base:"MSPointerMove"},mouseup:{base:"MSPointerUp"},mouseover:{base:"MSPointerOver"},mouseout:{base:"MSPointerOut"},mouseenter:{base:"MSPointerOver",wrap:r},mouseleave:{base:"MSPointerOut",wrap:r}}:{mouseenter:{base:"mouseover",wrap:r},mouseleave:{base:"mouseout",wrap:r}},e("UserAgent").isBrowser("Firefox < 52")&&(o=function(t,e){for(var n=(e=a(e)).getTarget();n;)Event.__fire(n,t,e),n=n.parentNode},document.documentElement.addEventListener("focus",o.bind(null,"focusin"),!0),document.documentElement.addEventListener("blur",o.bind(null,"focusout"),!0));var _=function(t,n,r){var i=0==n.numNonPassiveHandlers;i!=n.options.passive&&(n.domHandlerRemover.remove(),n.options.passive=i,n.domHandlerRemover=e("DOMEventListener").add(t,r,n.domHandler,{passive:i}))},m=function(t,n,r,i){if(!(r in n)){var o=e("TimeSlice").guard(v.bind(t,r),e("dedupString")("Event listenHandler "+r));if(n[r]={numHandlers:0,numNonPassiveHandlers:0,domHandlerRemover:e("DOMEventListener").add(t,r,o,i),domHandler:o,options:i},t[n="on"+r]){o=t===document.documentElement?Event.Priority._BUBBLE:Event.Priority.TRADITIONAL;var s=t[n];t[n]=null,Event.listen(t,r,s,o,i)}}},v=e("EventProfiler").__wrapEventListenHandler(function(t,n){if(n=a(n),!e("DataStore").get(this,d))throw new Error("Bad listenHandler context.");var r=e("DataStore").get(this,d)[t];if(!r)throw new Error("No registered handlers for `"+t+"'.");if("click"==t||"contextmenu"==t||"mousedown"==t&&2==n.which){t=n.getTarget();var i=e("Parent").byTag(t,"a");i instanceof HTMLAnchorElement&&i.href&&u(i)&&!l(t,"file")&&!l(t,"submit")&&n.prevent()}for(i=Event.getPriorities(),t=0;t<i.length;t++){var o=i[t];if(o in r){o=r[o];for(var s=0;s<o.length;s++)if(o[s]){if(!1===o[s].fire(this,n))return n.kill();n.cancelBubble&&n.stop()}}}return n.returnValue});Event.Priority={URGENT:-20,TRADITIONAL:-10,NORMAL:0,_BUBBLE:1e3};var E=function(){"use strict";function t(t,e,n,r,i,o,s){this.$1=t,this.$2=e,this.$3=n,this.$7=r,this.$6=i,this.$4=o,this.$5=s}var n=t.prototype;return n.isRemoved=function(){return!this.$3},n.remove=function(){if(e("ExecutionEnvironment").canUseDOM){if(this.isRemoved())return void e("FBLogger")("Event").warn("Event handler has already been removed");var t=this.$3[this.$7];t.numHandlers<=1?(t.domHandlerRemover.remove(),delete this.$3[this.$7]):(delete t[this.$6][this.$4],t.numHandlers--,this.$5.passive||(t.numNonPassiveHandlers--,_(this.$1,this.$3[this.$7],this.$7))),this.$3=null}},n.fire=function(t,n){return!e("ExecutionEnvironment").canUseDOM||(c||(c=e("ErrorGuard"))).applyWithGuard(this.$2,t,[n],{name:"eventhandler:"+n.type+":"+("string"==typeof t.name?t.name:t.id)})},t}();t.$E=Event.$E=a,i.exports=Event},null),__d("TrustedTypesIEFixDOMPolicy",["TrustedTypes"],function(t,e,n,r,i,o,s){"use strict";t={createHTML:function(t){return t}},r=n("TrustedTypes").createPolicy("dom-ie-fix",t),s["default"]=r},98),__d("UserAgent_DEPRECATED",[],function(t,e,n,r,i,o){function s(){if(!q){q=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),n=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(A=/\b(iPhone|iP[ao]d)/.exec(t),I=/\b(iP[ao]d)/.exec(t),R=/Android/i.exec(t),M=/FBAN\/\w+;/i.exec(t),D=/FBAN\/mLite;/i.exec(t),k=/Mobile/i.exec(t),B=!!/Win64/.exec(t),e){(v=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN)&&document&&document.documentMode&&(v=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(t);T=r?parseFloat(r[1])+4:v,E=e[2]?parseFloat(e[2]):NaN,y=e[3]?parseFloat(e[3]):NaN,(S=e[4]?parseFloat(e[4]):NaN)?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),b=e&&e[1]?parseFloat(e[1]):NaN):b=NaN}else v=E=y=b=S=NaN;n?(n[1]?(r=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t),$=!r||parseFloat(r[1].replace("_","."))):$=!1,C=!!n[2],w=!!n[3]):$=C=w=!1}}function a(){return s()||v}function t(){return s()||T>v}function e(){return a()&&B}function n(){return s()||E}function r(){return s()||y}function u(){return s()||S}function i(){return u()}function l(){return s()||b}function c(){return s()||C}function h(){return s()||$}function d(){return s()||w}function f(){return s()||A}function g(){return s()||A||I||R||k}function p(){return s()||null!=D?null:M}function _(){return s()||R}function m(){return s()||I}var v,E,y,S,b,T,$,C,w,R,B,A,I,M,D,k,q=!1;o.ie=a,o.ieCompatibilityMode=t,o.ie64=e,o.firefox=n,o.opera=r,o.webkit=u,o.safari=i,o.chrome=l,o.windows=c,o.osx=h,o.linux=d,o.iphone=f,o.mobile=g,o.nativeApp=p,o.android=_,o.ipad=m},66),__d("isScalar",[],function(t,e,n,r,i,o){function t(t){return/string|number|boolean/.test(typeof t)}o["default"]=t},66),__d("DOM",["$","DOMQuery","Event","FBLogger","FbtResultBase","HTML","TrustedTypesIEFixDOMPolicy","UserAgent_DEPRECATED","createArrayFromMixed","fb-error","isNode","isScalar","isTextNode"],function(t,e,n,r,i,o,s){function a(t){t.parentNode&&t.parentNode.removeChild(t)}function u(t,e,i){if((t=n("HTML").replaceJSONWrapper(t))instanceof n("HTML")&&null===e.firstChild&&-1===t.toString().indexOf("<script")){var o=r("UserAgent_DEPRECATED").ie();if(!o||o>7&&!r("DOMQuery").isNodeOfType(e,["table","tbody","thead","tfoot","tr","select","fieldset"])){var s=o?'<em style="display:none;">&nbsp;</em>':"";return e.innerHTML=n("TrustedTypesIEFixDOMPolicy").createHTML(s+t),o&&e.removeChild(e.firstChild),Array.from(e.childNodes)}}else if(n("isTextNode")(e))return e.data=t,[t];var a;s=document.createDocumentFragment(),o=[],e=[];var u=!1;1===(t=n("createArrayFromMixed")(t)).length&&t[0]instanceof n("FbtResultBase")&&(t=t[0].getContents());for(var l=0;l<t.length;l++)if((a=n("HTML").replaceJSONWrapper(t[l]))instanceof n("HTML")){e.push(a.getAction());var c=a.getNodes();!u&&a.hasInlineJs()&&(n("FBLogger")("staticresources").warn("DOM: adding HTML which contains inline JS"),u=!0);for(var h=0;h<c.length;h++)o.push(c[h]),s.appendChild(c[h])}else n("isScalar")(a)||a instanceof n("FbtResultBase")?(h=document.createTextNode(a),o.push(h),s.appendChild(h)):n("isNode")(a)?(o.push(a),s.appendChild(a)):(Array.isArray(a)&&n("FBLogger")("dom").warn("Nest arrays not supported"),null!==a&&n("FBLogger")("dom").warn("No way to set content %s",a));return i(s),e.forEach(function(t){t()}),o}t=function(t,e,n){return t=document.createElement(t),e&&l.setAttributes(t,e),null!=n&&l.setContent(t,n),t};var l={find:r("DOMQuery").find,findPushSafe:r("DOMQuery").findPushSafe,scry:r("DOMQuery").scry,getSelection:r("DOMQuery").getSelection,contains:r("DOMQuery").contains,getRootElement:r("DOMQuery").getRootElement,isNodeOfType:r("DOMQuery").isNodeOfType,isInputNode:r("DOMQuery").isInputNode,create:t,setAttributes:function(t,e){for(var r in e.type&&(t.type=e.type),e){var i=e[r],o=/^on/i.test(r);o&&"function"!=typeof i&&n("FBLogger")("dom").warn("Handlers passed to DOM.setAttributes must be functions. Handler passed for %s was %s",r,typeof i),"type"!=r&&("style"==r?"string"==typeof i?t.style.cssText=i:Object.assign(t.style,i):o?n("Event").listen(t,r.substr(2),i):r in t?t[r]=i:t.setAttribute&&t.setAttribute(r,i))}},prependContent:function(t,e){if(!t)throw n("fb-error").TAAL.blameToPreviousFile(new Error("reference element is not a node"));return u(e,t,function(e){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)})},insertAfter:function(t,e){if(!t||!t.parentNode)throw n("fb-error").TAAL.blameToPreviousFile(new Error("reference element does not have a parent"));var r=t.parentNode;return u(e,r,function(e){t.nextSibling?r.insertBefore(e,t.nextSibling):r.appendChild(e)})},insertBefore:function(t,e){if(!t||!t.parentNode)throw n("fb-error").TAAL.blameToPreviousFile(new Error("reference element does not have a parent"));var r=t.parentNode;return u(e,r,function(e){r.insertBefore(e,t)})},setContent:function(t,e){if(!t)throw n("fb-error").TAAL.blameToPreviousFile(new Error("reference element is not a node"));for(;t.firstChild;)a(t.firstChild);return l.appendContent(t,e)},appendContent:function(t,e){if(!t)throw n("fb-error").TAAL.blameToPreviousFile(new Error("reference element is not a node"));return u(e,t,function(e){t.appendChild(e)})},replace:function(t,e){if(!t||!t.parentNode)throw n("fb-error").TAAL.blameToPreviousFile(new Error("reference element does not have a parent"));var r=t.parentNode;return u(e,r,function(e){r.replaceChild(e,t)})},remove:function(t){a("string"==typeof t?n("$")(t):t)},empty:function(t){for(t="string"==typeof t?n("$")(t):t;t.firstChild;)a(t.firstChild)}};e=l,s["default"]=e},98),__d("AsyncDOM",["CSS","DOM","FBLogger"],function(t,e,n,r,i){t={invoke:function(t,n){for(var r=0;r<t.length;++r){var i=t[r],o=i[0],s=i[1],a=i[2];switch(i=i[3],a=a&&n||null,s&&(a=e("DOM").scry(a||document.documentElement,s)[0]),a||e("FBLogger")("async_dom").warn("Could not find relativeTo element for %s AsyncDOM operation based on selector: %s",o,s),o){case"hide":e("CSS").hide(a);break;case"show":e("CSS").show(a);break;case"setContent":e("DOM").setContent(a,i);break
;case"appendContent":e("DOM").appendContent(a,i);break;case"prependContent":e("DOM").prependContent(a,i);break;case"insertAfter":e("DOM").insertAfter(a,i);break;case"insertBefore":e("DOM").insertBefore(a,i);break;case"remove":e("DOM").remove(a);break;case"replace":e("DOM").replace(a,i);break;default:e("FBLogger")("async_dom").warn("Received invalid command %s for AsyncDOM operation",o)}}}},i.exports=t},null),__d("AsyncResponse",["invariant","Bootloader","FBLogger","HTML"],function(t,e,n,r,i,o,s,a){"use strict";t=function(){function t(t,e){this.error=0,this.errorSummary=null,this.errorDescription=null,this.onload=null,this.replay=!1,this.payload=e,this.request=t,this.silentError=!1,this.transientError=!1,this.blockedAction=!1,this.is_last=!0,this.responseHeaders=null}var e=t.prototype;return e.getRequest=function(){return this.request},e.getPayload=function(){return this.payload},e.toError=function(){0!==this.error||a(0,5599);var t=this.errorSummary||"",e=this.getErrorDescriptionString()||"",n=new Error(t.toString()+": "+e);return Object.assign(n,{code:this.error,description:this.errorDescription||"",descriptionString:e,response:this,summary:t,isSilent:this.silentError,isTransient:this.transientError}),n},e.getError=function(){return this.error},e.getErrorSummary=function(){return this.errorSummary},e.setErrorSummary=function(t){return t=void 0===t?null:t,this.errorSummary=t,this},e.getErrorDescription=function(){return this.errorDescription},e.getErrorDescriptionString=function(){var t=this.getErrorDescription();return null==t?null:n("HTML").isHTML(t)?new(n("HTML"))(t).getRootNode().textContent:t.toString()},e.getErrorIsWarning=function(){return!!this.errorIsWarning},e.isSilent=function(){return!!this.silentError},e.isTransient=function(){return!!this.transientError},e.isBlockedAction=function(){return!!this.blockedAction},e.getResponseHeader=function(t){var e=this.responseHeaders;if(!e)return null;e=e.replace(/^\n/,""),t=t.toLowerCase(),e=e.split("\r\n");for(var n=0;n<e.length;++n){var r=e[n],i=r.indexOf(": ");if(!(i<=0))if(r.substring(0,i).toLowerCase()===t)return r.substring(i+2)}return null},t.defaultErrorHandler=function(e){try{e.silentError?n("FBLogger")("async_response").catching(e.toError()).warn("default error handler called"):t.verboseErrorHandler(e)}catch(t){alert(e)}},t.verboseErrorHandler=function(t,e){n("Bootloader").loadModules(["ExceptionDialog"],function(n){return n.showAsyncError(t,e)},"AsyncResponse")},t}(),s["default"]=t},98),__d("FetchStreamConfig",[],function(t,e,n,r,i,o){t=Object.freeze({delim:"/*<!-- fetch-stream -->*/"}),o["default"]=t},66),__d("StreamBlockReader",["Promise","regeneratorRuntime"],function(t,e,n,r,i,o){t=function(){function t(t){var n=this;if(!t.getReader)throw new Error("No getReader method found on given object");this.$3=t.getReader(),this.$1="",this.$2=null,this.$4=!1,this.$5="utf-8",this.$6="",this.$9=!1,this.$8=function(){return e("Promise").reject("Sorry, you are somehow using this too early.")},this.$7=new(e("Promise"))(function(t){n.$8=t})}var n=t.prototype;return n.changeEncoding=function(t){if(this.$2)throw new Error("Decoder already in use, encoding cannot be changed");this.$5=t},n.$10=function(){if(!self.TextDecoder)throw new Error("TextDecoder is not supported here");return this.$2||(this.$2=new self.TextDecoder(this.$5)),this.$2},n.$11=function(){if(this.$9)throw new Error("Something else is already reading from this reader");this.$9=!0},n.$12=function(){this.$9=!1},n.isDone=function(){return this.$4},n.$13=function(){var t,n,r,i;return e("regeneratorRuntime").async(function(o){for(;;)switch(o.prev=o.next){case 0:if(""===this.$6){o.next=4;break}return t=this.$6,this.$6="",o.abrupt("return",t);case 4:if(!this.isDone()){o.next=6;break}throw new Error("You cannot read from a stream that is done");case 6:return o.next=8,e("regeneratorRuntime").awrap(this.$3.read());case 8:return n=o.sent,r=n.done,i=n.value,this.$4=r,r&&this.$8(),o.abrupt("return",i?this.$10().decode(i,{stream:!r}):"");case 14:case"end":return o.stop()}},null,this)},n.readNextBlock=function(){var t;return e("regeneratorRuntime").async(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$11(),t=this.$13(),this.$12(),e.abrupt("return",t);case 4:case"end":return e.stop()}},null,this)},n.readUntilStringOrEnd=function(t){return e("regeneratorRuntime").async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e("regeneratorRuntime").awrap(this.readUntilOneOfStringOrEnd_DO_NOT_USE([t]));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},null,this)},n.readUntilStringOrThrow=function(t){var n,r,i;return e("regeneratorRuntime").async(function(o){for(;;)switch(o.prev=o.next){case 0:if(t){o.next=2;break}throw new Error("cannot read empty string");case 2:this.$11(),n="",r=0;case 5:if(this.isDone()){o.next=23;break}return o.t0=n,o.next=9,e("regeneratorRuntime").awrap(this.$13());case 9:if(!((n=o.t0+=o.sent).length<t.length)){o.next=12;break}return o.abrupt("continue",5);case 12:if(-1===(i=n.substring(r).indexOf(t))){o.next=20;break}return i+=r,this.$6=n.substring(i+t.length),this.$12(),o.abrupt("return",n.substring(0,i));case 20:r=n.length-t.length+1;case 21:o.next=5;break;case 23:throw this.$6=n,this.$12(),new Error("Breakpoint not found");case 26:case"end":return o.stop()}},null,this)},n.readUntilOneOfStringOrEnd_DO_NOT_USE=function(t){var n,r,i,o;return e("regeneratorRuntime").async(function(s){for(;;)switch(s.prev=s.next){case 0:this.$11(),n="";case 2:if(this.isDone()){s.next=20;break}return s.t0=n,s.next=6,e("regeneratorRuntime").awrap(this.$13());case 6:n=s.t0+=s.sent,r=0;case 8:if(!(r<t.length)){s.next=18;break}if(i=t[r],-1===(o=n.indexOf(i))){s.next=15;break}return this.$6=n.substring(o+i.length),this.$12(),s.abrupt("return",n.substring(0,o));case 15:r++,s.next=8;break;case 18:s.next=2;break;case 20:return this.$12(),s.abrupt("return",n);case 22:case"end":return s.stop()}},null,this)},n.waitUntilDone=function(){return e("regeneratorRuntime").async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.$7);case 1:case"end":return t.stop()}},null,this)},t}(),o["default"]=t},66),__d("mixin",[],function(t,e,n,r,i,o){function t(){for(var t,e=function(){},n=0;n<0||arguments.length<=n?void 0:arguments[n];){for(var r in t=n<0||arguments.length<=n?void 0:arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e.prototype[r]=t[r]);n+=1}return e}o["default"]=t},66),__d("FetchStreamTransport",["ArbiterMixin","FetchStreamConfig","StreamBlockReader","TimeSlice","URI","asyncToGeneratorRuntime","mixin","nullthrows"],function(t,e,n,r,i,o,s){var a=0;t=function(t){function r(e){var n;if(!(self.ReadableStream&&self.fetch&&Request&&TextDecoder))throw new Error("fetch stream transport is not supported here");return(n=t.call(this)||this).$FetchStreamTransport6=null,n.$FetchStreamTransport1=e,n.$FetchStreamTransport3=!1,n.$FetchStreamTransport4=!1,n.$FetchStreamTransport5=!1,n.$FetchStreamTransport2=++a,babelHelpers.assertThisInitialized(n)||babelHelpers.assertThisInitialized(n)}babelHelpers.inheritsLoose(r,t);var i=r.prototype;return i.hasFinished=function(){return this.$FetchStreamTransport5},i.getRequestURI=function(){return new(n("URI"))(this.$FetchStreamTransport1).addQueryData({__a:1,__adt:this.$FetchStreamTransport2,__req:"fetchstream_"+this.$FetchStreamTransport2,ajaxpipe_fetch_stream:1})},i.send=function(){if(this.$FetchStreamTransport3)throw new Error("FetchStreamTransport instances cannot be re-used.");this.$FetchStreamTransport3=!0;var t=new Request(this.getRequestURI().toString(),{mode:"same-origin",credentials:"include"});this.$FetchStreamTransport6=n("TimeSlice").getGuardedContinuation("FetchStreamTransport: waiting on first response"),t=self.fetch(t,{redirect:"follow"}),this.$FetchStreamTransport7(t)},i.$FetchStreamTransport7=function(){function t(){return r.apply(this,arguments)}var r=e("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var e,r=this;try{e=yield t}catch(t){this.abort()}if(e&&e.body&&e.ok){var i=new(n("StreamBlockReader"))(e.body);for(t=function*(){var t=yield i.readUntilStringOrEnd(n("FetchStreamConfig").delim);if(r.$FetchStreamTransport4)return"break";n("nullthrows")(r.$FetchStreamTransport6)(function(){var e=JSON.parse(t);i.isDone()||e.finished?r.$FetchStreamTransport5=!0:r.$FetchStreamTransport6=n("TimeSlice").getGuardedContinuation("FetchStreamTransport: waiting on next response"),r.inform("response",e.content)})};!this.$FetchStreamTransport5&&!this.$FetchStreamTransport4;){if("break"===(yield*t()))break}}else this.abort()});return t}(),i.abort=function(){var t=this;this.$FetchStreamTransport4||this.$FetchStreamTransport5||(this.$FetchStreamTransport4=!0,this.$FetchStreamTransport5=!0,this.$FetchStreamTransport6?(0,this.$FetchStreamTransport6)(function(){t.inform("abort")}):this.inform("abort"))},r}(n("mixin")(n("ArbiterMixin"))),s["default"]=t},98),__d("HTTPErrors",["emptyFunction"],function(t,e,n,r,i,o,s){function t(t){return{summary:"HTTP Error",description:"Unknown HTTP error #"+t}}r={get:t,getAll:n("emptyFunction").thatReturns(new Map)},s["default"]=r},98),__d("JSONPTransport",["ArbiterMixin","DOM","HTML","TimeSlice","URI","mixin","setTimeout"],function(t,e,n,r,i,o,s){function a(t){delete u[t]}var u={},l=2;(t=function(t){function e(e){var n;return(n=t.call(this)||this).$JSONPTransport3=!1,n.$JSONPTransport7=e,u[n.getID()]=babelHelpers.assertThisInitialized(n),n}babelHelpers.inheritsLoose(e,t);var r=e.prototype;return r.getID=function(){return this.$JSONPTransport4||(this.$JSONPTransport4=l++)},r.hasFinished=function(){return!(this.getID()in u)},r.getRequestURI=function(){return new(n("URI"))(this.$JSONPTransport7).addQueryData({__a:1,__adt:this.getID(),__req:"jsonp_"+this.getID()})},r.getTransportFrame=function(){if(this.$JSONPTransport5)return this.$JSONPTransport5;var t="transport_frame_"+this.getID();return t=n("HTML")('<iframe class="hidden_elem" name="'+t+'" src="javascript:void(0)" />'),this.$JSONPTransport5=n("DOM").appendContent(document.body,t)[0]},r.send=function(){var t=this;this.getTransportFrame().onload=function(){return t.$JSONPTransport8()},this.getTransportFrame().src=this.getRequestURI().toString(),this.$JSONPTransport2=n("TimeSlice").getGuardedContinuation("JSONPTransport: waiting for first response")},r.handleResponse=function(t){var e=this;null==this.$JSONPTransport2||this.$JSONPTransport2(function(){e.inform("response",t),e.hasFinished()?n("setTimeout")(function(){return e.$JSONPTransport9()},0):e.$JSONPTransport2=n("TimeSlice").getGuardedContinuation("JSONPTransport: waiting for next response")})},r.abort=function(){this.$JSONPTransport1||(this.$JSONPTransport1=!0,this.$JSONPTransport9(),a(this.getID()),this.inform("abort"))},r.$JSONPTransport8=function(){this.$JSONPTransport3||this.abort()},r.$JSONPTransport9=function(){this.$JSONPTransport5&&(n("DOM").remove(this.$JSONPTransport5),this.$JSONPTransport5=null)},e}(n("mixin")(n("ArbiterMixin")))).respond=function(t,e,n){var r=u[t];r&&(r.$JSONPTransport3=!0,n||a(t),n="string"==typeof e?JSON.parse(e):JSON.parse(null!=(t=JSON.stringify(e))?t:"null"),r.handleResponse(n))},t.respond=n("TimeSlice").guard(t.respond,"JSONPTransport.respond",{root:!0}),s["default"]=t},98),__d("SessionName",["SessionNameConfig"],function(t,e,n,r,i){i.exports={getName:function(){return e("SessionNameConfig").seed}}},null),__d("bind",[],function(t,e,n,r,i){function t(t,e){function n(){var n=r.concat(Array.prototype.slice.call(arguments));if(t[e])return t[e].apply(t,n)}var r=Array.prototype.slice.call(arguments,2);return"string"!=typeof e?Function.prototype.bind.apply(e,[t].concat(r)):(n.toString=function(){return"bound lazily: "+t[e]},n)}i.exports=t},null),__d("executeAfter",[],function(t,e,n,r,i){function t(t,e,n){return function(){t.apply(n||this,arguments),e.apply(n||this,arguments)}}i.exports=t},null),__d("isSparkDotMetaDotComURI",[],function(t,e,n,r,i,o){function t(t){return(!t.isEmpty()||"#"===t.toString())&&(!(!t.getDomain()&&!t.getProtocol())&&(-1!==a.indexOf(t.getProtocol())&&s.test(t.getDomain())))}var s=new RegExp("(^|\\.)spark\\.meta\\.com$","i"),a=["https"];o["default"]=t},66),__d("AsyncRequest",["errorCode","fbt","invariant","Arbiter","AsyncDOM","AsyncRequestConfig","AsyncResponse","Bootloader","CSS","DTSG","DTSG_ASYNC","Deferred","Env","ErrorGuard","Event","FBLogger","FetchStreamTransport","HTTPErrors","HasteResponse","PHPQuerySerializer","Parent","Promise","ResourceTimingsStore","ResourceTypes","ScriptPath","ServerJS","SessionName","TimeSlice","URI","UserAgent_DEPRECATED","ZeroRewrites","bind","clearTimeout","emptyFunction","executeAfter","fb-error","ge","getAsyncHeaders","getAsyncParams","gkx","goURI","isBulletinDotComURI","isEmpty","isFacebookURI","isHorizonDotMetaDotComURI","isInternalFBURI","isMessengerDotComURI","isSparkDotMetaDotComURI","isWorkDotMetaDotComURI","isWorkplaceDotComURI","killswitch","performanceAbsoluteNow","promiseDone","replaceTransportMarkers","setTimeout","setTimeoutAcrossTransitions","uriIsRelativePath"],function(t,e,n,r,i,o,s,a,u,l){"use strict";function c(){try{return!window.domready}catch(t){return!0}}function h(t){return"onprogress"in t}function d(t){return"upload"in t&&"onprogress"in t.upload}function f(t){return"withCredentials"in t}function g(t){return t.status in{0:1,12029:1,12030:1,12031:1,12152:1}}function p(t){return(t=!t||"function"==typeof t)||n("FBLogger")("asyncresponse").mustfix("AsyncRequest response handlers must be functions. Pass a function, or use bind() to build one."),t}var _=1006,m=1004,v=1010,E=new Set([500,v,m,_]),y=2,S=y,b=!1;n("Arbiter").subscribe("page_transition",function(t,e){b?b=!1:S=e.id});var T="for (;;);",$=T.length,C=function(){function t(e){var i=this;this._allowIrrelevantRequests=!1,this._delayPreDisplayJS=!1,this._shouldReplaceTransportMarkers=!1,this._dispatchErrorResponse=function(t,e){var r=t.getError();if(i.clearStatusIndicator(),i._isRelevant()&&r!==v){if(i._isServerDialogErrorCode(r)){var o=1357008==r||1357007==r;i.interceptHandler(t),1357041==r?i._solveQuicksandChallenge(t):1357007==r?i._displayServerDialog(t,o,!0):i._displayServerDialog(t,o)}else if(!1!==i.initialHandler(t)){n("clearTimeout")(i.timer);try{e(t)}catch(e){throw i.finallyHandler(t),e}i.finallyHandler(t)}}else i.abort()},this._onStateChange=function(){var e=i.transport;if(e)try{t._inflightCount--,r("ResourceTimingsStore").measureResponseReceived(n("ResourceTypes").XHR,i.resourceTimingStoreUID);try{e.getResponseHeader("X-FB-Debug")&&(i._xFbServer=e.getResponseHeader("X-FB-Debug"),n("fb-error").ErrorXFBDebug.add(i._xFbServer))}catch(t){}if(e.status>=200&&e.status<300)t.lastSuccessTime=Date.now(),i._handleXHRResponse(e);else if(r("UserAgent_DEPRECATED").webkit()&&"undefined"==typeof e.status)i._invokeErrorHandler(1002);else{if(n("AsyncRequestConfig").retryOnNetworkError&&g(e)&&i.remainingRetries>0&&!i._requestTimeout)return i.remainingRetries--,delete i.transport,void i.send(!0);i._invokeErrorHandler()}!1!==i.getOption("asynchronous_DEPRECATED")&&delete i.transport}catch(t){if(c())return;delete i.transport,i.remainingRetries>0?(i.remainingRetries--,i.send(!0)):(i.getOption("suppressErrorAlerts")||n("FBLogger")("AsyncRequest").catching(t).mustfix("AsyncRequest exception when attempting to handle a state change"),i._invokeErrorHandler(1007))}},this._handleTimeout=function(){i.continuation.last(function(){i._requestTimeout=!0;var t=i.timeoutHandler;i.abandon(),t&&t(i),n("setTimeout")(function(){n("Arbiter").inform("AsyncRequest/timeout",{request:i})},0)})},this.continuation=n("TimeSlice").getPlaceholderReusableContinuation(),this.transport=null,this.method="POST",this.uri="",this.timeout=null,this.timer=null,this.initialHandler=n("emptyFunction"),this.handler=null,this.uploadProgressHandler=null,this.errorHandler=n("AsyncResponse").defaultErrorHandler,this.transportErrorHandler=null,this.timeoutHandler=null,this.interceptHandler=n("emptyFunction"),this.finallyHandler=n("emptyFunction"),this.abortHandler=n("emptyFunction"),this.serverDialogCancelHandler=null,this.relativeTo=null,this.statusElement=null,this.statusClass="",this.data={},this.headers={},this.file=null,this.context={},this.readOnly=!1,this.writeRequiredParams=[],this.remainingRetries=0,this.userActionID="-",this.resourceTimingStoreUID=r("ResourceTimingsStore").getUID(n("ResourceTypes").XHR,null!=e?e.toString():""),this.flushedResponseTextParseIndex=0,this.option={asynchronous_DEPRECATED:!0,suppressErrorHandlerWarning:!1,suppressEvaluation:!1,suppressErrorAlerts:!1,retries:0,bundle:!1,useIframeTransport:!1,handleErrorAfterUnload:!1,useFetchWithIframeFallback:!1},this.transportErrorHandler=n("bind")(this,"errorHandler"),void 0!==e&&this.setURI(e),this.setAllowCrossPageTransition(n("AsyncRequestConfig").asyncRequestsSurviveTransitionsDefault||!1)}var o=t.prototype;return o._dispatchResponse=function(t){if(this.clearStatusIndicator(),this._isRelevant()){if(!1!==this.initialHandler(t)){n("clearTimeout")(this.timer);var e,r=this.getHandler();if(r)try{e=this._shouldSuppressJS(r(t))}catch(e){throw t.is_last&&this.finallyHandler(t),e}e||this._handleJSResponse(t),t.is_last&&this.finallyHandler(t)}}else this._invokeErrorHandler(v)},o._shouldSuppressJS=function(e){return e===t.suppressOnloadToken},o._handlePreDisplayServerJS=function(t,e){var r=!1,i=[],o=function(){if(r)return n("FBLogger")("AsyncResponse").warn("registerToBlockDisplayUntilDone_DONOTUSE called after AsyncResponse display started. This is a no-op."),function(){};var t,e=new(n("Deferred"));return i.push(e.getPromise()),n("TimeSlice").guard(function(){t&&n("clearTimeout")(t),e.resolve()},"AsyncRequestDisplayBlockingEvent",{propagationType:n("TimeSlice").PropagationType.EXECUTION})};return t.handle(e,{bigPipeContext:{registerToBlockDisplayUntilDone_DONOTUSE:o}}),r=!0,i},o._hasEvalDomOp=function(t){return!(!t||!t.length)&&t.some(function(t){return"eval"===t[0]})},o._handleJSResponse=function(t){var e=this.getRelativeTo(),i=t.domops,o=t.dtsgToken,s=t.dtsgAsyncGetToken,a=t.jsmods,u=t.savedServerJSInstance;if((u=u&&u instanceof n("ServerJS")?u:new(n("ServerJS"))).setRelativeTo(e),a){var l={define:a.define,instances:a.instances,markup:a.markup};delete a.define,delete a.instances,delete a.markup,this._hasEvalDomOp(i)&&(l.elements=a.elements,delete a.elements),u.handle(l)}(!(l=new(n("URI"))(this.uri)).getDomain()&&!l.getProtocol()||document.location.origin===l.getOrigin())&&(o&&r("DTSG").setToken(o),s&&r("DTSG_ASYNC").setToken(s)),i&&n("ErrorGuard").applyWithGuard(function(){return r("AsyncDOM").invoke(i,e)},null,[],{errorType:"warn"}),a&&u.handle(a),this._handleJSRegisters(t,"onload"),this._handleJSRegisters(t,"onafterload")},o._handleJSRegisters=function(t,e){if(t=t[e])for(e=0;e<t.length;e++){var r=null,i=t[e],o=i.match(/^\"caller:([^\"]+?)\";(.*)/);null!=o&&(r=o[1],i=o[2]),n("ErrorGuard").applyWithGuard(new Function(i),this,[]),n("FBLogger")("comet_infra").info("Detected dynamic new Function(...) call in AsyncRequest._handleJSRegisters(...).",new(n("URI"))(this.uri).getPath(),r)}},o.invokeResponseHandler=function(t){var i=this;if("undefined"==typeof t.redirect)if(void 0===t.bootloadOnly){if(this.handler||this.errorHandler||this.transportErrorHandler||this.preBootloadHandler||this.initialHandler!==n("emptyFunction")||this.finallyHandler!==n("emptyFunction")){var o=t.asyncResponse;if(void 0!==o){if(!this._isRelevant())return void this._invokeErrorHandler(v);var s,a;if(o.updateScriptPath&&n("ScriptPath").set(o.updateScriptPath.path,o.updateScriptPath.token,o.updateScriptPath.extra_info),o.lid&&(this._responseTime=Date.now(),this.lid=o.lid),r("HasteResponse").handleSRPayload(null!=(d=o.hsrp)?d:{}),o.getError()&&!o.getErrorIsWarning())h=this.getErrorHandler().bind(this),s=(s=n("ErrorGuard").guard(this._dispatchErrorResponse,{name:"AsyncRequest#_dispatchErrorResponse for "+this.getURI()})).bind(this,o,h),a="error";else if(s=(s=n("ErrorGuard").guard(this._dispatchResponse.bind(this),{name:"AsyncRequest#_dispatchResponse for "+this.getURI()})).bind(this,o),a="response",d=o.domops,!this._delayPreDisplayJS&&o.jsmods&&o.jsmods.pre_display_requires&&!this._hasEvalDomOp(d)&&!n("killswitch")("ASYNC_REQUEST_EARLY_RENDERING_OF_PREDISPLAY_PRIORITY_JS")){d={define:(h=o.jsmods).define,instances:h.instances,markup:h.markup},delete h.define,delete h.instances,delete h.markup,d.pre_display_requires=h.pre_display_requires,delete h.pre_display_requires,(h=new(n("ServerJS"))).setRelativeTo(this.getRelativeTo()),o.savedServerJSInstance=h;var u=this._handlePreDisplayServerJS(h,d);if(u&&u.length){var l=s;s=function(){n("promiseDone")(e("Promise").all(u).then(l))}}}var c=n("performanceAbsoluteNow")();s=n("executeAfter")(s,function(){n("Arbiter").inform("AsyncRequest/"+a,{request:i,response:o,ts:c})}),this.preBootloadHandler&&this.preBootloadHandler(o),n("Bootloader").loadResources(null!=(h=o.allResources)?h:[],{onAll:n("AsyncRequestConfig").immediateDispatch?s:function(){n("setTimeout")(s,0)}})}else"undefined"!=typeof t.transportError?this._xFbServer?this._invokeErrorHandler(1008):this._invokeErrorHandler(1012):this._invokeErrorHandler(1007)}}else{var h="string"==typeof t.bootloadOnly?JSON.parse(t.bootloadOnly):t.bootloadOnly,d=function(t){n("TimeSlice").guard(function(){n("Bootloader").loadPredictedResourceMap(t)},"Bootloader.loadPredictedResourceMap",{root:!0})()};for(h of h)d(h)}else n("setTimeout")(function(){i.setURI(t.redirect,!0).send()},0)},o._invokeErrorHandler=function(t){var e=this,r=this.transport;if(r){var i,o,s;if(""===this.responseText)i=1002;else if(this._requestAborted)i=1011;else{try{i=t||r.status||m}catch(t){i=1005}!1===navigator.onLine&&(i=_)}if(t=!0,i===_)s=u._("No Network Connection"),o=u._("Your browser appears to be offline. Please check your internet connection and try again.");else if(i>=300&&i<=399){s=u._("Redirection"),o=u._("Your access to Facebook was redirected or blocked by a third party at this time, please contact your ISP or reload.");var a=r.getResponseHeader("Location");a&&n("goURI")(a,!0),t=!0}else s=u._("Oops"),o=u._("Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.");var l=new(n("AsyncResponse"))(this,r);Object.assign(l,{error:i,errorSummary:s,errorDescription:o,silentError:t}),n("setTimeout")(function(){n("Arbiter").inform("AsyncRequest/error",{request:e,response:l})},0),c()&&!this.getOption("handleErrorAfterUnload")||(this.transportErrorHandler?(a=this.getTransportErrorHandler().bind(this),this.getOption("suppressErrorAlerts")||E.has(i)?E.has(i)&&n("FBLogger")("asyncresponse").addToCategoryKey(String(i)).warn("Async request failed with error %s: %s when requesting %s",i,o.toString(),this.getURI()):n("FBLogger")("asyncresponse").addToCategoryKey(String(i)).mustfix("Async request failed with error %s: %s when requesting %s",i,o.toString(),this.getURI()),n("ErrorGuard").applyWithGuard(this._dispatchErrorResponse,this,[l,a])):n("FBLogger")("asyncresponse").mustfix("Async request to %s failed with a %d error, but there was no error handler available to deal with it.",this.getURI(),i))}},o._isServerDialogErrorCode=function(t){return 1357008==t||1357007==t||1357041==t||1442002==t||1357001==t},o._solveQuicksandChallenge=function(t){var e=this,r=t.getPayload();n("Bootloader").loadModules(["QuickSandSolver"],function(t){t.solveAndSendRequestBack(e,r)},"AsyncRequest")},o._displayServerDialog=function(t,e,r){var i=this;void 0===r&&(r=!1);var o=t.getPayload();void 0===o.__dialog?(e=o.__dialogx,(new(n("ServerJS"))).handle(e),!0!==o.__should_use_mwa_reauth?n("Bootloader").loadModules(["ConfirmationDialog"],function(e){e.setupConfirmation(t,i,r)},"AsyncRequest"):n("Bootloader").loadModules(["MWADeveloperReauthBarrier"],function(e){e.registerRequest(o.__dialogID,i,t)},"AsyncRequest")):this._displayServerLegacyDialog(t,e)},o._displayServerLegacyDialog=function(t,e){var r,i=this,o=t.getPayload().__dialog;n("gkx")("708253")&&n("FBLogger")("comet_infra").addMetadata("COMET_INFRA","ERROR_CODE",t.getError().toString()).addMetadata("COMET_INFRA","ERROR_URL",null!=(r=null==(r=t.request)?void 0:r.getURI())?r:"unknown").mustfix("AsyncRequest._displayServerLegacyDialog called in Comet");n("Bootloader").loadModules(["Dialog"],function(n){n=new n(o),e&&n.setHandler(i._displayConfirmationHandler.bind(i,n)),n.setCancelHandler(function(){var e=i.getServerDialogCancelHandler();try{e&&e(t)}catch(t){throw t}finally{i.finallyHandler(t)}}).setCausalElement(i.relativeTo).show()},"AsyncRequest")},o._displayConfirmationHandler=function(t){this.data.confirmed=1,Object.assign(this.data,t.getFormData()),this.send()},o._setJSONPTransport=function(t){t.subscribe("response",this._handleJSONPResponse.bind(this)),t.subscribe("abort",this._handleJSONPAbort.bind(this)),this.transport=t},o._handleJSONPResponse=function(t,e){(t=this.transport)&&(e.bootloadOnly||(this.is_first=void 0===this.is_first),(e=this._interpretResponse(e)).asyncResponse&&(e.asyncResponse.is_first=this.is_first,e.asyncResponse.is_last=t.hasFinished()),this.invokeResponseHandler(e),t.hasFinished()&&delete this.transport)},o._handleJSONPAbort=function(){this._invokeErrorHandler(),delete this.transport},o._handleXHRResponse=function(t){var e;if(this.getOption("suppressEvaluation"))e={asyncResponse:new(n("AsyncResponse"))(this,t)};else try{this._handleFlushedResponse(),t=t.responseText,t=this._filterOutFlushedText(t),t=this._unshieldResponseText(t),t=JSON.parse(t),e=this._interpretResponse(t)}catch(t){e=t.message,n("FBLogger")("async_request").catching(t).warn("Failed to handle response")}this.invokeResponseHandler(e)},o._handleFlushedResponse=function(){var t=this.flushedResponseHandler,e=this.transport;if(t&&e){var n=e.responseText.indexOf(T);n=-1===n?e.responseText.length:n,t(e.responseText.substring(this.flushedResponseTextParseIndex,n)),this.flushedResponseTextParseIndex=n}},o._unshieldResponseText=function(t){if(t.length<=$)throw new Error("Response too short on async");for(var e=0;" "==t.charAt(e)||"\n"==t.charAt(e);)e++;return e&&t.substring(e,e+$),t.substring(e+$)},o._filterOutFlushedText=function(t){if(!this.flushedResponseHandler)return t;var e=t.indexOf(T);return e<0?t:t.substr(e)},o._interpretResponse=function(t){if(t.redirect)return{redirect:t.redirect};if(t.bootloadOnly)return{bootloadOnly:t.bootloadOnly};var e=t.error&&this._isServerDialogErrorCode(t.error);return this._shouldReplaceTransportMarkers&&t.payload&&!e&&n("replaceTransportMarkers")({relativeTo:this.getRelativeTo(),bigPipeContext:null},t.payload),e=new(n("AsyncResponse"))(this),1!=t.__ar?(n("FBLogger")("AsyncRequest").warn("AsyncRequest to endpoint %s returned a JSON response, but it is not properly formatted. The endpoint needs to provide a response using the AsyncResponse class in PHP.",this.getURI()),e.payload=t):(Object.assign(e,t),(t=this.transport)&&void 0!==t.getAllResponseHeaders&&(e.responseHeaders=t.getAllResponseHeaders())),{asyncResponse:e}},o._isMultiplexable=function(){return this.getOption("useIframeTransport")||this.getOption("useFetchWithIframeFallback")?(n("FBLogger")("AsyncRequest").mustfix("You cannot bundle AsyncRequest that uses iframe transport."),!1):n("isFacebookURI")(new(n("URI"))(this.uri))?!!this.getOption("asynchronous_DEPRECATED")||(n("FBLogger")("AsyncRequest").mustfix("We cannot bundle synchronous AsyncRequests"),!1):(n("FBLogger")("AsyncRequest").mustfix("You can not bundle AsyncRequest sent to non-facebook URIs.  Uri: %s",this.getURI()),!1)},o.handleResponse=function(t){t=this._interpretResponse(t),this.invokeResponseHandler(t)},o.setMethod=function(t){return this.method=t.toString().toUpperCase(),this},o.getMethod=function(){return this.method},o.setData=function(t){return this.data=t,this},o.setRequestHeader=function(t,e){return this.headers[t]=e,this},o.setRawData=function(t){return this.rawData=t,this},o.getData=function(){return this.data},o.setContextData=function(t,e,n){return(n=void 0===n||n)&&(this.context["_log_"+t]=e),this},o._setUserActionID=function(){this.userActionID=(r("SessionName").getName()||"-")+"/-"},o.setURI=function(t,e){void 0===e&&(e=!1),"string"==typeof t&&t.match(/^\/?u_\d+_\d+/)&&n("FBLogger")("asyncrequest").warn("Invalid URI %s",t);var i=new(n("URI"))(t);return!this.getOption("useIframeTransport")&&!this.getOption("useFetchWithIframeFallback")||n("isFacebookURI")(i)?this._allowCrossOrigin||this.getOption("useIframeTransport")||this.getOption("useFetchWithIframeFallback")||i.isSameOrigin()||n("uriIsRelativePath")(i)?(this._setUserActionID(),!t||i.isEmpty()?(n("FBLogger")("async_request").mustfix("URI cannot be empty"),this):(this.uri=r("ZeroRewrites").rewriteURI(i),this)):(e&&l(0,45285),this):(e&&l(0,45284),this)},o.getURI=function(){return this.uri.toString()},o.delayPreDisplayJS=function(t){return void 0===t&&(t=!0),this._delayPreDisplayJS=t,this},o.setInitialHandler=function(t){return this.initialHandler=t,this},o.setPayloadHandler=function(t){return this.setHandler(function(e){t(e.payload)}),this},o.setHandler=function(t){return p(t)&&(this.handler=t),this},o.setFlushedResponseHandler=function(t){return p(t)&&(this.flushedResponseHandler=t),this},o.getHandler=function(){return this.handler||n("emptyFunction")},o.setProgressHandler=function(t){return p(t)&&(this.progressHandler=t),this},o.setUploadProgressHandler=function(t){return p(t)&&(this.uploadProgressHandler=t),this},o.setErrorHandler=function(t){return p(t)&&(this.errorHandler=t),this},o.setTransportErrorHandler=function(t){return this.transportErrorHandler=t,this},o.getErrorHandler=function(){return this.errorHandler||n("emptyFunction")},o.getTransportErrorHandler=function(){return this.transportErrorHandler||n("emptyFunction")},o.setTimeoutHandler=function(t,e){return p(e)&&(this.timeout=t,this.timeoutHandler=e),this},o.resetTimeout=function(t){if(null!==this.timeoutHandler)if(null===t)this.timeout=null,n("clearTimeout")(this.timer),this.timer=null;else{var e=!this._allowCrossPageTransition;this.timeout=t,n("clearTimeout")(this.timer),this.timer=e?n("setTimeout")(this._handleTimeout.bind(this),this.timeout):n("setTimeoutAcrossTransitions")(this._handleTimeout.bind(this),this.timeout)}return this},o.setNewSerial=function(){return this.id=++y,this},o.setInterceptHandler=function(t){return this.interceptHandler=t,this},o.setFinallyHandler=function(t){return this.finallyHandler=t,this},o.setAbortHandler=function(t){return this.abortHandler=t,this},o.getServerDialogCancelHandler=function(){return this.serverDialogCancelHandler},o.setServerDialogCancelHandler=function(t){return this.serverDialogCancelHandler=t,this},o.setPreBootloadHandler=function(t){return this.preBootloadHandler=t,this},o.setReadOnly=function(t){return"boolean"!=typeof t||(this.readOnly=t),this},o.getReadOnly=function(){return this.readOnly},o.setRelativeTo=function(t){return this.relativeTo=t,this},o.getRelativeTo=function(){return this.relativeTo},o.setStatusClass=function(t){return this.statusClass=t,this},o.setStatusElement=function(t){return this.statusElement=t,this},o.getStatusElement=function(){return n("ge")(this.statusElement)},o._isRelevant=function(){return!!this._allowCrossPageTransition||(!this.id||this.id>S)},o.clearStatusIndicator=function(){var t=this.getStatusElement();t&&(r("CSS").removeClass(t,"async_saving"),r("CSS").removeClass(t,this.statusClass))},o._addStatusIndicator=function(){var t=this.getStatusElement();t&&(r("CSS").addClass(t,"async_saving"),r("CSS").addClass(t,this.statusClass))},o.specifiesWriteRequiredParams=function(){var t=this;return this.writeRequiredParams.every(function(e){return t.data[e]=t.data[e]||n("Env")[e]||(n("ge")(e)||{}).value,void 0!==t.data[e]})},o.setOption=function(t,e){return"undefined"!=typeof this.option[t]&&(this.option[t]=e),this},o.getOption=function(t){return this.option[t],this.option[t]},o.abort=function(){var t=this;this.continuation.last(function(){var e=t.transport;if(e){var r=t.getTransportErrorHandler();t.setOption("suppressErrorAlerts",!0),t.setTransportErrorHandler(n("emptyFunction")),t._requestAborted=!0,e.abort(),t.setTransportErrorHandler(r)}t.abortHandler(),B.unschedule(t)})},o.abandon=function(){var t=this;this.continuation.last(function(){n("clearTimeout")(t.timer),t.setOption("suppressErrorAlerts",!0).setHandler(n("emptyFunction")).setErrorHandler(n("emptyFunction")).setTransportErrorHandler(n("emptyFunction")).setProgressHandler(n("emptyFunction")).setUploadProgressHandler(n("emptyFunction"));var e=t.transport;e&&(t._requestAborted=!0,h(e)&&delete e.onprogress,d(e)&&delete e.upload.onprogress,e.abort()),t.abortHandler(),B.unschedule(t)})},o.setNectarModuleDataSafe=function(t){var e=this.setNectarModuleData;return e&&e.call(this,t),this},o.setAllowCrossPageTransition=function(t){
return this._allowCrossPageTransition=!!t,this.timer&&this.resetTimeout(this.timeout),this},o.getAllowIrrelevantRequests=function(){return this._allowIrrelevantRequests},o.setAllowIrrelevantRequests=function(t){return this._allowIrrelevantRequests=t,this},o.setAllowCrossOrigin=function(t){return this._allowCrossOrigin=t,this},o.setAllowCredentials=function(t){return this._allowCredentials=t,this},o.setIsBackgroundRequest=function(t){return this._isBackgroundRequest=t,this},o.setReplaceTransportMarkers=function(t){return void 0===t&&(t=!0),this._shouldReplaceTransportMarkers=t,this},o.sendAndReturnAbortHandler=function(){var t=this;return this.send(),function(){return t.abort()}},o.send=function(e){var o,s,a=this;if(e=e||!1,!this.uri)return!1;if(this.errorHandler||this.getOption("suppressErrorHandlerWarning"),(this.getOption("useIframeTransport")||this.getOption("useFetchWithIframeFallback"))&&"GET"!=this.method&&this.setMethod("GET"),null!==this.timeoutHandler&&(this.getOption("useIframeTransport")||this.getOption("useFetchWithIframeFallback")),!this.getReadOnly()&&(this.specifiesWriteRequiredParams(),"POST"!=this.method))return!1;if(document.location.search.toString().includes(this.uri.toString()))return!1;if(this.uri.toString().includes("/../")||this.uri.toString().includes("\\../")||this.uri.toString().includes("/..\\")||this.uri.toString().includes("\\..\\"))return!1;if(Object.assign(this.data,n("getAsyncParams")(this.method)),n("isEmpty")(this.context)||(Object.assign(this.data,this.context),this.data.ajax_log=1),n("Env").force_param&&Object.assign(this.data,n("Env").force_param),this._setUserActionID(),this.getOption("bundle")&&this._isMultiplexable())return B.schedule(this),!0;if(this.setNewSerial(),this.getOption("asynchronous_DEPRECATED")||this.uri.addQueryData({__sjax:1}),n("Arbiter").inform("AsyncRequest/send",{request:this,ts:n("performanceAbsoluteNow")()}),"GET"==this.method&&this.uri.addQueryData({fb_dtsg_ag:r("DTSG_ASYNC").getToken()}),"GET"==this.method||this.rawData?(o=this.uri.addQueryData(this.data).toString(),s=this.rawData||""):(this._allowCrossOrigin&&this.uri.addQueryData({__a:1}),o=this.uri.toString(),s=r("PHPQuerySerializer").serialize(this.data)),this.transport)return!1;if(this.getOption("useFetchWithIframeFallback"))try{var u=new(n("FetchStreamTransport"))(this.uri);return this._setJSONPTransport(u),this._markRequestSent(),u.send(),this.setOption("useIframeTransport",!1),!0}catch(t){this.setOption("useFetchWithIframeFallback",!1),this.setOption("useIframeTransport",!0)}if(this.getOption("useIframeTransport"))return i(["JSONPTransport"],function(t){t=new t(a.uri),a._setJSONPTransport(t),a._markRequestSent(),t.send()}),!0;this.flushedResponseHandler&&(this.flushedResponseTextParseIndex=0);var l=r("ZeroRewrites").getTransportBuilderForURI(this.uri)();if(!l)return!1;this.schedule("AsyncRequest.send"),l.onreadystatechange=function(){var t=a.transport;t&&t.readyState>=2&&t.readyState<=3&&a._handleFlushedResponse(),4===l.readyState&&a.continuation.last(a._onStateChange)},this.progressHandler&&h(l)&&(l.onprogress=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];a.continuation(function(){a.progressHandler&&a.progressHandler.apply(a,e)})}),this.uploadProgressHandler&&d(l)&&(l.upload.onprogress=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];a.continuation(function(){a.uploadProgressHandler&&a.uploadProgressHandler.apply(a,e)})}),e||(this.remainingRetries=this.getOption("retries")),this.transport=l;try{l.open(this.method,o,!!n("gkx")("1857581")||this.getOption("asynchronous_DEPRECATED"))}catch(t){return!1}if(!(this.uri.isSameOrigin()||n("uriIsRelativePath")(this.uri)||this.getOption("useIframeTransport")||this.getOption("useFetchWithIframeFallback"))){if(!f(l))return!1;this._canSendCredentials()&&(l.withCredentials=!0)}"POST"==this.method&&!this.rawData&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this._isBackgroundRequest&&l.setRequestHeader("X_FB_BACKGROUND_STATE","1");var c=n("getAsyncHeaders")(this.uri);if(Object.keys(c).forEach(function(t){l&&l.setRequestHeader(t,c[t])}),n("Arbiter").inform("AsyncRequest/will_send",{request:this}),l)for(u in this.headers)Object.prototype.hasOwnProperty.call(this.headers,u)&&l.setRequestHeader(u,this.headers[u]);return this._addStatusIndicator(),this._markRequestSent(),l.send(s),null!==this.timeout&&this.resetTimeout(this.timeout),t._inflightCount++,!0},o.schedule=function(t){this.continuation=n("TimeSlice").getReusableContinuation(t)},o._canSendCredentials=function(){if(!1===this._allowCredentials)return!1;var t=new(n("URI"))(this.uri);return n("isBulletinDotComURI")(t)||n("isFacebookURI")(t)||n("isInternalFBURI")(t)||n("isMessengerDotComURI")(t)||n("isWorkplaceDotComURI")(t)||n("isWorkDotMetaDotComURI")(t)||n("isHorizonDotMetaDotComURI")(t)||n("isSparkDotMetaDotComURI")(t)},o._markRequestSent=function(){var t=new(n("URI"))(this.getURI()).getQualifiedURI().toString();r("ResourceTimingsStore").updateURI(n("ResourceTypes").XHR,this.resourceTimingStoreUID,t),r("ResourceTimingsStore").annotate(n("ResourceTypes").XHR,this.resourceTimingStoreUID).addStringAnnotation("uri",t),r("ResourceTimingsStore").measureRequestSent(n("ResourceTypes").XHR,this.resourceTimingStoreUID)},o.promisePayload=function(){return this.exec().then(function(t){return t.payload},function(t){throw t.toError()})},o.exec=function(t){var r=this;if(this.getHandler()!==n("emptyFunction")||this.getErrorHandler()!==n("AsyncResponse").defaultErrorHandler)throw new Error("exec is an async function and does not allow previously set handlers");return new(e("Promise"))(function(e,n){r.setHandler(e).setErrorHandler(n).send(t)})},t.bootstrap=function(e,i,o){var s="GET",a=!0,u={};return(o||i&&"async-post"==i.rel)&&(s="POST",a=!1,e&&(u=(e=new(n("URI"))(e)).getQueryData(),e.setQueryData({}))),(!(o=r("Parent").byClass(i,"stat_elem")||i)||!r("CSS").hasClass(o,"async_saving"))&&(e=new t(e).setReadOnly(a).setMethod(s).setData(u).setNectarModuleDataSafe(i).setRelativeTo(i),i&&(e.setHandler(function(t){n("Event").fire(i,"success",{response:t})}),e.setErrorHandler(function(t){!1!==n("Event").fire(i,"error",{response:t})&&n("AsyncResponse").defaultErrorHandler(t)})),o instanceof HTMLElement&&(e.setStatusElement(o),(a=o.getAttribute("data-status-class"))&&e.setStatusClass(a)),e.send(),!1)},t.post=function(e,n){return new t(e).setReadOnly(!1).setMethod("POST").setData(n).send(),!1},t.postStatic=function(e,n){t.post(e,n)},t.getLastID=function(){return y},t.ignoreUpdate=function(){b=!0},t.getInflightCount=function(){return this._inflightCount},t}();C._inflightCount=0;var w,R=[],B=function(){function t(){this._requests=[]}var e=t.prototype;return e.add=function(t){this._requests.push(t)},e.remove=function(t){for(var e=this._requests,n=this._requestsSent,r=0,i=e.length;r<i;r++)e[r]===t&&(n?e[r]=null:e.splice(r,1))},e.send=function(){this._requestsSent&&l(0,4390),this._requestsSent=!0,this._wrapperRequest=null;var t,e=this._requests;e.length&&(1===e.length?t=e[0]:(e=e.filter(Boolean).map(function(t){return[t.uri.getPath(),r("PHPQuerySerializer").serialize(t.data)]}),t=this._wrapperRequest=new C("/ajax/proxy.php").setAllowCrossPageTransition(!0).setData({data:e}).setHandler(this._handler.bind(this)).setTransportErrorHandler(this._transportErrorHandler.bind(this))),t&&t.setOption("bundle",!1).send())},e._handler=function(t){var e=this,n=t.getPayload().responses;if(n.length===this._requests.length){t=function(t){var r=e._requests[t];if(!r)return"continue";var i=r.uri.getPath();if(e._wrapperRequest&&(r.id=e._wrapperRequest.id),n[t][0]!==i)return r.continuation.last(function(){r.invokeResponseHandler({transportError:"Wrong response order in bundled request to "+i})}),"continue";r.continuation.last(function(){r.handleResponse(n[t][1])})};for(var r=0;r<this._requests.length;r++)t(r);R.splice(R.indexOf(this,1))}},e._transportErrorHandler=function(t){var e=this,n={transportError:t.errorDescription};t=this._requests.filter(Boolean).map(function(t){return e._wrapperRequest&&(t.id=e._wrapperRequest.id),t.invokeResponseHandler(n),t.uri.getPath()})},t.schedule=function(e){return e.schedule("AsyncMultiplex.schedule"),w||(w=new t,R.push(w),n("TimeSlice").guard(function(){n("setTimeoutAcrossTransitions")(function(){w&&(w.send(),w=null)},0)},"AsyncMultiplex.schedule",{propagationType:n("TimeSlice").PropagationType.ORPHAN})()),w.add(e),w},t.unschedule=function(t){R.forEach(function(e){e.remove(t)})},t}();C.suppressOnloadToken={},t.AsyncRequest=C,s["default"]=C},98),__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","cr:3024","gkx","isEmpty"],function(t,e,n,r,i,o,s){var a="javascript-sandbox",u="OverrideServer",l="www_sandbox",c="www_tier";t=function(){function t(){}return t.prototype.patchRequestHeaders=function(t){var r,i={},o=n("RTISubscriptionManagerConfig").bladerunner_www_sandbox,s=n("RTISubscriptionManagerConfig").is_intern;n("isEmpty")(n("WebDriverConfig").auxiliaryServiceInfo)?null!=o&&(i[a]=o):null!=(r=null!=(r=n("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)?r:n("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"])?("string"==typeof r.ip_address?i[u]=r.ip_address+":18295":"string"==typeof r.hostname&&(i[u]=r.hostname+":18295"),"string"==typeof n("WebDriverConfig").originHost&&(i[l]="www."+n("WebDriverConfig").originHost)):null!=o&&(i[a]=o);for(o in!0===s&&(i[c]="intern"),n("WebDriverConfig").isTestRunning&&n("gkx")("5639")&&null!=(r=null==e("cr:3024")?void 0:e("cr:3024").get())&&(i.is_test="1",i.original_request_id=r),n("gkx")("307")&&(i["Accept-Ack"]="RSAck"),t)i[o]=t[o];return i.http_referer=window.location.href,i},t}(),i=new t,s["default"]=i},98),__d("BladeRunnerLogger",["FBLogger","ODS"],function(t,e,n,r,i,o,s){var a="bladerunner_js_client",u={info:"info",warning:"warning",exception:"exception"};t=function(){function t(){this.setFBLoggerLevel(1)}var e=t.prototype;return e.info=function(t){this.$2>=2&&n("FBLogger")(a).info("BladeRunner info: %s",t),this.$3(u.info,t)},e.warn=function(t){this.$2>=1&&n("FBLogger")(a).warn("BladeRunner warn: %s",t),this.$3(u.warning,t)},e.exception=function(t,e){void 0===e&&(e="");var r=e+" "+t.toString();this.$2>=0&&n("FBLogger")(a).warn("BladeRunner exception: %s, %s",e,t.toString()),this.$3(u.exception,r)},e.trimForLogging=function(t){var e=1024;return"string"==typeof t&&t.length>e?"[trimmed]:"+t.substring(0,e)+"...":t},e.bumpCounter=function(t,e){void 0===e&&(e=1),r("ODS").bumpEntityKey(2966,"BladeRunnerClient",t,e)},e.setClientSessionId=function(t){this.$1=t},e.setFBLoggerLevel=function(t){this.$2=t},e.$3=function(){},t}(),i=new t,s["default"]=i},98),__d("BladeRunnerTypes",[],function(t,e,n,r,i,o,s){t={REQUEST:1,DATA:2,DATA_ACK:3,STATUS_UPDATE:4,REWRITE_REQUEST:5,LOG:6},e={BLADE_RUNNER:1,GATEWAY:2},s.StreamFrameType=t,s.StreamRequestType=e},98),__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],function(t,e,n,r,i,o,s){function a(t){if("number"==typeof t)return t;throw new Error("Expected number")}function u(t){return null==t?null:a(t)}function l(t){if("string"==typeof t)return t;throw new Error("Expected string")}function c(t){return null==t?null:l(t)}function h(t){if("object"==typeof t&&null!=t)return t;throw new Error("Expected object")}function d(t){if("object"==typeof t&&null!=t){var e=t,n={};return Object.keys(e).forEach(function(t){var r=e[t];"string"==typeof r&&null!=r&&(n[t]=r)}),n}throw new Error("Expected string map")}function f(t){return null==t?null:d(t)}function g(t){if("boolean"==typeof t&&null!=t)return t;throw new Error("Expected boolean")}function p(t){return null==t?null:g(t)}var _=function(){function t(){}var e=t.prototype;return e.getHeaders=function(){if(null!=this.headers)return this.headers;throw new Error("Expected headers")},e.getInstrumentationData=function(){if(!(null!=this.instrumentationData&&this.instrumentationData.length>0))return null;try{return JSON.parse(this.instrumentationData)}catch(t){return null}},e.updateRetryRequestPayload=function(t){this.payload=null!=t?n("Base64").encode(t):null},t.readObject=function(e){var n=new t;return n.streamId=a(e.streamId),n.requestType=a(e.requestType),n.payload=c(e.payload),n.headers=f(e.headers),n.extraHeader=c(e.extraHeader),n.requestTarget=c(e.requestTarget),n.instrumentationData=c(e.instrumentationData),n},t}(),m=function(){function t(){}t.readObject=function(e){var n=new t;return n.streamId=a(e.streamId),n.dataId=u(e.dataId),n.data=c(e.data),n.shouldAck=p(e.shouldAck),n};var e=t.prototype;return e.rawData=function(){if(null==this.data)throw new Error("Expected data");return this.data},e.rawDataSize=function(){return null==this.data?0:this.data.length},e.decodeData=function(){if(null==this.data)throw new Error("Expected data");return n("Base64").decode(this.data)},e.setData=function(t){this.data=n("Base64").encode(t)},e.getInstrumentationData=function(){return null!=this.instrumentationData?JSON.parse(this.instrumentationData):null},t}(),v=function(){function t(){}return t.readObject=function(e){var n=new t;return n.streamId=a(e.streamId),n.dataId=a(e.dataId),n.success=g(e.success),n.message=c(e.message),n.code=u(e.code),n},t}();v.ACK_CODE_LANDED_AND_ACCEPTED=20,v.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21,v.ACK_CODE_FAILED_TO_LAND=50;var E=function(){function t(){}return t.readObject=function(e){var n=new t;return n.streamId=u(e.streamId),n.message=c(e.message),n},t}(),y=function(){function t(){}return t.readObject=function(e){var n=new t;return n.streamId=a(e.streamId),n.status=a(e.status),n.message=c(e.message),n.code=u(e.code),n.shouldRetry=p(e.shouldRetry),n.retryDelayMs=u(e.retryDelayMs),n},t}(),S=function(){function t(){}return t.readObject=function(e){var n=new t;return n.streamId=a(e.streamId),n.newBody=c(e.newBody),n.newExtraHeader=c(e.newExtraHeader),n.patchExtraHeader=c(e.patchExtraHeader),n.killBody=p(e.killBody),n.temporary=p(e.temporary),n},t}(),b=function(){function t(){}var e=t.prototype;return e.getRequest=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.REQUEST&&null!=this.request)return this.request;throw new Error("Expected request")},e.getData=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.DATA&&null!=this.data)return this.data;throw new Error("Expected data")},e.getDataAck=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.DATA_ACK&&null!=this.dataAck)return this.dataAck;throw new Error("Expected dataAck")},e.getStatusUpdate=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&null!=this.statusUpdate)return this.statusUpdate;throw new Error("Expected status update")},e.getLog=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.LOG&&null!=this.log)return this.log;throw new Error("Expected log")},e.getRewriteRequest=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&null!=this.rewriteRequest)return this.rewriteRequest;throw new Error("Expected rewrite request")},e.getStreamId=function(){if(this.type==r("BladeRunnerTypes").StreamFrameType.REQUEST&&null!=this.request)return this.request.streamId;if(this.type==r("BladeRunnerTypes").StreamFrameType.DATA&&null!=this.data)return this.data.streamId;if(this.type==r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&null!=this.statusUpdate)return this.statusUpdate.streamId;if(this.type==r("BladeRunnerTypes").StreamFrameType.LOG&&null!=this.log)return this.log.streamId;if(this.type==r("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&null!=this.rewriteRequest)return this.rewriteRequest.streamId;if(this.type==r("BladeRunnerTypes").StreamFrameType.DATA_ACK&&null!=this.dataAck)return this.dataAck.streamId;throw new Error("Frame with unexpected type")},e.isInstrumented=function(){return this.type===r("BladeRunnerTypes").StreamFrameType.REQUEST?null!=this.getRequest().instrumentationData:this.type===r("BladeRunnerTypes").StreamFrameType.DATA&&null!=this.getData().instrumentationData},t.readObject=function(e){var i=new t;switch(i.type=a(e.type),i.type){case r("BladeRunnerTypes").StreamFrameType.REQUEST:i.request=_.readObject(h(e.request));break;case r("BladeRunnerTypes").StreamFrameType.DATA:i.data=m.readObject(h(e.data));break;case r("BladeRunnerTypes").StreamFrameType.DATA_ACK:i.dataAck=v.readObject(h(e.dataAck));break;case r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:i.statusUpdate=y.readObject(h(e.statusUpdate));break;case r("BladeRunnerTypes").StreamFrameType.LOG:i.log=E.readObject(h(e.log));break;case r("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:i.rewriteRequest=S.readObject(h(e.rewriteRequest));break;default:return n("BladeRunnerLogger").warn("Frame with unexpected type: "+i.type),null}return i},t.newRequestFrame=function(e){var n=new t;return n.type=r("BladeRunnerTypes").StreamFrameType.REQUEST,n.request=e,n},t.newDataFrame=function(e){var n=new t;return n.type=r("BladeRunnerTypes").StreamFrameType.DATA,n.data=e,n},t.newDataAckFrame=function(e){var n=new t;return n.type=r("BladeRunnerTypes").StreamFrameType.DATA_ACK,n.dataAck=e,n},t.newStatusUpdateFrame=function(e){var n=new t;return n.type=r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE,n.statusUpdate=e,n},t.newLogFrame=function(e){var n=new t;return n.type=r("BladeRunnerTypes").StreamFrameType.LOG,n.log=e,n},t.newRewriteRequestFrame=function(e){var n=new t;return n.type=r("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST,n.rewriteRequest=e,n},t}();t=function(){function t(t,e,n){this.batchId=t,this.frames=e,this.instrumentationData=n}var e=t.prototype;return e.getFrames=function(){if(null!=this.frames)return this.frames;throw new Error("Expected frames")},e.getInstrumentationData=function(){if(null==this.instrumentationData)return null;try{return JSON.parse(this.instrumentationData)}catch(t){return null}},e.getInstrumentationDataDfTraceId=function(){if(null==this.instrumentationData)return null;try{var t=JSON.parse(this.instrumentationData);return null==(t=t.dataFlowTracingData)?void 0:t.traceId}catch(t){return null}},e.write=function(){return JSON.stringify(this)},e.isInstrumented=function(){return this.getFrames().some(function(t){return t.isInstrumented()})},t.read=function(e){var n=(e=JSON.parse(e)).batchId||0,r=[],i=e.frames,o=Array.isArray(i),s=0;for(i=o?i:i["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var a;if(o){if(s>=i.length)break;a=i[s++]}else{if((s=i.next()).done)break;a=s.value}a=a,null!=(a=b.readObject(a))&&r.push(a)}return new t(n,r,a=e.instrumentationData||null)},t}(),s.GatewayStreamRequest=_,s.GatewayStreamData=m,s.GatewayStreamDataAck=v,s.GatewayStreamLog=E,s.GatewayStreamStatusUpdate=y,s.GatewayStreamRewriteRequest=S,s.GatewayStreamFrame=b,s.GatewayStreamBatch=t},98),__d("RequestStreamE2EClientLoggerEvent",[],function(t,e,n,r,i,o){t=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"}),o["default"]=t},66),__d("RequestStreamE2EClientLoggerMessageType",[],function(t,e,n,r,i,o){t=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"}),o["default"]=t},66),__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","setTimeoutAcrossTransitions"],function(t,e,n,r,i,o,s){var a=1e3;t=function(){function t(t,e,n){this.$2=t,this.$1=e,this.$3=n}var e=t.prototype;return e.onProxyResponse=function(t){this.$4(t);var e=[],i=t.getFrames(),o=Array.isArray(i),s=0;for(i=o?i:i["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var a;if(o){if(s>=i.length)break;a=i[s++]}else{if((s=i.next()).done)break;a=s.value}a=a,this.$2.witnessFrame(a)&&e.push(a)}null==(s=(a=this.$2.getRequest()).e2eLogger)||s.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").RESPONSE,n("RequestStreamE2EClientLoggerEvent").SENT,{},null==(o=t.getInstrumentationData())?void 0:o.auxId,null,t.getInstrumentationDataDfTraceId()),e.length>0&&this.$5(new(r("BladeRunnerTypesInternal").GatewayStreamBatch)(t.batchId,e,t.instrumentationData))},e.onDisconnect=function(){this.$2.resetErrors();var t=new(r("BladeRunnerTypesInternal").GatewayStreamStatusUpdate);t.streamId=this.$2.getRequest().streamId,t.status=r("BladeRunnerStreamStatus").StreamStatus.CLOSED,t.shouldRetry=!0,t.retryDelayMs=0,t=new(r("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[r("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(t)]),this.onProxyResponse(t)},e.$4=function(t){var e=this,i=(t=t=t.getFrames().filter(function(t){return t.type==r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE}),Array.isArray(t)),o=0;for(t=i?t:t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var s;if(i){if(o>=t.length)break;s=t[o++]}else{if((o=t.next()).done)break;s=o.value}if((s=(s=s).getStatusUpdate()).status==r("BladeRunnerStreamStatus").StreamStatus.CLOSED||s.status==r("BladeRunnerStreamStatus").StreamStatus.REJECTED){this.$2.onError();var u=null!=s.shouldRetry&&s.shouldRetry,l=null!=s.message?s.message:"null";if(u&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){s.status=r("BladeRunnerStreamStatus").StreamStatus.STOPPED;var c=a;null!=s.retryDelayMs&&(c=s.retryDelayMs),n("BladeRunnerLogger").info("Can retry: stream "+s.streamId+" closed with status "+s.status+", message "+l+". Error count: "+this.$2.getErrorCount()+", retryDelay "+c+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString()),this.$2.getRetryRequestScheduled()?n("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(n("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),c>0?n("setTimeoutAcrossTransitions")(function(){return e.$6()},c):this.$6())}else n("BladeRunnerLogger").info("Will not retry: stream "+s.streamId+" closed with status "+s.status+", message "+l+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+u.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),u?n("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):n("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(s.streamId)}}},e.$6=function(){if(this.$2.setRetryRequestScheduled(!1),this.$2.isAlive()){var t=this.$1.getUpdatedRequestBody();null!=t&&this.$2.updateRetryRequestPayload(t),this.$3.sendRetryStreamRequest(this.$2)}},e.$5=function(t){n("BladeRunnerLogger").bumpCounter("send_to_handler");var e=[];this.$1.onBatch(t);t=t.getFrames();var i=Array.isArray(t),o=0;for(t=i?t:t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var s;if(i){if(o>=t.length)break;s=t[o++]}else{if((o=t.next()).done)break;s=o.value}s=s;try{switch(s.type){case r("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(s.getData()),e.push(s.getData());break;case r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(s.getStatusUpdate().status);break;case r("BladeRunnerTypes").StreamFrameType.LOG:null!=(s=s.getLog().message)&&this.$1.onLog(s);break;case r("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(t){n("BladeRunnerLogger").bumpCounter("send_to_handler_error"),n("BladeRunnerLogger").exception(t,"Failed sending frame to stream handler")}}this.$7(e)},e.$7=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];if(!0===i.shouldAck&&null!=i.dataId){var o=new(r("BladeRunnerTypesInternal").GatewayStreamDataAck);o.streamId=i.streamId,o.dataId=i.dataId,o.success=!0,e.push(o)}}this.$3.sendDataAcks(e)},t}(),s["default"]=t},98),__d("MqttEnv",["killswitch"],function(t,e,n,r,i,o,s){"use strict";function t(t){u.setIsUserLoggedInNow(t)}e=Object.freeze({mqtt_waterfall_log_client_sampling:1,mqtt_ws_polling_enabled:3,mqtt_lp_use_fetch:9,mqtt_fast_lp:11,mqtt_lp_no_delay:12,mqtt_enable_publish_over_polling:13,mqttweb_global_connection_counter:15}),r=function(){function t(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null,this.$12=null}var e=t.prototype;return e.random=function(){return null!=this.$1?this.$1():Math.random()},e.isUserLoggedInNow=function(){return null==this.$2||this.$2()},e.setIsUserLoggedInNow=function(t){this.$2=t},e.clearTimeout=function(t){null==this.$3?window.clearTimeout(t):this.$3(t)},e.setTimeout=function(){for(var t=arguments.length,e=new Array(t>2?t-2:0),n=2;n<t;n++)e[n-2]=arguments[n];return null!=this.$4?this.$4.apply(null,arguments):window.setTimeout.apply(null,arguments)},e.getLoggerInstance=function(){return null!=this.$5?this.$5():a.getInstance()},e.genGk=function(t){return null!=this.$6&&this.$6(t)},e.killswitch=function(t){return null!=this.$7?this.$7(t):n("killswitch")(t)},e.createSocket=function(t,e){return null!=this.$8?this.$8(t,e):new WebSocket(t)},e.scheduleCallback=function(t){return null!=this.$9?this.$9(t):t()},e.scheduleLoggingCallback=function(t){return null!=this.$10?this.$10(t):t()},e.configRead=function(t,e){return null!=this.$11?this.$11(t,e):e},e.configWrite=function(t,e){null!=this.$12&&this.$12(t,e)},e.initialize=function(t,e,n,r,i,o,s,a,u,l,c,h){this.$1=t,this.$2=e,this.$3=n,this.$4=r,this.$5=i,this.$6=o,this.$7=h,this.$8=s,this.$9=a,this.$10=u,this.$11=l,this.$12=c},t}();var a=function(){function t(){}t.getInstance=function(){return new t};var e=t.prototype;return e.setAppId=function(){},e.eventLogConnect=function(){},e.eventLogPull=function(){},e.eventLogPullFinish=function(){},e.eventLogDisconnect=function(){},e.eventLogOutgoingPublish=function(){},e.eventLogIncomingPublish=function(){},e.eventLogPublishTimeout=function(){},e.eventLogMiscellaneousError=function(){},e.logIfLoggedOut=function(){},e.logError=function(){},e.logErrorWarn=function(){},e.logWarn=function(){},e.debugTrace=function(){},e.bumpCounter=function(){},e.getBrowserConnectivity=function(){return!0},t}(),u=new r;s.MqttGkNames=e,s.Env=u,s.setIsUserLoggedInNow=t},98),__d("IrisSubscribeChecker",["MqttEnv"],function(t,e,n,r,i,o){"use strict";t=function(){function t(t){this.$1=r("MqttEnv").Env.getLoggerInstance(),this.$2=null,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=!0,this.$7=0,this.$8=t,"undefined"!=typeof window&&("m.facebook.com"===(t=window.location.hostname)||"mobile.facebook.com"===t||"mtouch.facebook.com"===t)&&(this.$6=!1)}var e=t.prototype;return e.start=function(){this.$6=!0},e.stop=function(){this.$6=!1,this.$9()},e.onConnectAttempt=function(){},e.onConnectFailure=function(){this.$9()},e.onConnected=function(){var t=this;this.$7++,this.$9(),this.$3=!1,this.$4=!1,this.$5=!1,this.$6&&(this.$2=r("MqttEnv").Env.setTimeout(function(){t.$10()},8e3))},e.onConnectSuccess=function(){},e.onConnectionLost=function(){this.$9()},e.onConnectionDisconnect=function(){},e.onSubscribe=function(t){"/t_ms"===t&&(this.$3=!0)},e.onUnsubscribe=function(){},e.onPublish=function(t){("/messenger_sync_get_diffs"===t||"/messenger_sync_create_queue"===t)&&(this.$4=!0,this.$3&&(this.$5=!0,this.$9()))},e.onMessage=function(){},e.onWSFatal=function(){},e.$9=function(){this.$2&&(r("MqttEnv").Env.clearTimeout(this.$2),this.$2=null)},e.$10=function(){if(!1===this.$4){var t=1==this.$7?"no_iris_session_initialConnect":"no_iris_session";this.$1.bumpCounter(t),this.$8()?this.$1.bumpCounter(t+".withProvider"):this.$1.bumpCounter(t+".withoutProvider"),!0===this.$3?this.$1.bumpCounter(t+".withTopicSubscribe"):this.$1.bumpCounter(t+".withoutTopicSubscribe")}!1===this.$3&&this.$1.bumpCounter("no_iris_topic_subscribe"),!0===this.$3&&!0===this.$4&&!1===this.$5&&this.$1.bumpCounter("session_before_topic_subscribe")},t}(),o.exports=t},34),__d("CacheStorage",["ErrorGuard","EventListenerImplForCacheStorage","ExecutionEnvironment","FBJSON","WebStorage","emptyFunction","err","killswitch"],function(t,e,n,r,i,o,s){var a="_@_",u="3b",l="CacheStorageVersion",c={length:0,getItem:n("emptyFunction"),setItem:n("emptyFunction"),clear:n("emptyFunction"),removeItem:n("emptyFunction"),key:n("emptyFunction")};t=function(){function t(t){this._store=t}var e=t.prototype;return e.getStore=function(){return this._store},e.keys=function(){for(var t=[],e=0;e<this._store.length;e++){var n=this._store.key(e);null!=n&&t.push(n)}return t},e.get=function(t){return this._store.getItem(t)},e.set=function(t,e){this._store.setItem(t,e)},e.remove=function(t){this._store.removeItem(t)},e.clear=function(){this._store.clear()},e.clearWithPrefix=function(t){t=t||"";for(var e=this.keys(),n=0;n<e.length;n++){var r=e[n];null!=r&&r.startsWith(t)&&this.remove(r)}},t}(),e=function(t){function e(){var e;return t.call(this,null!=(e=n("WebStorage").getLocalStorage())?e:c)||this}return babelHelpers.inheritsLoose(e,t),e.available=function(){return!!n("WebStorage").getLocalStorage()},e}(t),i=function(t){function e(){var e;return t.call(this,null!=(e=n("WebStorage").getSessionStorage())?e:c)||this}return babelHelpers.inheritsLoose(e,t),e.available=function(){return!!n("WebStorage").getSessionStorage()},e}(t);var h=function(){function t(){this._store={}}var e=t.prototype;return e.getStore=function(){return this._store},e.keys=function(){return Object.keys(this._store)},e.get=function(t){return void 0===this._store[t]?null:this._store[t]},e.set=function(t,e){this._store[t]=e},e.remove=function(t){t in this._store&&delete this._store[t]},e.clear=function(){this._store={}},e.clearWithPrefix=function(t){t=t||"";for(var e=this.keys(),n=0;n<e.length;n++){var r=e[n];r.startsWith(t)&&this.remove(r)}},t.available=function(){return!0},t}(),d={memory:h,localstorage:e,sessionstorage:i};(s=function(){function t(t,e){this._changeCallbacks=[],this._key_prefix="_cs_",this._exception=null,e&&(this._key_prefix=e),(e="AUTO"!==t&&t?t:"memory")&&(d[e]&&d[e].available()?this._backend=new d[e]:(n("ExecutionEnvironment").canUseDOM,this._backend=new h)),(t=this.useBrowserStorage())&&n("EventListenerImplForCacheStorage").listen(window,"storage",this._onBrowserValueChanged.bind(this)),(e=t?this._backend.getStore().getItem(l):this._backend.getStore()[l])!==u&&(n("killswitch")("CACHE_STORAGE_MODULE_CLEAR_OWN_KEYS")?this.clear():this.clearOwnKeys())}var e=t.prototype;return e.useBrowserStorage=function(){return this._backend.getStore()===n("WebStorage").getLocalStorage()||this._backend.getStore()===n("WebStorage").getSessionStorage()},e.addValueChangeCallback=function(t){var e=this;return this._changeCallbacks.push(t),{remove:function(){e._changeCallbacks.slice(e._changeCallbacks.indexOf(t),1)}}},e._onBrowserValueChanged=function(t){this._changeCallbacks&&String(t.key).startsWith(this._key_prefix)&&this._changeCallbacks.forEach(function(e){e(t.key,t.oldValue,t.newValue)})},e.keys=function(){var t=this,e=[];return n("ErrorGuard").guard(function(){if(t._backend)for(var n=t._backend.keys(),r=t._key_prefix.length,i=0;i<n.length;i++)n[i].substr(0,r)==t._key_prefix&&e.push(n[i].substr(r))},{name:"CacheStorage"})(),e},e.set=function(e,i,o){if(this._backend){if(this.useBrowserStorage()&&t._persistentWritesDisabled)return this._exception=n("err")("writes disabled"),!1;var s;"string"==typeof i?s=a+i:o?s=r("FBJSON").stringify(i):(s={__t:Date.now(),__v:i},s=r("FBJSON").stringify(s)),o=this._backend,i=this._key_prefix+e,e=!0;for(var u=null;e;)try{u=null,o.set(i,s),e=!1}catch(t){u=t;var l=o.keys().length;this._evictCacheEntries(),e=o.keys().length<l}return null!==u?(this._exception=u,!1):(this._exception=null,!0)}return this._exception=n("err")("no back end"),!1},e.getLastSetExceptionMessage=function(){return this._exception?this._exception.message:null},e.getLastSetException=function(){return this._exception},e.getStorageKeyCount=function(){var t=this._backend;return t?t.keys().length:0},e._evictCacheEntries=function(){var e=[],n=this._backend;n.keys().forEach(function(i){if(i!==l){var s=n.get(i);if(void 0!==s){if(!t._hasMagicPrefix(s)){try{s=r("FBJSON").parse(s,o.id)}catch(t){return void n.remove(i)}s&&void 0!==s.__t&&void 0!==s.__v&&e.push([i,s.__t])}}else n.remove(i)}}),e.sort(function(t,e){return t[1]-e[1]});for(var i=0;i<Math.ceil(e.length/2);i++)n.remove(e[i][0])},e.get=function(e,i){var s;if(this._backend)if(n("ErrorGuard").applyWithGuard(function(){s=this._backend.get(this._key_prefix+e)},this,[],{onError:function(){s=null},name:"CacheStorage:get"}),null!=s)if(t._hasMagicPrefix(s))s=s.substr(a.length);else try{(s=r("FBJSON").parse(s,o.id))&&void 0!==s.__t&&void 0!==s.__v&&(s=s.__v)}catch(t){s=void 0}else s=void 0;return void 0===s&&void 0!==i&&(s=i,this.set(e,s)),s},e.remove=function(t){this._backend&&n("ErrorGuard").applyWithGuard(this._backend.remove,this._backend,[this._key_prefix+t],{name:"CacheStorage:remove"})},
e._setVersion=function(){var t=this;n("ErrorGuard").applyWithGuard(function(){t.useBrowserStorage()?t._backend.getStore().setItem(l,u):t._backend.getStore()[l]=u},this,[],{name:"CacheStorage:setVersion"})},e.clear=function(){this._backend&&(n("ErrorGuard").applyWithGuard(this._backend.clear,this._backend,[],{name:"CacheStorage:clear"}),this._setVersion())},e.clearOwnKeys=function(){this._backend&&(n("ErrorGuard").applyWithGuard(this._backend.clearWithPrefix,this._backend,[this._key_prefix],{name:"CacheStorage:clearOwnKeys"}),this._setVersion())},t.getAllStorageTypes=function(){return Object.keys(d)},t._hasMagicPrefix=function(t){return t.substr(0,a.length)===a},t.disablePersistentWrites=function(){t._persistentWritesDisabled=!0},t}())._persistentWritesDisabled=!1,o.exports=s},34),__d("CrossWindowEventEmitter",["CacheStorage","EventEmitter","FBJSON"],function(t,e,n,r,i,o,s){"use strict";t=function(t){function e(e){var i;return(i=t.call(this)||this).$CrossWindowEventEmitter2=e,i.$CrossWindowEventEmitter1=new(n("CacheStorage"))("localstorage",e+":"),i.$CrossWindowEventEmitter1.addValueChangeCallback(function(e,n,o){n=e.split(":")[1];try{e=r("FBJSON").parse(o)}catch(t){e=void 0}e&&e.__v&&(o=t.prototype.emit).call.apply(o,[babelHelpers.assertThisInitialized(i),n].concat(e.__v))}),i}babelHelpers.inheritsLoose(e,t);var i=e.prototype;return i.emit=function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];this.emitRemote.apply(this,[e].concat(i)),(n=t.prototype.emit).call.apply(n,[this,e].concat(i))},i.emitRemote=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.$CrossWindowEventEmitter1.set(t,n)},e}(n("EventEmitter")),s["default"]=t},98),__d("MqttGlobalStreamCounter",["CrossWindowEventEmitter","MqttEnv","uuid"],function(t,e,n,r,i,o,s){"use strict";t=function(){function t(){var t=this;this.isTabClosed=!1,this.otherTabs=new Map,this.thisTab={totalConnectionStreams:0},this.broadcastChannel=new(n("CrossWindowEventEmitter"))("MqttGlobalStreamCounter"),this.broadcastChannel.addListener("count-updated",function(e){e=JSON.parse(String(e));var n=!1;t.otherTabs.has(e.key)||(n=!0),"DELETE"===e.event?t.otherTabs["delete"](e.key):"UPDATE"===e.event&&null!=e.value&&(t.otherTabs.set(e.key,e.value),n&&t.$1())}),this.tabID=n("uuid")()}var e=t.prototype;return e.streamRequested=function(){this.thisTab.totalConnectionStreams++,this.$1()},e.streamClosed=function(){this.thisTab.totalConnectionStreams>0&&(this.thisTab.totalConnectionStreams--,this.$1())},e.tabClosed=function(){if(!this.isTabClosed){this.isTabClosed=!0;var t={key:this.tabID,event:"DELETE"};this.broadcastChannel.emitRemote("count-updated",JSON.stringify(t))}},e.getGlobalState=function(){var t={totalConnectionStreams:this.thisTab.totalConnectionStreams};return this.otherTabs.forEach(function(e){t.totalConnectionStreams+=e.totalConnectionStreams}),t},e.$1=function(){var t={key:this.tabID,event:"UPDATE",value:this.thisTab};this.broadcastChannel.emitRemote("count-updated",JSON.stringify(t))},e.isEnabled=function(){return!0},t}();var a=r("MqttEnv").Env.genGk(r("MqttEnv").MqttGkNames.mqttweb_global_connection_counter)?new t:{streamRequested:function(){},streamClosed:function(){},tabClosed:function(){},getGlobalState:function(){return{totalConnectionStreams:-1}},isEnabled:function(){return!1}};e=function(){return a},s.getInstance=e},98),__d("MqttAnalyticsHook",["MqttEnv","MqttGlobalStreamCounter"],function(t,e,n,r,i,o,s){"use strict";t=function(){function t(){this.$1=r("MqttEnv").Env.getLoggerInstance(),this.$2=r("MqttGlobalStreamCounter").getInstance(),this.$3=0,this.$4=0,this.$5=0,this.$6=0,this.$1.bumpCounter("session_start"),r("MqttEnv").Env.isUserLoggedInNow()||this.$1.bumpCounter("session_start.logout")}var e=t.prototype;return e.onConnectAttempt=function(){this.$1.bumpCounter("ws_connect_attempt"),this.$2.streamRequested()},e.onConnectFailure=function(){this.$4++,this.$1.bumpCounter("ws_connect_failure"),this.$1.debugTrace("connect","Connect failed existing streams count "+this.$2.getGlobalState().totalConnectionStreams),this.$2.streamClosed()},e.onConnected=function(){this.$1.bumpCounter("ws_connect_connected")},e.onConnectSuccess=function(){0===this.$3&&this.$1.bumpCounter("ws_connect_first_success"),this.$3++,this.$1.bumpCounter("ws_connect_success")},e.onConnectionLost=function(){this.$1.bumpCounter("ws_disconnect")},e.onConnectionDisconnect=function(){this.$2.streamClosed()},e.onSubscribe=function(){},e.onUnsubscribe=function(){},e.onPublish=function(t){this.$1.bumpCounter("ws_publish."+t)},e.onMessage=function(t){this.$1.bumpCounter("message_arrived."+t)},e.onWSFatal=function(){this.$1.bumpCounter("ws_fatal")},e.onPollRequestSent=function(){this.$1.bumpCounter("polling_request_send"),this.$2.streamRequested()},e.onPollRequestSuccess=function(){this.$1.bumpCounter("polling_request_succeed"),0===this.$5&&this.$1.bumpCounter("polling_first_success"),this.$5++},e.onPollResponse=function(t){this.$1.bumpCounter("lp.message_arrived."+t)},e.onPollFinish=function(){this.$1.bumpCounter("polling_request_finish"),this.$2.streamRequested()},e.onPollRequestFailed=function(t){this.$1.bumpCounter("polling_request_failed"),this.$1.bumpCounter("polling_request_failed_"+t),this.$6++,this.$1.debugTrace("PollRequest","Request failed existing streams count "+this.$2.getGlobalState().totalConnectionStreams),this.$2.streamClosed()},e.onPollShutdownAbort=function(){this.$2.streamClosed()},e.onTabClose=function(){this.$2.tabClosed()},t}(),s["default"]=t},98),__d("MqttConnectionHookCollection",[],function(t,e,n,r,i,o){"use strict";t=function(){function t(){this.$1=new Set}var e=t.prototype;return e.addHook=function(t){this.$1.add(t)},e.removeHook=function(t){this.$1["delete"](t)},e.onConnectAttempt=function(){this.$1.forEach(function(t){t.onConnectAttempt()})},e.onConnectFailure=function(){this.$1.forEach(function(t){t.onConnectFailure()})},e.onConnected=function(){this.$1.forEach(function(t){t.onConnected()})},e.onConnectSuccess=function(){this.$1.forEach(function(t){t.onConnectSuccess()})},e.onConnectionLost=function(){this.$1.forEach(function(t){t.onConnectionLost()})},e.onConnectionDisconnect=function(){this.$1.forEach(function(t){t.onConnectionDisconnect()})},e.onSubscribe=function(t){this.$1.forEach(function(e){e.onSubscribe(t)})},e.onUnsubscribe=function(t){this.$1.forEach(function(e){e.onUnsubscribe(t)})},e.onPublish=function(t){this.$1.forEach(function(e){e.onPublish(t)})},e.onMessage=function(t){this.$1.forEach(function(e){e.onMessage(t)})},e.onWSFatal=function(){this.$1.forEach(function(t){t.onWSFatal()})},t}(),o["default"]=t},66),__d("MqttProtocolUtils",["MqttEnv"],function(t,e,n,r,i,o,s){function t(t,e){if(null==t)return e;var n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function e(t,e){e=e;var n,r=0,i=1;do{if(e===t.length)return null;r+=(127&(n=t[e++]))*i,i*=128}while(0!=(128&n));return{value:r,offset:e}}function n(t){t=t;for(var e=new Array(1),n=0;n<4;n++){var r=t%128;if(!((t>>=7)>0)){e[n]=r;break}e[n]=128|r}return e}function a(t,e,n){return n=n,e[n++]=t>>8,e[n++]=t%256,n}function i(t,e){return 256*t[e]+t[e+1]}function o(t){for(var e=0,n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);i<128?e+=1:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e}function u(t,e,n,r){return l(t,n,r=a(e,n,r)),r+e}function l(t,e,n){n=n;for(var r=0,i=t.length;r<i;r++){var o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=192|o>>6,e[n++]=128|63&o):o<55296||o>=57344?(e[n++]=224|o>>12,e[n++]=128|o>>6&63,e[n++]=128|63&o):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++r)),e[n++]=240|o>>18,e[n++]=128|o>>12&63,e[n++]=128|o>>6&63,e[n++]=128|63&o)}}function c(t,e,n){for(var r=[],i=e,o=0;i<e+n;){var s=t[i++];if(s<128)r[o++]=String.fromCharCode(s);else if(s>191&&s<224){var a=t[i++];r[o++]=String.fromCharCode((31&s)<<6|63&a)}else if(s>239&&s<365){a=t[i++];var u=t[i++],l=t[i++];a=((7&s)<<18|(63&a)<<12|(63&u)<<6|63&l)-65536,r[o++]=String.fromCharCode(55296+(a>>10)),r[o++]=String.fromCharCode(56320+(1023&a))}else u=t[i++],l=t[i++],r[o++]=String.fromCharCode((15&s)<<12|(63&u)<<6|63&l)}return r.join("")}var h=function(){function t(t,e,n,r){this.$1=t,this.$2=e,this.$5=n,this.$6=r,this.$4=!1}var e=t.prototype;return e.$7=function(){var t=this;this.$4?(this.$4=!1,this.$5(),this.$3=r("MqttEnv").Env.setTimeout(function(){t.$7()},1e3*this.$2())):this.$6()},e.reset=function(){var t=this;this.$4=!0,this.$3&&(r("MqttEnv").Env.clearTimeout(this.$3),this.$3=null);var e=1e3*this.$1();e>0&&(this.$3=r("MqttEnv").Env.setTimeout(function(){t.$7()},e))},e.cancel=function(){this.$3&&(r("MqttEnv").Env.clearTimeout(this.$3),this.$3=null)},t}();s.UTF8Length=o,s.convertStringToUTF8=l,s.concatBuffers=t,s.decodeMultiByteInt=e,s.convertUTF8ToString=c,s.encodeMultiByteInt=n,s.writeUInt16BE=a,s.readUInt16BE=i,s.writeString=u,s.Pinger=h},98),__d("MqttUtils",["MqttEnv"],function(t,e,n,r,i,o){"use strict";var s={endpointWithSessionId:function(t,e){return s.endpointWithExtraParameter(t,"sid",e.toString())},endpointWithExtraParameters:function(t,e){var n=t;return e.forEach(function(t,e){n=s.endpointWithExtraParameter(n,e,t)}),n},endpointWithExtraParameter:function(t,e,n){return t.indexOf("?")>0?t+"&"+e+"="+n:t+"?"+e+"="+n},generateSessionId:function(){return Math.floor(r("MqttEnv").Env.random()*Number.MAX_SAFE_INTEGER)},promiseDone:function(t,e,n){(arguments.length>1?t.then(e,n):t).then(null,function(t){r("MqttEnv").Env.setTimeout(function(){throw t instanceof Error?t:new Error("promiseDone")},0)})},promiseDoneWithTimeout:function(t,e,n,i){var o=!1;r("MqttEnv").Env.setTimeout(function(){o||(o=!0,n(new Error("promise timeout")))},i),s.promiseDone(t,function(t){o||(o=!0,e(t))},function(t){o||(o=!0,n(t))})},sprintf:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=0;return t.replace(/%s/g,function(){return String(n[i++])})},hasWSSupport:function(){return"WebSocket"in t&&null!=t.WebSocket&&"CLOSING"in t.WebSocket.prototype},getWSAvailability:function(){var e="";return"WebSocket"in t&&null!==t.WebSocket?(e+="W","CLOSING"in t.WebSocket.prototype&&(e+="C"),e):"none"}};o.exports=s},34),__d("MqttProtocolCodec",["MqttProtocolUtils","MqttUtils","err"],function(t,e,n,r,i,o,s){function a(t,e){var i=e=e,o=t[e],s=o>>4;e+=1;var a,l=r("MqttProtocolUtils").decodeMultiByteInt(t,e);if(null==l)return{wireMessage:null,position:i};if((l=(e=l.offset)+l.value)>t.length)return{wireMessage:null,position:i};switch(s){case u.CONNACK:i=!!(1&(i=t[e++]));var g=t[e++];a=new d(i,g);break;case u.PUBLISH:g=(i=15&o)>>1&3,o=r("MqttProtocolUtils").readUInt16BE(t,e),e+=2;var m=r("MqttProtocolUtils").convertUTF8ToString(t,e,o);e+=o,o=null,1===g&&(o=r("MqttProtocolUtils").readUInt16BE(t,e),e+=2);var v=p.createWithBytes(t.subarray(e,l));a=new _(m,v,g,o,1==(1&i),i=8==(8&i));break;case u.PINGREQ:a=new c("PINGREQ");break;case u.PINGRESP:a=new c("PINGRESP");break;case u.PUBACK:case u.UNSUBACK:m=r("MqttProtocolUtils").readUInt16BE(t,e),a=new f(s===u.PUBACK?"PUBACK":"UNSUBACK",m);break;case u.SUBACK:v=r("MqttProtocolUtils").readUInt16BE(t,e),e+=2,g=t.subarray(e,l),a=new h(v,g);break;default:throw n("err")(r("MqttUtils").sprintf("Invalid MQTT message type %s.",s))}return{wireMessage:a,position:l}}function t(t){for(var e=[],n=0;n<t.length;){var r=a(t,n),i=r.wireMessage;if(n=r.position,!i)break;e.push(i)}return r=null,n<t.length&&(r=t.subarray(n)),{messages:e,remaining:r}}var u=Object.freeze({CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14}),l=[0,6,77,81,73,115,100,112,3],c=function(t){function e(e){return t.call(this,e)||this}return babelHelpers.inheritsLoose(e,t),e.prototype.encode=function(){var t=new ArrayBuffer(2);return new Uint8Array(t)[0]=(15&this.messageType)<<4,t},e}(e=function(){function t(t){this.messageType=u[t]}return t.prototype.encode=function(){throw new TypeError("Cannot abstract class WireMessage")},t}());i=function(t){function e(){return t.call(this,"DISCONNECT")||this}return babelHelpers.inheritsLoose(e,t),e.prototype.encode=function(){var t=(15&this.messageType)<<4,e=new ArrayBuffer(2),n=new Uint8Array(e);return n[0]=t,n.set(r("MqttProtocolUtils").encodeMultiByteInt(0),1),e},e}(e);var h=function(t){function e(e,n){var r;return(r=t.call(this,"SUBACK")||this).messageIdentifier=e,r.returnCode=n,r}return babelHelpers.inheritsLoose(e,t),e}(e),d=function(t){function e(e,n){var r;return(r=t.call(this,"CONNACK")||this).sessionPresent=e,r.returnCode=n,r}return babelHelpers.inheritsLoose(e,t),e}(e),f=function(t){function e(e,n){return(e=t.call(this,e)||this).messageIdentifier=n,e}return babelHelpers.inheritsLoose(e,t),e.prototype.encode=function(){var t=(15&this.messageType)<<4,e=2,n=r("MqttProtocolUtils").encodeMultiByteInt(e),i=n.length+1;e=new ArrayBuffer(e+i);var o=new Uint8Array(e);return o[0]=t,o.set(n,1),i=r("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,o,i),e},e}(e);o=function(t){function e(e,n){var r;return(r=t.call(this,"CONNECT")||this).clientId=e,r.connectOptions=n,r}return babelHelpers.inheritsLoose(e,t),e.prototype.encode=function(){var t=(15&this.messageType)<<4,e=l.length+3;e+=r("MqttProtocolUtils").UTF8Length(this.clientId)+2,e+=r("MqttProtocolUtils").UTF8Length(this.connectOptions.userName)+2;var n=r("MqttProtocolUtils").encodeMultiByteInt(e);e=new ArrayBuffer(1+n.length+e);var i=new Uint8Array(e);return i[0]=t,t=1,i.set(n,1),t+=n.length,i.set(l,t),t+=l.length,n=130,i[t++]=n,t=r("MqttProtocolUtils").writeUInt16BE(this.connectOptions.getKeepAliveIntervalSeconds(),i,t),t=r("MqttProtocolUtils").writeString(this.clientId,r("MqttProtocolUtils").UTF8Length(this.clientId),i,t),t=r("MqttProtocolUtils").writeString(this.connectOptions.userName,r("MqttProtocolUtils").UTF8Length(this.connectOptions.userName),i,t),e},e}(e);var g=function(t){function e(e,n,i,o){var s;if((s=t.call(this,e)||this).topic=n,i<0&&i>1||1===i&&null==o)throw new TypeError(r("MqttUtils").sprintf("Argument Invalid. qos: %s messageType: %s.",i,e));return s.qos=i,s.messageIdentifier=o,s}return babelHelpers.inheritsLoose(e,t),e.prototype.encode=function(){var t=(15&this.messageType)<<4;t|=2;var e=r("MqttProtocolUtils").UTF8Length(this.topic),n=2+e+2;this.messageType===u.SUBSCRIBE&&(n+=1);var i=r("MqttProtocolUtils").encodeMultiByteInt(n);n=new ArrayBuffer(1+i.length+n);var o=new Uint8Array(n);return o[0]=t,t=1,o.set(i,1),t+=i.length,null!=this.messageIdentifier&&(t=r("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,o,t)),t=r("MqttProtocolUtils").writeString(this.topic,e,o,t),this.messageType===u.SUBSCRIBE&&null!=this.qos&&(o[t++]=this.qos),n},e}(e),p=function(){function t(t,e){this.payloadString=t,this.payloadBytes=e}t.createWithString=function(e){var n=new Uint8Array(new ArrayBuffer(r("MqttProtocolUtils").UTF8Length(e)));return r("MqttProtocolUtils").convertStringToUTF8(e,n,0),new t(e,n)},t.createWithBytes=function(e){return new t(r("MqttProtocolUtils").convertUTF8ToString(e,0,e.length),e)};var e=t.prototype;return e.string=function(){return this.payloadString},e.bytes=function(){return this.payloadBytes},t}(),_=function(t){function e(e,n,r,i,o,s){var a;if((a=t.call(this,"PUBLISH")||this).topic=e,a.payloadMessage=n,a.qos=r,a.messageIdentifier=i,a.retained=null!=o&&o,a.duplicate=null!=s&&s,1===a.qos&&null==a.messageIdentifier)throw new TypeError("Argument Invalid. messageIdentifier: null and qos: 1");return a}return babelHelpers.inheritsLoose(e,t),e.prototype.encode=function(){var t=(15&this.messageType)<<4;this.duplicate&&(t|=8),t=t|=this.qos<<1,this.retained;var e=r("MqttProtocolUtils").UTF8Length(this.topic),n=e+2,i=0===this.qos?0:2;n+=i,n+=(i=this.payloadMessage.bytes()).byteLength;var o=r("MqttProtocolUtils").encodeMultiByteInt(n);n=new ArrayBuffer(1+o.length+n);var s=new Uint8Array(n);return s[0]=t,s.set(o,1),t=1+o.length,t=r("MqttProtocolUtils").writeString(this.topic,e,s,t),0!==this.qos&&null!=this.messageIdentifier&&(t=r("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,s,t)),s.set(i,t),n},e}(e),m=p.createWithString;e={Base:e,PubAckUnsubAck:f,Ping:c,ConnAck:d,Connect:o,Disconnect:i,Subscription:g,Publish:_},s.MESSAGE_TYPE=u,s.decodeMessage=a,s.decodeByteMessages=t,s.Message=p,s.createMessageWithString=m,s.WireMessage=e},98),__d("MqttTypes",[],function(t,e,n,r,i,o){"use strict";t=function(t,e,n){this.errorCode=t,this.errorName=e,this.errorMessage=n},e=Object.freeze({SOCKET_ERROR:new t(1,"SOCKET_ERROR","Socket error"),SOCKET_MESSAGE:new t(2,"SOCKET_MESSAGE","Unable to parse invalid socket message"),INVALID_DATA_TYPE:new t(3,"INVALID_DATA_TYPE","Received non-arraybuffer from socket."),CONNECT_TIMEOUT:new t(4,"CONNECT_TIMEOUT","Connect timed out"),CONNACK_FAILURE:new t(5,"CONNACK_FAILURE","Connection failure due to connack"),PING_TIMEOUT:new t(6,"PING_TIMEOUT","Ping timeout"),APP_DISCONNECT:new t(7,"APP_DISCONNECT","Disconnect initiated by app"),SERVER_DISCONNECT:new t(8,"SERVER_DISCONNECT","Disconnect message sent my server"),SOCKET_CLOSE:new t(9,"SOCKET_CLOSE","Socket connection closed"),RECONNECT:new t(10,"RECONNECT","Reconnecting"),BROWSER_CLOSE:new t(11,"BROWSER_CLOSE","Browser closed")}),n=function(t,e){this.mqttError=t,this.connAck=e},r=function(t){function e(e,n,r){return void 0===r&&(r=null),(n=t.call(this,n)||this).isRecoverable=e,n.originalError=r,n}return babelHelpers.inheritsLoose(e,t),e}(babelHelpers.wrapNativeSuper(Error)),o.MqttError=t,o.MqttErrors=e,o.ConnectFailure=n,o.MqttChannelError=r},66),__d("MqttProtocolClient",["MqttEnv","MqttProtocolCodec","MqttProtocolUtils","MqttTypes","err","qex"],function(t,e,n,r,i,o,s){"use strict";var a=30,u=6e4;t=function(){function t(t){var e=this;this.$12=function(t,n,i){void 0===n&&(n=null),e.$9.bumpCounter("protocol.debug.disconnect.internal."+t.errorName),e.$9.bumpCounter("protocol.debug.disconnect.internal");var o=e.$5,s=e.$2,a=s.onConnectionLost,u=s.onConnectFailure;e.setConnected(!1),e.$14(),o?r("MqttEnv").Env.scheduleCallback(function(){a(t,n)}):r("MqttEnv").Env.scheduleCallback(function(){u(e.$11,new(r("MqttTypes").ConnectFailure)(t,null!=i?i:-1),n)})},this.$13=function(t){var n=e.$6;if(null==n)return e.$9.bumpCounter("protocol.socket_send.failed.socket_null.<message type>"),0;if(n.readyState!==n.OPEN)return e.$9.bumpCounter("protocol.socket_send.failed.socket_not_open.<message type>"),0;var r=(t=t.encode()).byteLength;return n.send(t),r},this.$3=t,this.$2={userName:"",mqttVersion:3,getKeepAliveIntervalSeconds:function(){return 10},getKeepAliveTimeoutSeconds:function(){return 10},ignoreSubProtocol:!1,onConnectSuccess:function(){},onConnectFailure:function(){},onConnection:function(){},onConnectionLost:function(){},onMessageArrived:function(){},onMessageDelivered:function(){}},this.$1="mqttwsclient",this.$4=0,this.$5=!1,this.$9=r("MqttEnv").Env.getLoggerInstance(),this.$11=0}var e=t.prototype;return e.connect=function(t){var e,i=this;if(this.$5)throw n("err")("Invalid state: connect - already connected");this.$2=t,this.setConnected(!1),null!=this.$7&&(r("MqttEnv").Env.clearTimeout(this.$7),this.$7=null),e=null!=(e=n("qex")._("660"))?e:a,this.$7=r("MqttEnv").Env.setTimeout(function(){i.$9.bumpCounter("protocol.error.connect.timeout"),i.$12(r("MqttTypes").MqttErrors.CONNECT_TIMEOUT)},1e3*e),this.$6=r("MqttEnv").Env.createSocket(this.$3),this.$6.binaryType="arraybuffer",this.$6.onopen=function(){i.setConnected(!0),i.$9.debugTrace("Socket-Open","MQTTProtocolClient Socket Open"),i.$11=i.$13(new(r("MqttProtocolCodec").WireMessage.Connect)(i.$1,t)),t.onConnection()},this.$6.onmessage=function(t){if(!((t=t.data)instanceof ArrayBuffer))return i.$9.bumpCounter("protocol.error.onmessage.type"),void i.$12(r("MqttTypes").MqttErrors.INVALID_DATA_TYPE);try{t=new Uint8Array(t),null!=i.$10&&(t=r("MqttProtocolUtils").concatBuffers(i.$10,t),i.$9.bumpCounter("protocol.debug.usingMessagesBuffer"),delete i.$10,i.$10=null);var e=(t=r("MqttProtocolCodec").decodeByteMessages(t)).messages;for(i.$10=t.remaining,t=0;t<e.length;t++)i.handleMessage(e[t])}catch(t){i.$10=null,i.$9.logError(t,r("MqttTypes").MqttErrors.SOCKET_MESSAGE.errorMessage),i.$9.bumpCounter("protocol.error.onmessage.parse"),i.$12(r("MqttTypes").MqttErrors.SOCKET_MESSAGE,t.message)}},this.$6.onerror=function(){i.$9.bumpCounter("protocol.error.socket"),i.$9.debugTrace("Socket-Error","MQTTProtocolClient Socket Error"),i.$12(r("MqttTypes").MqttErrors.SOCKET_ERROR)},this.$6.onclose=function(t){i.$9.bumpCounter("protocol.socket.close"),t.wasClean||i.$9.debugTrace("Socket-Unclean-Close","MQTTProtocolClient error code: "+t.code+" reason: "+t.reason),i.$12(r("MqttTypes").MqttErrors.SOCKET_CLOSE,t.code+" : "+t.reason)},null!=this.$8&&this.$8.cancel(),this.$8=new(r("MqttProtocolUtils").Pinger)(t.getKeepAliveIntervalSeconds,t.getKeepAliveTimeoutSeconds,this.$13.bind(this,new(r("MqttProtocolCodec").WireMessage.Ping)("PINGREQ")),function(t,e){return i.$12(r("MqttTypes").MqttErrors.PING_TIMEOUT,t,e)})},e.$14=function(){var t=this;this.setConnected(!1),null!=this.$8&&this.$8.cancel(),null!=this.$7&&(r("MqttEnv").Env.clearTimeout(this.$7),this.$7=null),null!=this.$6&&(this.$6.onopen=function(){t.$9.debugTrace("Socket Open After Teardown","Socket opening after teardown")},this.$6.onmessage=function(){},this.$6.onerror=function(){},this.$6.onclose=function(e){t.$9.debugTrace("Socket Close After Teardown","code: "+e.code+", reason: "+e.reason)},this.$6.close(),this.$6=null),this.$2.onConnectSuccess=function(){},this.$2.onConnectFailure=function(){},this.$2.onConnection=function(){},this.$2.onConnectionLost=function(){},this.$2.onMessageArrived=function(){},this.$2.onMessageDelivered=function(){}},e.disconnect=function(t){null!=this.$6&&this.$6.readyState===this.$6.OPEN&&this.$5?(this.$13(new(r("MqttProtocolCodec").WireMessage.Disconnect)),this.$9.bumpCounter("protocol.debug.disconnect"),this.$12(t)):this.$14()},e.isConnected=function(){return this.$5},e.setConnected=function(t){this.$5=t},e.subscribe=function(t){if(!this.$5)throw this.$9.bumpCounter("protocol.error.subscribe.notconnected"),n("err")("Invalid state: subscribe - not connected");this.$9.bumpCounter("protocol.subscribe."+t),t=new(r("MqttProtocolCodec").WireMessage.Subscription)("SUBSCRIBE",t,0,this.$15()),this.$13(t)},e.unsubscribe=function(t){if(!this.$5)throw this.$9.bumpCounter("protocol.error.unsubscribe.notconnected"),n("err")("Invalid state: unsubscribe - not connected");this.$9.bumpCounter("protocol.unsubscribe."+t),t=new(r("MqttProtocolCodec").WireMessage.Subscription)("UNSUBSCRIBE",t,0,this.$15()),this.$13(t)},e.publish=function(t,e,n){this.$5||this.$9.bumpCounter("protocol.error.publish.notconnected"),this.$9.bumpCounter("protocol.publish."+t);var i=this.$15();return t=new(r("MqttProtocolCodec").WireMessage.Publish)(t,r("MqttProtocolCodec").createMessageWithString(e),n,i),this.$13(t),i},e.$15=function(){return++this.$4===u&&(this.$4=1),this.$4},e.handleMessage=function(t){var e=this;switch(t.messageType){case r("MqttProtocolCodec").MESSAGE_TYPE.CONNACK:if(null!=this.$7&&(r("MqttEnv").Env.clearTimeout(this.$7),this.$7=null),t instanceof r("MqttProtocolCodec").WireMessage.ConnAck){var i=t;if(0!==i.returnCode)return this.$9.bumpCounter("protocol.error.connack.invalidreturncode"),this.setConnected(!1),void this.$12(r("MqttTypes").MqttErrors.CONNACK_FAILURE,"connack code="+i.returnCode,i.returnCode);r("MqttEnv").Env.scheduleCallback(function(){e.$2.onConnectSuccess(e.$11)}),null!=this.$8&&this.$8.reset()}break;case r("MqttProtocolCodec").MESSAGE_TYPE.PUBLISH:if(t instanceof r("MqttProtocolCodec").WireMessage.Publish){var o=t;r("MqttEnv").Env.scheduleCallback(function(){e.$2.onMessageArrived(o.topic,o.payloadMessage,o.qos)}),i=o.messageIdentifier,this.$9.bumpCounter("protocol.publish.received"),1===o.qos&&null!=i&&(i=new(r("MqttProtocolCodec").WireMessage.PubAckUnsubAck)("PUBACK",i),this.$13(i))}break;case r("MqttProtocolCodec").MESSAGE_TYPE.PUBACK:if(t instanceof r("MqttProtocolCodec").WireMessage.PubAckUnsubAck){var s=(i=t).messageIdentifier;this.$9.bumpCounter("protocol.puback.received"),r("MqttEnv").Env.scheduleCallback(function(){e.$2.onMessageDelivered("",s)})}break;case r("MqttProtocolCodec").MESSAGE_TYPE.PINGRESP:null!=this.$8&&this.$8.reset();break;case r("MqttProtocolCodec").MESSAGE_TYPE.DISCONNECT:this.$12(r("MqttTypes").MqttErrors.SERVER_DISCONNECT);break;case r("MqttProtocolCodec").MESSAGE_TYPE.SUBACK:this.$9.bumpCounter("protocol.suback.received");break;case r("MqttProtocolCodec").MESSAGE_TYPE.UNSUBACK:this.$9.bumpCounter("protocol.unsuback.received");break;default:this.$9.logError(n("err")("MqttProtocolClient: Received unhandled message type: "+t.messageType),"Received unhandled message type"),this.$9.bumpCounter("protocol.error.handlemessage.unsupportedtype")}},t}(),s["default"]=t},98),__d("MqttPublishListener",[],function(t,e,n,r,i,o){"use strict";t=Object.freeze({NOT_CONNECTED:"NOT_CONNECTED",PUBLISH_ERROR:"PUBLISH_ERROR",QUEUED:"QUEUED",SENT:"SENT",ACKED:"ACKED",NOT_ACKED:"NOT_ACKED"}),o.MqttPublishEvent=t},66),__d("MqttUserName",["gkx"],function(t,e,n,r,i,o,s){"use strict";t=function(){function t(t,e,r,i,o,s,a,u,l,c,h){void 0===a&&(a=null),void 0===u&&(u=""),void 0===l&&(l="websocket"),void 0===c&&(c=null),void 0===h&&(h=null),this.$1=t,this.$2=e,this.$3=r,this.$4=i,this.$5=o,this.$6=s,this.$7=!n("gkx")("1166607")&&("object"==typeof document&&document&&document.hasFocus&&document.hasFocus()),this.$8=a,this.$9=u,this.$10=l,this.$11=c,this.$12=h}var e=t.prototype;return e.gen=function(t,e,r,i){void 0===i&&(i=[]);var o=!n("gkx")("1166607")&&this.$7;return t={u:this.$1,s:t,cp:this.$3,ecp:this.$2,chat_on:this.$6,fg:o,d:this.$4,ct:this.$10,mqtt_sid:"",aid:this.$5,st:e,pm:r,dc:"",no_auto_fg:!0,gas:this.$8,pack:i,php_override:this.$9,p:this.$11,a:navigator.userAgent,aids:null!=this.$12?Object.fromEntries(this.$12):null},JSON.stringify(t)},e.setForegroundState=function(t){this.$7=t},e.setChatVisibility=function(t){this.$6=t},e.getEndpointCapabilities=function(){return this.$2},e.getDeviceId=function(){return this.$4},e.setEndpointCapabilities=function(t){this.$2=t},e.getIsGuestAuthStringPresent=function(){return null!==this.$8},t}(),s["default"]=t},98),__d("MqttConnection",["MqttConnectionHookCollection","MqttEnv","MqttProtocolClient","MqttPublishListener","MqttTypes","MqttUserName","MqttUtils","Promise","err","qex"],function(t,e,n,r,i,o,s){"use strict";var a=10,u=1,l=1,c=64,h="publish",d="subscribe",f="unsubscribe",g=function(){},p=18e4,_=5e3,m=15,v=21;t=function(){function t(){var t=this;this.$37=function(){return t.$20},this.$38=function(){return t.$21},this.$8=!1,this.$10=r("MqttEnv").Env.getLoggerInstance(),this.$11="Disconnected",this.$17=new Set,this.$24=new Map,this.$12=0,this.$13=0,this.$14=0,this.$15=0,this.$16=0,this.$8=!1,this.$5="",this.$6=new(n("MqttUserName"))("",0,1,"",0,!0),this.$9=0,this.$18=0,this.$19=!1,this.$7=null;var e=function(){};this.$1=e,this.$2=e,this.$3=e,this.$25=!1,this.$26=!1,this.$27=new(n("MqttConnectionHookCollection")),this.$4=function(){return[]},this.$20=a,this.$21=a,this.$22=null,this.$23=0}var i=t.prototype;return i.run=function(t){var e=this,r=t.onStateChange,i=t.onJSError,o=t.onMessageReceived,s=t.endpoint,u=t.mqttUserName,l=t.subscribedTopics;t=t.extraConnectMessageProvider,this.$8?this.$10.debugTrace("run","Run called while in running state."):(this.$1=r,this.$3=o,this.$5=s,this.$6=u,this.$8=!0,this.$18=Date.now(),this.$12=0,this.$13=0,this.$2=i||g,l&&l.forEach(function(t){return e.$17.add(t)}),this.$4=t,this.$20=null!=(r=n("qex")._("656"))?r:a,this.$21=null!=(o=n("qex")._("657"))?o:a,this.$28())},i.shutdown=function(t){this.$29(t),this.$30("shutdown"),this.$8=!1,this.$10.debugTrace("shutdown","Shutdown")},i.subscribe=function(t){return this.$17.add(t),this.ensureConnected(d)&&this.$31(t),!0},i.publish=function(t,i,o,s){var a={resolve:function(){},reject:function(){}};null!=s&&(a.listener=s);var u=new(e("Promise"))(function(t,e){a.resolve=t,a.reject=e});return this.ensureConnected(h)?this.$32(t,i,o,a):(null==s||s.onEvent(r("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED),a.reject(n("err")("Client disconnected"))),u},i.unsubscribe=function(t){return this.$17["delete"](t),this.ensureConnected(f)&&this.$33(t),!0},i.addHook=function(t){this.$27.addHook(t)},i.removeHook=function(t){this.$27.removeHook(t)},i.isRunning=function(){return this.$8},i.getSessionId=function(){return this.$9},i.hasFatal=function(){return this.$25},i.hasConnectSuccess=function(){return this.$26},i.canPublish=function(){return this.ensureConnected("canPublish")},i.ensureConnected=function(){return!(!this.$8||null==this.$7||!this.$7.isConnected())},i.connectionState=function(){return this.$11},i.mqttStateFromConnectionState=function(t){switch(t){case"Connecting":case"TransportConnected":return"Connecting";case"Connected":return"Connected";case"Disconnected":return"Disconnected"}throw n("err")("Unknown state "+t)},i.testOnlyGetSubscribedTopics=function(){return this.$17},i.onWindowUnload=function(){var t=this;this.publish("/browser_close","{}",0)["catch"](function(){t.$10.bumpCounter("on_window_unload.browser_close_publish_failed")})},i.getDisconnectCount=function(){return this.$23},i.$29=function(t){this.$8&&null!=this.$7&&(this.$34("Disconnected"),null!=this.$7&&(this.$7.disconnect(t),this.$27.onConnectionDisconnect()),this.$7=null)},i.$35=function(t){if("Connected"!==this.$11||"Disconnected"!==t||0!==this.$18){if("Connecting"===t&&0!==this.$18&&!this.$19)return this.$10.bumpCounter("protocol.reconnectstarted"),void(this.$19=!0);if("Connected"===t&&0!==this.$18){switch(t=Date.now()-this.$18,Math.floor(t/3e4)){case 0:this.$10.bumpCounter("protocol.reconnectedwithin30s");break;case 1:this.$10.bumpCounter("protocol.reconnectedwithin60s");break;case 2:this.$10.bumpCounter("protocol.reconnectedwithin90s");break;case 3:this.$10.bumpCounter("protocol.reconnectedwithin120s");break;default:this.$10.bumpCounter("protocol.reconnectedmorethan120s")}return this.$18=0,void(this.$19=!1)}}else this.$18=Date.now()},i.$34=function(t){t!==this.$11&&(this.$10.debugTrace("MQTTConnection-updateState","State changed to: "+t),this.$35(t),this.$11=t,this.$1(t))},i.$28=function(){var t=this;if(this.$8){"Disconnected"!==this.$11&&this.$10.debugTrace("Reconnect","Current State not disconnected: "+this.$11),this.$34("Connecting");var e=Date.now(),i=this.$10.getBrowserConnectivity();this.$9=n("MqttUtils").generateSessionId();var o=Array.from(this.$17),s=n("MqttUtils").endpointWithSessionId(this.$5,this.$9);s=n("MqttUtils").endpointWithExtraParameter(s,"cid",this.$6.getDeviceId());try{this.$7=new(n("MqttProtocolClient"))(s);var a=this.$36(),u=a.map(function(t){return t.topic});s=this.$6.gen(this.$9,o,a),null!=this.$7&&(this.$13+=1,this.$7.connect({userName:s,mqttVersion:3,getKeepAliveIntervalSeconds:this.$37,getKeepAliveTimeoutSeconds:this.$38,ignoreSubProtocol:!0,onConnectFailure:function(n,r,s){return t.$39(r,e,t.$18,o,u,i,n,s)},onConnectSuccess:function(n){return t.$40(e,t.$18,o,u,i,n)},onConnection:function(){return t.$41(a,o)},onConnectionLost:function(e,n){return t.$42(e,n)},onMessageArrived:function(e,n,r){return t.$43(e,n,r)},onMessageDelivered:function(e,n){return t.$44(e,n)}}),this.$10.bumpCounter("protocol.connectattempt"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.connectattempt"),this.$27.onConnectAttempt())}catch(t){this.$10.bumpCounter("js_error_in_init_exception"),this.$34("Disconnected"),this.$45(!1,!1,e,this.$18,o,[],i,null,14,"init error - "+t.message),t&&this.$10.logErrorWarn(t,"ws_js_error"),this.$27.onWSFatal(),this.$46(new(r("MqttTypes").MqttChannelError)(!1,"ws_js_error",t),"client_init")}}},i.$36=function(){var t=this.$4(),e=65536;return t.map(function(t){return t.messageId=e--,t})},i.$31=function(t){try{if(null!=this.$7)return this.$7.subscribe(t),this.$10.debugTrace("_doSubscribe","Subscribing to "+t),this.$27.onSubscribe(t),this.$10.bumpCounter("protocol.subscribe"),!0}catch(e){this.$10.logError(e,"Exception subscribing"),this.$10.bumpCounter("subscribe_exception."+t),this.$10.bumpCounter("protocol.subscribe.error")}return!1},i.$33=function(t){try{if(null!=this.$7)return this.$7.unsubscribe(t),this.$10.debugTrace("_doUnsubscribe","Unsubscribing to "+t),this.$27.onUnsubscribe(t),this.$10.bumpCounter("protocol.unsubscribe"),!0}catch(e){this.$10.logError(e,"Exception unsubscribing"),this.$10.bumpCounter("unsubscribe_exception."+t),this.$10.bumpCounter("protocol.unsubscribe.error")}return!1},i.$32=function(t,e,n,i){if(null==this.$7)return!1;try{e=this.$7.publish(t,e,n),this.$10.bumpCounter("protocol.publish");var o=null!=e?e:"null";return this.$10.debugTrace("_doPublish","publish "+t+" with messageId:"+o+" qos:"+n),this.$27.onPublish(t),
null==(o=i.listener)||o.onEvent(r("MqttPublishListener").MqttPublishEvent.SENT),null!=e?(this.$10.bumpCounter("publish.ack_expected"),this.$24.set(e,i)):i.resolve(),!0}catch(e){return this.$10.logError(e,"Exception publishing"),this.$10.bumpCounter("publish_exception."+t),i.reject(e),this.$10.bumpCounter("protocol.publish.error"),!1}},i.$47=function(t){var e=this;if(void 0===t&&(t=null),this.$8){var i;if(this.$29(r("MqttTypes").MqttErrors.RECONNECT),this.$30("reconnect"),this.$48(),this.$9=-1,this.$16=0,null==(t=t))t=(i=null!=(i=n("qex")._("130"))?i:u)*Math.pow(2,this.$12);t=Math.max(t,l),i=null!=(i=n("qex")._("131"))?i:c,i=(t=Math.min(t,i))*(1e3+200*r("MqttEnv").Env.random()),this.$10.debugTrace("_scheduleReconnect","Reconnect in "+i+" ms"),this.$22=r("MqttEnv").Env.setTimeout(function(){e.$28()},i),this.$12+=1}},i.$48=function(){var t=Date.now()-this.$16,e=0!==this.$16&&t>_,n=this.$12>m;(e||n)&&(this.$12=0),0!==this.$16&&t<=_&&this.$10.bumpCounter("short_lived_session"),n&&this.$10.bumpCounter("connection_attempt_limit")},i.$45=function(t,e,n,r,i,o,s,a,u,l){t?this.$14++:this.$15++;var c=Date.now();this.$10.eventLogConnect({sessionID:this.$9,connectionStatus:t,connectionState:this.mqttStateFromConnectionState(this.$11),ackReceived:e,duration:c-n,total_duration:c-r,hostname:this.$5,attemptNumber:this.$13,successTotal:this.$14,failTotal:this.$15,subscribedTopics:i,publishes:o,errorCode:u,errorMessage:l,osConnectivity:s,messageSizeBytes:a,disconnectCount:this.$23}),t&&(this.$13=0)},i.$39=function(t,e,n,r,i,o,s,a){var u=t.mqttError;a=null!=a?u.errorMessage+" - "+a:u.errorMessage,this.$10.debugTrace("connect","Connect failed "+a),this.$10.bumpCounter("protocol.onconnectfailure"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectfailure"),this.$27.onConnectFailure(),this.$45(!1,-1!==t.connAck,e,n,r,i,o,s,u.errorCode,a),null==t.connAck||(this.$10.bumpCounter("protocol.connect_failure."+t.connAck),t.connAck!==v)?this.$47():this.$47(p)},i.$41=function(t,e){var n=this;this.$10.bumpCounter("protocol.onconnection"),this.$10.debugTrace("Connect","Socket established"),this.$27.onConnected(),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnection"),e.forEach(function(t){n.$27.onSubscribe(t)}),t.forEach(function(t){n.$27.onPublish(t.topic)}),this.$34("TransportConnected")},i.$40=function(t,e,n,r,i,o){this.$10.bumpCounter("protocol.onconnectsuccess"),this.$10.debugTrace("connect","Connect success"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectsucess"),this.$27.onConnectSuccess(),this.$26=!0,this.$34("Connected"),this.$45(!0,!0,t,e,n,r,i,o),this.$49(n),this.$16=Date.now()},i.$42=function(t,e){this.$10.bumpCounter("protocol.onconnectionlost"),this.$23++,t.errorCode&&(e=null!=e?t.errorMessage+" - "+e:t.errorMessage,this.$10.eventLogDisconnect({sessionID:this.$9,errorCode:t.errorCode,errorMessage:e,duration:Date.now()-this.$16,disconnectCount:this.$23})),this.$10.debugTrace("connect","connection lost"),this.$27.onConnectionLost(),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectionlost"),this.$47()},i.$43=function(t,e,n){this.$10.bumpCounter("protocol.onmessagearrived"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onmessagearrived"),this.$10.debugTrace("onMessageArrived","Message received on "+t),this.$27.onMessage(t);try{this.$3(t,e,n)}catch(e){this.$10.logError(e,"Listener threw error"),this.$10.bumpCounter("listener_error."+t)}},i.$44=function(t,e){this.$10.bumpCounter("protocol.onmessagedelivered"),t=null!=e?e:"null",this.$10.debugTrace("onMessageDelivered","Delivered Message {ID: "+t+"}"),null!=e&&(null!=(t=this.$24.get(e))?(this.$24["delete"](e),null==(e=t.listener)||e.onEvent(r("MqttPublishListener").MqttPublishEvent.ACKED),t.resolve(),this.$10.bumpCounter("publish.ack_received")):this.$10.bumpCounter("protocol.message_with_unknown_id"))},i.$30=function(t){this.$10.bumpCounter("protocol.fail_all_unacked_publishes."+t),this.$24.forEach(function(e,i){null==(i=e.listener)||i.onEvent(r("MqttPublishListener").MqttPublishEvent.NOT_ACKED),e.reject(n("err")(t))}),this.$24.clear()},i.$49=function(t){var e=this,n=new Set(t);n.forEach(function(t){e.$17.has(t)||e.unsubscribe(t)}),(t=new Set(this.$17)).forEach(function(t){n.has(t)||e.subscribe(t)})},i.$46=function(t,e){try{this.$10.bumpCounter("js_error_in_init"),this.$10.bumpCounter(e+".error"),this.$25=!0;var n=t?t.message:"error";this.$10.debugTrace("onError",e+": "+n),this.$2(t)}catch(t){this.$10.bumpCounter("js_error_in_error_logging"),this.$10.logError(t,"JS error while trying to log previous error")}},t}(),s["default"]=t},98),__d("isFastRefreshEnabledForCurrentDomain",[],function(t,e,n,r,i,o){"use strict";function t(){return!1}o["default"]=t},66),__d("MqttChannel",["ChannelClientID","IrisSubscribeChecker","MqttAnalyticsHook","MqttConnection","MqttEnv","MqttPublishListener","MqttPublishTimeoutConfig","MqttTypes","MqttUserName","MqttUtils","Promise","Run","err","isFastRefreshEnabledForCurrentDomain","promiseDone","qex","requireDeferred"],function(t,e,n,r,i,o){"use strict";var s=n("MqttPublishTimeoutConfig").mqttPublishTimeoutMs||6e4;t=function(){function t(t){var e=this,i=t.endpoint,o=t.pollingEndpoint,s=t.userFbid,a=t.appId,u=t.initialSubscribedTopics,l=t.capabilities,c=t.clientCapabilities,h=t.chatVisibility;h=void 0===h||h;var d=t.guestAuthString;d=void 0===d?null:d;var f=t.phpOverride;f=void 0===f?"":f;var g=t.clientType;g=void 0===g?"websocket":g;var p=t.deviceId;p=void 0===p?n("ChannelClientID").getID():p;var _=t.pageId;_=void 0===_?null:_,t=void 0===(t=t.assetIds)?null:t,this.$11=r("MqttEnv").Env.getLoggerInstance(),this.$11.setAppId(a),this.$12=new(n("MqttUserName"))(s,l,c,p,a,h,d,f,g,_,t),this.$1=i,this.$2=o,this.$5="Disconnected",this.$7="LPInactive",this.$6="Disconnected",this.$3=[],this.$4=new Set,this.$8=new Map,this.$9=new Map,this.$10=new(n("MqttConnection")),this.$13=null,this.$16=new(n("MqttAnalyticsHook")),this.$15=new Map,this.$14=[],r("MqttEnv").Env.isUserLoggedInNow()||n("isFastRefreshEnabledForCurrentDomain")()||null!=d&&""!=d?(this.$10.addHook(this.$16),this.$10.addHook(new(n("IrisSubscribeChecker"))(function(){return e.$4.size>0})),this.$17(u),this.$18()):this.$11.bumpCounter("logged_out_init")}var i=t.prototype;return i.$17=function(t){var e=this;if(this.$10.isRunning())this.$19("run","Connection started calling run again");else{if(r("MqttEnv").Env.genGk(r("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)){if(r("MqttEnv").Env.killswitch("MQTT_WS_FORCE_LONG_POLLING"))return void this.$19("MqttChannel","Websocket disabled, will do long polling only");if(!n("MqttUtils").hasWSSupport())return this.$19("MqttChannel","Websocket Unavailable, will do long polling only"),void this.$11.bumpCounter("ws_unavailable_polling")}this.$10.run({onStateChange:function(t){e.$20(t)},onJSError:function(t){e.$21(t)},onMessageReceived:function(t,n,r){e.$22(t,n,r)},endpoint:this.$1,mqttUserName:this.$12,subscribedTopics:t,extraConnectMessageProvider:function(){return e.$23()}}),this.$24()}},i.$24=function(){var t=this;r("Run").onUnload(function(){t.$10.onWindowUnload(),t.$25(r("MqttTypes").MqttErrors.BROWSER_CLOSE)})},i.shutdown=function(){this.$25(r("MqttTypes").MqttErrors.APP_DISCONNECT)},i.$25=function(t){this.$10&&this.$10.shutdown(t),this.$13&&this.$13.shutdown(),this.$16.onTabClose()},i.publish=function(t,e,i){var o;return void 0===i&&(i={qos:1,skipBuffer:!1}),o=0===i.qos?this.$26(t,e,i.listener):this.$27(t,e,i),n("MqttUtils").promiseDone(o,function(){},function(t){null==(t=i.listener)||t.onEvent(r("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR)}),o},i.$26=function(t,e,n){return this.$28(t,e,0,n,1,null)},i.$27=function(t,n,i){var o={resolve:function(){},reject:function(){}},s=new(e("Promise"))(function(t,e){o.resolve=t,o.reject=e}),a=r("MqttEnv").Env.random();return t={topic:t,payload:n,options:i,ack:o,publishToken:a,timeoutId:null,attempt:0,startTime:Date.now()},i.skipBuffer?"Connecting"===this.$10.connectionState()?(this.$14.push(t),null==(n=i.listener)||n.onEvent(r("MqttPublishListener").MqttPublishEvent.QUEUED)):this.$29(t):(t.timeoutId=this.$30(a),this.$15.set(a,t),null==(n=i.listener)||n.onEvent(r("MqttPublishListener").MqttPublishEvent.QUEUED),this.$31(t)),s},i.$29=function(t){t.attempt+=1,n("MqttUtils").promiseDone(this.$28(t.topic,t.payload,t.options.qos,t.options.listener,t.attempt,t.startTime),function(){t.ack.resolve()},function(e){t.ack.reject(e)})},i.$31=function(t){var e=this;t.attempt+=1,n("MqttUtils").promiseDone(this.$28(t.topic,t.payload,t.options.qos,t.options.listener,t.attempt,t.startTime),function(){return e.$32(t)},function(){})},i.$28=function(t,e,i,o,s,a){var u,l,c=this,h=this.getConnectionState(),d=Date.now();return!this.$10.canPublish()&&this.$13&&this.$13.canPublish()?(u=this.$13.publish(t,e,i),l="lp",null!=o&&(u=u.then(function(){return o.onEvent(r("MqttPublishListener").MqttPublishEvent.SENT)})),this.$11.bumpCounter("try_publish_lp")):(u=this.$10.publish(t,e,i,o),l="ws",this.$11.bumpCounter("try_publish_ws")),n("promiseDone")(u,function(){c.$11.eventLogOutgoingPublish({sessionID:c.$10.getSessionId(),topic:t,qos:i,payloadSizeBytes:2*e.length,success:!0,protocol:l,errorMessage:null,connectionState:h,thisAttemptStartTime:d,firstAttemptStartTime:a,attempt:s,disconnectCount:c.$10.getDisconnectCount()})},function(n){c.$11.eventLogOutgoingPublish({sessionID:c.$10.getSessionId(),topic:t,qos:i,payloadSizeBytes:2*e.length,success:!1,protocol:l,errorMessage:null!=n?n.toString():null,connectionState:h,thisAttemptStartTime:d,firstAttemptStartTime:a,attempt:s,disconnectCount:c.$10.getDisconnectCount()})}),u},i.subscribe=function(t,e){var n=this;this.$10.subscribe(t);var r=this.$8.get(t);return r?r.push(e):(r=[e],this.$8.set(t,r)),function(){var r=n.$8.get(t)||[];r=r.filter(function(t){return t!==e}),n.$8.set(t,r),0===r.length&&n.unsubscribeAll(t)}},i.subscribeBinary=function(t,e){var n=this;this.$10.subscribe(t);var r=this.$9.get(t);return r?r.push(e):(r=[e],this.$9.set(t,r)),function(){var r=n.$9.get(t)||[];r=r.filter(function(t){return t!==e}),n.$9.set(t,r),0===r.length&&n.unsubscribeAll(t)}},i.subscribeChannelEvents=function(t){this.$3.push(t)},i.unsubscribeChannelEvents=function(t){(t=this.$3.indexOf(t))>-1&&this.$3.splice(t,1)},i.registerExtraConnectPayloadProvider=function(t){var e=this;this.$19("MqttChannel","registerExtraConnectPayloadProvider called"),this.$4.add(t),this.$10.isRunning()&&(t=t.getPublishMessages()).forEach(function(t){e.publish(t.topic,t.payload,{qos:t.qos,skipBuffer:!0})})},i.unregisterExtraConnectPayloadProvider=function(t){this.$4["delete"](t)},i.unsubscribeAll=function(t){this.$10.unsubscribe(t),this.$8["delete"](t),this.$9["delete"](t)},i.getConnectionState=function(){return this.$5},i.getLongPollingStatus=function(){return this.$7},i.getEndpoint=function(){return this.$1},i.addHook=function(t){this.$10.addHook(t)},i.removeHook=function(t){this.$10.removeHook(t)},i.testOnlyMessageReceived=function(t,e){this.$22(t,e,-1)},i.$33=function(t){var e=this.$15.get(t);null!=e&&null!=e.timeoutId&&r("MqttEnv").Env.clearTimeout(e.timeoutId),this.$15["delete"](t)},i.$30=function(t){var e,i=this;return e=null!=(e=n("qex")._("37"))?e:s,r("MqttEnv").Env.setTimeout(function(t){var e=i.$15.get(t);if(e){var r=e.topic;i.$11.bumpCounter("publish_timeout."+r),i.$11.debugTrace("publish_timeout","Timeout publishing topic: "+r+" publishToken: "+t),i.$33(t),e.ack.reject(n("err")("Publish Timed Out"))}},e,t)},i.$32=function(t){var e=t.publishToken;this.$15.get(e)&&(this.$33(e),t.ack.resolve(),this.$11.debugTrace("publish_success","Topic: "+t.topic+" publishToken: "+t.publishToken),this.$11.bumpCounter("publish_success."+t.topic))},i.$22=function(t,e,n){var r=this.$8.get(t);if(this.$11.eventLogIncomingPublish({sessionID:this.$10.getSessionId(),topic:t,connectionState:this.getConnectionState(),qos:n,payloadSizeBytes:2*e.payloadString.length,disconnectCount:this.$10.getDisconnectCount()}),r){r=r;var i=Array.isArray(r),o=0;for(r=i?r:r["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var s;if(i){if(o>=r.length)break;s=r[o++]}else{if((o=r.next()).done)break;s=o.value}s=s;try{s(e.payloadString)}catch(t){this.$11.logError(t,"Listener exception"),this.$11.bumpCounter("listener_error")}}}else this.$11.debugTrace("_onMessageReceived",t+" being dropped, no listeners");if(s=this.$9.get(t),this.$11.eventLogIncomingPublish({sessionID:this.$10.getSessionId(),topic:t,connectionState:this.getConnectionState(),qos:n,payloadSizeBytes:e.payloadBytes.length,disconnectCount:this.$10.getDisconnectCount()}),s)for(o=s,r=0,o=(i=Array.isArray(o))?o:o["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){if(i){if(r>=o.length)break;n=o[r++]}else{if((r=o.next()).done)break;n=r.value}t=n;try{t(e.payloadBytes)}catch(t){this.$11.logError(t,"Binary Listener exception"),this.$11.bumpCounter("listener_error")}}else this.$11.debugTrace("_onMessageReceived",t+" being dropped, no binary listeners")},i.$21=function(t){r("MqttEnv").Env.genGk(r("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)?t.isRecoverable?this.$11.bumpCounter("recoverable_error_skipped"):this.$11.bumpCounter("unrecoverable_error_skipped"):(t.isRecoverable?this.$11.bumpCounter("recoverable_error_not_skipped"):this.$11.bumpCounter("unrecoverable_error_not_skipped"),this.$34(t))},i.$35=function(t){this.$34(t)},i.$34=function(t){var e=this.$3,n=Array.isArray(e),r=0;for(e=n?e:e["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var i;if(n){if(r>=e.length)break;i=e[r++]}else{if((r=e.next()).done)break;i=r.value}(i=i).onJSError&&i.onJSError(t)}},i.$36=function(){var t=this;this.$14.forEach(function(e){t.$29(e),t.$11.bumpCounter("publish_from_temp_buffer."+e.topic)}),this.$14=[],this.$15.forEach(function(e){t.$31(e),t.$11.bumpCounter("publish_from_buffer."+e.topic)})},i.$20=function(t){"Connecting"===t?(this.$14.forEach(function(t){t.ack.reject(n("err")("Client Reconnecting - "+t.topic))}),this.$14=[]):"TransportConnected"===t&&this.$36(),this.$19("_changeState","Connection state = "+t),this.$37(t,this.$7)},i.$38=function(t,e){this.$13&&this.$13.canPublish()&&this.$36(),this.$19("_changeLPStatus","LP status = "+t+", LP Request status = "+e),this.$37(this.$6,t)},i.$37=function(t,e){var n=this.$10.mqttStateFromConnectionState(t);this.$13&&this.$13.canPublish()&&(n="Connected"),this.$6=t,(n!==this.$5||e!=this.$7)&&(this.$5=n,this.$7=e,this.$39(n))},i.$39=function(t){var e=this.$3,n=Array.isArray(e),r=0;for(e=n?e:e["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var i;if(n){if(r>=e.length)break;i=e[r++]}else{if((r=e.next()).done)break;i=r.value}(i=i).onMQTTStateChanged(t)}},i.$23=function(){var t=this,e=[];return this.$4.forEach(function(n){try{n=n.getPublishMessages(),Array.prototype.push.apply(e,n)}catch(e){t.$11.logError(e,"ConnectPayload provider exception"),t.$11.bumpCounter("connectPayloadProvider_error")}}),e},i.$18=function(){var t=this;r("MqttEnv").Env.genGk(r("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)&&this.$2&&""!=this.$2&&n("requireDeferred")("MqttLongPollingRunner").__setRef("MqttChannel").onReady(function(e){(e=new e(t.$2,t.$12,t.$10.hasFatal(),t.$10.hasConnectSuccess(),function(e,n,r){return t.$22(e,n,r)},function(){var e=Array.from(t.$8.keys()),n=Array.from(t.$9.keys());return Array.from(new Set(e.concat(n)))},function(){return t.$23()},function(e){t.$35(e)},function(e,n){t.$38(e,n)})).start(),t.$10.addHook(e),e.addHook(t.$16),t.$13=e,t.$11.debugTrace("MqttChannel","longPollingRunner loaded")})},i.$19=function(t,e){this.$11.debugTrace(t,"Mqtt channel: "+e)},i.setForegroundState=function(t){this.$12&&this.$12.setForegroundState(t)},i.setChatVisibility=function(t){this.$12&&this.$12.setChatVisibility(t)},i.getEndpointCapabilities=function(){return this.$12.getEndpointCapabilities()},i.setEndpointCapabilities=function(t){this.$12.setEndpointCapabilities(t)},t}(),o.exports=t},34),__d("MqttUnifiedClientConnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(t,e,n,r,i,o,s){"use strict";t=n("getFalcoLogPolicy_DO_NOT_USE")("1744057"),i=r("FalcoLoggerInternal").create("mqtt_unified_client_connect",t),s["default"]=i},98),__d("MqttUnifiedClientDisconnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(t,e,n,r,i,o,s){"use strict";t=n("getFalcoLogPolicy_DO_NOT_USE")("1744058"),i=r("FalcoLoggerInternal").create("mqtt_unified_client_disconnect",t),s["default"]=i},98),__d("MqttUnifiedClientIncomingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(t,e,n,r,i,o,s){"use strict";t=n("getFalcoLogPolicy_DO_NOT_USE")("1744059"),i=r("FalcoLoggerInternal").create("mqtt_unified_client_incoming_publish",t),s["default"]=i},98),__d("MqttUnifiedClientOutgoingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(t,e,n,r,i,o,s){"use strict";t=n("getFalcoLogPolicy_DO_NOT_USE")("1744060"),i=r("FalcoLoggerInternal").create("mqtt_unified_client_outgoing_publish",t),s["default"]=i},98),__d("MqttWsClientTypedLoggerLite",["generateLiteTypedLogger"],function(t,e,n,r,i){"use strict";i.exports=e("generateLiteTypedLogger")("logger:MqttWsClientLoggerConfig")},null),__d("MqttLogger",["ChannelClientID","FBLogger","Log","LogHistory","MqttEnv","MqttGlobalStreamCounter","MqttUnifiedClientConnectFalcoEvent","MqttUnifiedClientDisconnectFalcoEvent","MqttUnifiedClientIncomingPublishFalcoEvent","MqttUnifiedClientOutgoingPublishFalcoEvent","MqttWsClientTypedLoggerLite","NetworkStatus","ODS","Random","gkx"],function(t,e,n,r,i,o,s){"use strict";var a="mqtt_client",u=100,l="WEBSOCKET",c="undefined"!=typeof window?window:self,h=null,d={CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish",CLIENT_ERROR:"mqtt_client_error",PUBLISH_TIMEOUT:"mqtt_qos1_publish_timeout",SOCKET_DISCONNECT:"mqtt_protocol_error"},f={CONNECT:"connect",DISCONNECT:"disconnect",OUTGOING_PUBLISH:"outgoing_publish",INCOMING_PUBLISH:"incoming_publish"};t=function(){function t(){this.$1=r("LogHistory").getInstance(a),this.$2=0,this.$3=n("gkx")("778292"),this.$4=Date.now(),this.$5=n("ChannelClientID").getID(),this.$7(),this.$6=r("MqttGlobalStreamCounter").getInstance(),this.$6.isEnabled()||(this.$6=null)}t.getInstance=function(){return h||(h=new t),h};var e=t.prototype;return e.setAppId=function(t){0===this.$2&&(this.$2=t)},e.eventLogConnect=function(t){var e=t.sessionID,r=t.connectionStatus,i=t.connectionState,o=t.ackReceived,s=t.duration,a=t.total_duration,u=t.hostname,c=t.attemptNumber,h=t.successTotal,g=t.failTotal;t.subscribedTopics,t.publishes;var p=t.osConnectivity;t.errorCode;var _=t.errorMessage,m=t.messageSizeBytes;t=t.disconnectCount,r=r?"success":"failed",this.bumpCounter(d.CONNECT+"."+r),r=h/(h+g),h=p&&this.getBrowserConnectivity();var v={event_type:f.CONNECT,acked:o,attempt_number:c.toString(),connection_state:i,client_type:l,duration:s.toString(),total_duration:a.toString(),error:_,session_id:e.toString(),os_connectivity:h,payload_size:null==m?void 0:m.toString(),extra_data:{device_id:this.$5,connect_success_rate:r.toString(),hostname:u},ws_count:null==(g=this.$6)?void 0:g.getGlobalState().totalConnectionStreams.toString(),disconnect_count:t.toString()};this.$8(function(){n("MqttUnifiedClientConnectFalcoEvent").log(function(){return v})})},e.eventLogPull=function(t){var e=t.pullEventName,n=t.sessionID,i=t.status,o=t.duration,s=t.hostname;t=t.errorMessage,n={device_id:this.$5,session_id:n,logged_in:r("MqttEnv").Env.isUserLoggedInNow(),href:c.location.hostname,connection_status:i,duration:o,hostname:s,error_message:t},this.$9(e,n)},e.eventLogPullFinish=function(t){var e=t.pullEventName,n=t.sessionID,i=t.duration,o=t.errorMessage,s=t.publishReceived;t=t.publishSent,n={device_id:this.$5,session_id:n,logged_in:r("MqttEnv").Env.isUserLoggedInNow(),href:c.location.hostname,duration:i,error_message:o,publish_received:s,publish_sent:t},this.$9(e,n)},e.eventLogDisconnect=function(t){var e=t.sessionID;t.errorCode;var r=t.errorMessage,i=t.duration;t=t.disconnectCount,this.bumpCounter(d.DISCONNECT);var o={event_type:f.DISCONNECT,connection_state:"Disconnected",client_type:l,duration:i.toString(),error:r,session_id:e.toString(),os_connectivity:this.getBrowserConnectivity(),extra_data:{device_id:this.$5},ws_count:null==(i=this.$6)?void 0:i.getGlobalState().totalConnectionStreams.toString(),disconnect_count:t.toString()};this.$8(function(){n("MqttUnifiedClientDisconnectFalcoEvent").log(function(){return o})})},e.eventLogOutgoingPublish=function(t){var e=t.sessionID,r=t.topic,i=t.qos,o=t.payloadSizeBytes,s=t.success,a=t.protocol,u=t.errorMessage,c=t.connectionState,h=t.thisAttemptStartTime,g=t.firstAttemptStartTime,p=t.attempt;t=t.disconnectCount,this.bumpCounter(d.PUBLISH+"."+r);var _=Date.now(),m={event_type:f.OUTGOING_PUBLISH,session_id:e.toString(),topic:r,client_type:l,connection_state:c,qos:i.toString(),acked:1===i?s:null,duration:(_-h).toString(),total_duration:null!=g?(_-g).toString():null,error:u,payload_size:o.toString(),attempt_number:p.toString(),os_connectivity:this.getBrowserConnectivity(),extra_data:{device_id:this.$5,protocol:a},disconnect_count:t.toString()};this.$8(function(){n("MqttUnifiedClientOutgoingPublishFalcoEvent").log(function(){return m})})},e.eventLogIncomingPublish=function(t){var e=t.sessionID,r=t.topic,i=t.connectionState,o=t.qos,s=t.payloadSizeBytes;t=t.disconnectCount;var a={event_type:f.INCOMING_PUBLISH,session_id:e.toString(),topic:r,client_type:l,connection_state:i,qos:o.toString(),payload_size:s.toString(),os_connectivity:this.getBrowserConnectivity(),extra_data:{device_id:this.$5},disconnect_count:t.toString()};e="/webrtc"==r||"/rtc_multi"==r,this.$10(function(){n("MqttUnifiedClientIncomingPublishFalcoEvent").log(function(){return a})},50,e)},e.logError=function(t,e){r("MqttEnv").Env.scheduleLoggingCallback(function(){try{n("FBLogger")(a).catching(t).mustfix(e)}catch(t){}})},e.logErrorWarn=function(t,e){r("MqttEnv").Env.scheduleLoggingCallback(function(){try{n("FBLogger")(a).catching(t).warn(e)}catch(t){}})},e.logWarn=function(t,e){var n=this;r("MqttEnv").Env.scheduleLoggingCallback(function(){try{n.$1.warn(t,e)}catch(t){}})},e.debugTrace=function(t,e){var n=this;r("MqttEnv").Env.scheduleLoggingCallback(function(){try{n.$1.debug(t,e)}catch(t){}})},e.bumpCounter=function(t){var e=this;r("Random").coinflip(u)&&r("MqttEnv").Env.scheduleLoggingCallback(function(){0!==e.$2&&r("ODS").bumpEntityKey(2966,"mqtt_ws_client",e.$2+"."+t,u),r("ODS").bumpEntityKey(2966,"mqtt_ws_client",t,u)})},e.$9=function(t,e,i){var o=this;r("MqttEnv").Env.scheduleLoggingCallback(function(){e.event_type=t,e.app_id=o.$2,e.online=o.$11();var r=JSON.stringify(e);o.$1.log(t,r,{weight:i}),t!==d.DISCONNECT&&n("MqttWsClientTypedLoggerLite").log(e)})},e.$10=function(t,e,i){(i=!n("gkx")("762")||0===e||(i||r("Random").coinflip(e)))&&r("MqttEnv").Env.scheduleCallback(t)},e.$8=function(t){this.$10(t,0,!1)},e.$11=function(){return!(!c.navigator||void 0===c.navigator.onLine)&&c.navigator.onLine},e.getBrowserConnectivity=function(){return n("NetworkStatus").isOnline()},e.$7=function(){var t=this;if(c.navigator&&void 0!==c.navigator.onLine){var e=function(e){(e=e.online)||t.bumpCounter("browser_disconnect")};n("NetworkStatus").onChange(e)}},t}(),s["default"]=t},98),__d("MqttEnvInitializer",["CurrentUser","MqttEnv","MqttLogger","Random","WebStorage","clearTimeout","gkx","setTimeoutAcrossTransitions"],function(t,e,n,r,i,o){"use strict";var s="mqtt:",a={genGk:function(t){switch(t){case r("MqttEnv").MqttGkNames.mqtt_waterfall_log_client_sampling:return n("gkx")("832242");case r("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled:return!0;case r("MqttEnv").MqttGkNames.mqtt_lp_use_fetch:return n("gkx")("945829");case r("MqttEnv").MqttGkNames.mqtt_fast_lp:return n("gkx")("1001007");case r("MqttEnv").MqttGkNames.mqtt_lp_no_delay:return n("gkx")("1066746");case r("MqttEnv").MqttGkNames.mqtt_enable_publish_over_polling:return n("gkx")("968609");case r("MqttEnv").MqttGkNames.mqttweb_global_connection_counter:return n("gkx")("2795");default:return n("MqttLogger").getInstance().logError(new Error("unknown gk"),"Unknown GK value "+t),!1}},configRead:function(t,e){var r=n("WebStorage").getLocalStorage();return r&&null!=(r=r.getItem(s+t))?r:e},configWrite:function(t,e){var r=n("WebStorage").getLocalStorage();r&&(null==e?r.removeItem(s+t):n("WebStorage").setItemGuarded(r,s+t,e))},initialize:function(){r("MqttEnv").Env.initialize(n("Random").random,n("CurrentUser").isLoggedInNow,n("clearTimeout"),n("setTimeoutAcrossTransitions"),function(){return n("MqttLogger").getInstance()},a.genGk,null,null,null,a.configRead,a.configWrite)}};o.exports=a},34),__d("FBMqttChannel",["MqttChannel","MqttEnvInitializer","MqttWebConfig"],function(t,e,n,r,i,o,s){"use strict";n("MqttEnvInitializer").initialize(),t=new(n("MqttChannel"))({endpoint:n("MqttWebConfig").endpoint,pollingEndpoint:n("MqttWebConfig").pollingEndpoint,userFbid:n("MqttWebConfig").fbid,appId:n("MqttWebConfig").appID,initialSubscribedTopics:n("MqttWebConfig").subscribedTopics,capabilities:n("MqttWebConfig").capabilities,clientCapabilities:n("MqttWebConfig").clientCapabilities,chatVisibility:!1,phpOverride:n("MqttWebConfig").hostNameOverride}),s["default"]=t},98),__d("RtiRequestStreamE2eClientBatchFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(t,e,n,r,i,o,s){"use strict";t=n("getFalcoLogPolicy_DO_NOT_USE")("819"),i=r("FalcoLoggerInternal").create("rti_request_stream_e2e_client_batch",t),s["default"]=i},98),__d("RtiRequestStreamE2eClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],function(t,e,n,r,i,o,s){"use strict";t=n("getFalcoLogPolicy_DO_NOT_USE")("1857112"),i=r("FalcoLoggerInternal").create("rti_request_stream_e2e_client",t),s["default"]=i},98),__d("RequestStreamE2ELogger",["ConstUriUtils","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RtiRequestStreamE2eClientBatchFalcoEvent","RtiRequestStreamE2eClientFalcoEvent"],function(t,e,n,r,i,o,s){"use strict";function a(){var t=Date.now();return c>=t?c+=1:c=t,c.toString()}function t(t,e,n){if(null==t||null==t.method)return null;var r=!1;return l.includes(t.method)&&(r=!0),null==e||0==e.length?null:null==(e=JSON.parse(e)).requestId?null:new h(e.requestId,n,t.method,u(t.method,t),e.requestLogContext,e.forceLogContext,e.sampleRate,e.dgwStreamGroupLoggingId,e.dgwCountPriorStreamsInGroup,r)}function u(t,e){if("FBLQ"===t&&e.config_id)return e.config_id;if("SKY"!==t)return t;if(e.topic){var n=e.topic.lastIndexOf("/");return n>0?e.topic.substr(0,n):e.topic}}function e(t,e,r,i,o,s){if(void 0===o&&(o=null),void 0===s&&(s=null),null!=t&&null!=t.requestId&&null==t.clientLoggingDisabled){var u={request_id:t.requestId,resume_id:"0",transport:e,e2e_sample_rate:t.sampleRate,message_type:r,event:i,timestamp_ms:a(),aux_id:t.auxId,additional_data:o,df_trace_id:s};n("RtiRequestStreamE2eClientFalcoEvent").log(function(){return u})}}var l=["FBGQLS:COMMENT_CREATE_SUBSCRIBE","FBGQLS:COMMENT_LIKE_SUBSCRIBE","FBGQLS:FEEDBACK_COMMENT_PERMISSION_TOGGLE_SUBSCRIBE","FBGQLS:FEEDBACK_TYPING_SUBSCRIBE"],c=0,h=function(){function t(t,e,n,i,o,s,a,u,l,c){this.$10=[],this.$11=!1,this.$1=t,this.$2=e,this.$3=n,this.$4=i,this.$5=o,this.$6=s,this.$7=a,this.$8=u,this.$9=l,this.$12=null!=(t=c)&&t,(e=r("ConstUriUtils").getUri(window.location.href))&&(this.$13=e.getDomain())}var e=t.prototype;return e.logE2EEvent=function(t,e,n,r,i,o){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),"Falco"!==this.$3&&(i={request_id:this.$1,resume_id:"0",retry_id:i,transport:this.$2,method:this.$3,use_case:this.$4,request_log_context:this.$5,force_log_context:this.$6,e2e_sample_rate:this.$7,message_type:t,event:e,timestamp_ms:a(),aux_id:r,additional_data:n,dgw_stream_group_logging_id:this.$8,dgw_count_prior_streams_in_group:this.$9,domain:this.$13,df_trace_id:o},this.$14(i))},e.$14=function(t){if(this.$12){if(this.$10.push(t),this.$11||t.event==n("RequestStreamE2EClientLoggerEvent").FAILURE||t.message_type==n("RequestStreamE2EClientLoggerMessageType").RESPONSE){var e={events:this.$10};n("RtiRequestStreamE2eClientBatchFalcoEvent").log(function(){return e}),this.$10=[],this.$11=!0}}else n("RtiRequestStreamE2eClientFalcoEvent").log(function(){return t})},e.getRequestId=function(){return this.$1},t}();s.RequestStreamE2ELogger=h,s.createStreamLogger=t,s.logRequestStreamE2EEventStatic=e},98),__d("RequestStreamTransport",["$InternalEnum"],function(t,e,n,r,i,o){"use strict";t=e("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]),o.RequestStreamTransport=t},66),__d("BladeRunnerSocket",["BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","MqttPublishListener","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamTransport","justknobx","uuid"],function(t,e,n,r,i,o,s){"use strict";function a(t){var e;switch(t.type){case r("BladeRunnerTypes").StreamFrameType.REQUEST:return null==(e=t.request)?void 0:e.getInstrumentationData();case r("BladeRunnerTypes").StreamFrameType.DATA:return null==(e=t.data)?void 0:e.getInstrumentationData()}return null}function u(t){switch(t.type){case r("BladeRunnerTypes").StreamFrameType.REQUEST:return n("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;case r("BladeRunnerTypes").StreamFrameType.DATA:return n("RequestStreamE2EClientLoggerMessageType").AMENDMENT}return null}function l(t){if(null===t)return null;switch(t){case r("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:return"Accepted";case r("BladeRunnerStreamStatus").StreamStatus.REJECTED:return"Rejected";case r("BladeRunnerStreamStatus").StreamStatus.STARTED:return"Started";case r("BladeRunnerStreamStatus").StreamStatus.STOPPED:return"Stopped";case r("BladeRunnerStreamStatus").StreamStatus.CLOSED:return"Closed"}return null}function c(t){var e={};return null==t||null==(t=t.frames)||t.forEach(function(t){t.type===r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&null!==(t=l(t=null==(t=t.statusUpdate)?void 0:t.status))&&(e.flow_status=t)}),e}function h(t,e){var n;switch(t.type){case r("BladeRunnerTypes").StreamFrameType.REQUEST:e.data_base64_size=null==(n=t.request)?void 0:null==(n=n.payload)?void 0:null==(n=n.length)?void 0:n.toString();break;case r("BladeRunnerTypes").StreamFrameType.DATA:e.data_base64_size=null==(n=t.data)?void 0:null==(e=n.rawDataSize())?void 0:e.toString()}return null}function d(t,e,i){var o=a(t);if(null!=o){var s=u(t);if(null!=s){var l=null;switch(e){case r("MqttPublishListener").MqttPublishEvent.SENT:l=n("RequestStreamE2EClientLoggerEvent").SENT;break;case r("MqttPublishListener").MqttPublishEvent.ACKED:l=n("RequestStreamE2EClientLoggerEvent").PUBACK;break;case r("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case r("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case r("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:l=n("RequestStreamE2EClientLoggerEvent").FAILURE,null==i.reason&&(i.reason=e)}null!=l&&(h(t,i),null!=(null==(e=t.request)?void 0:e.e2eLogger)&&null==o.clientLoggingDisabled?null==(e=t.request)||e.e2eLogger.logE2EEvent(s,l,i,o.auxId):r("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(o,r("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,s,l,i))}}}var f="Connected",g="Disconnected",p="/br_sr",_="/sr_res",m=null;(t=function(){function t(t){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map,this.$7=null!=t?t:n("FBMqttChannel"),this.$8=new Map,n("BladeRunnerLogger").setClientSessionId(n("uuid")()),this.$9()}t.get=function(){return null==m&&(m=new t(n("FBMqttChannel"))),m};var i=t.prototype;return i.sendNewStreamRequest=function(e,r){r=new(n("BladeRunnerEventHandler"))(e,r,this);var i=e.getRequest();this.$6.set(i.streamId,r),this.$10()?this.getStreamCount()<=t.maxStreamCount?this.$12(i):(n("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),n("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(e.getRequest().getHeaders())),this.$11(r,i.streamId)):this.$11(r,i.streamId)},i.sendRetryStreamRequest=function(t){this.$12(t.getRequest())},i.sendCancel=function(t){n("BladeRunnerLogger").bumpCounter("socket_send_cancel");var e=new(r("BladeRunnerTypesInternal").GatewayStreamStatusUpdate);e.streamId=t.streamId,e.status=r("BladeRunnerStreamStatus").StreamStatus.CLOSED,this.$13(e,t),this.removeStream(t.streamId)},i.sendAmendment=function(t,e,i){n("BladeRunnerLogger").bumpCounter("socket_send_amendment")
;var o=new(r("BladeRunnerTypesInternal").GatewayStreamData);o.streamId=t,o.setData(e),null!=i&&(o.instrumentationData=i),this.$14(o)},i.sendAmendmentWithAck=function(t,i,o){var s=this;n("BladeRunnerLogger").bumpCounter("socket_send_amendment");var a=this.$15(),u=new(r("BladeRunnerTypesInternal").GatewayStreamData);return u.streamId=t,u.setData(i),u.shouldAck=!0,u.dataId=a,null!=o&&(u.instrumentationData=o),t=new(e("Promise"))(function(t,e){s.$8.set(a,{resolve:t,reject:e})}),this.$14(u),t},i.$14=function(t){this.$1.push(r("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(t)),this.$16()},i.sendDataAcks=function(t){n("BladeRunnerLogger").bumpCounter("socket_send_data_ack",t.length),this.$17(t)},i.removeStream=function(t){this.$6["delete"](t)},i.getStreamCount=function(){return this.$6.size},i.getNextStreamId=function(){return this.$5++,this.$5},i.onMQTTStateChanged=function(t){this.$16(),t!=g&&t!=f||this.$4==t||(this.$4=t,n("BladeRunnerLogger").info("MQTTStateChanged: "+t),t==g?(n("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):t==f&&n("BladeRunnerLogger").bumpCounter("mqtt_state_connected"))},i.$12=function(t){n("BladeRunnerLogger").bumpCounter("socket_send_request"),this.$1.push(r("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(t)),this.$16()||null==(t=t.e2eLogger)||t.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,n("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"MQTT Not Connected"})},i.$13=function(t,e){this.$1.push(r("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(t)),this.$16()&&(null==(t=e.e2eLogger)||t.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").CANCEL,n("RequestStreamE2EClientLoggerEvent").SENT))},i.$17=function(t){for(var e=0;e<t.length;e++){var n=t[e];this.$1.push(r("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(n))}this.$16()},i.$19=function(){return this.$2++,this.$2},i.$15=function(){return this.$3++,this.$3},i.$16=function(){var t=!1;if(this.$7.getConnectionState()===f&&this.$1.length>0)try{this.$20(this.$1),t=!0}catch(t){}finally{this.$1=[]}return t},i.$20=function(t){var e=this,i=new(r("BladeRunnerTypesInternal").GatewayStreamBatch)(this.$19(),t),o=i.write();if(o.length>this.$21()){var s=Math.floor(t.length/2);if(0===s){t.forEach(function(t){return d(t,r("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR,{reason:"too long"})});var a=new Error("Publish is too long: "+o.length);throw a.stack,this.$22(i,a,"Publish is too long"),a}this.$20(t.slice(0,s)),this.$20(t.slice(s,t.length))}else try{if(n("BladeRunnerLogger").info("send message to "+p+" ("+o.length+" bytes)"),a={qos:1,skipBuffer:!1},i.isInstrumented()){var u=Date.now();a.listener={onEvent:function(e){var n=(Date.now()-u).toString();t.forEach(function(t){d(t,e,{latency:n})})}}}this.$7.publish(p,o,a)["catch"](function(t){e.$22(i,t,"Failed publishing to MQTT")}),n("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(t){throw this.$22(i,t,"Failed publishing to MQTT"),t}},i.$9=function(){var t=this;n("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent),this.onMQTTStateChanged(this.$7.getConnectionState()),this.$7.subscribeChannelEvents({onMQTTStateChanged:function(e){t.onMQTTStateChanged(e)},onJSError:function(t){null!=t&&"boolean"==typeof t.isRecoverable&&t.isRecoverable?n("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(n("BladeRunnerLogger").warn("JS error in MQTTChannel: "+("object"==typeof t&&null!=t?t.toString():"unknown error")+", "+JSON.stringify(t)),n("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}}),this.$7.subscribe(p,function(t){throw new Error("Unexpected response: "+p+" "+t.toString())}),this.$7.subscribe(_,function(e){t.$23(e)})},i.$23=function(t){t=r("BladeRunnerTypesInternal").GatewayStreamBatch.read(t),this.processBatch(t)},i.$22=function(t,e,i){t=t.getFrames();var o=Array.isArray(t),s=0;for(t=o?t:t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var a;if(o){if(s>=t.length)break;a=t[s++]}else{if((s=t.next()).done)break;a=s.value}if((a=a).type===r("BladeRunnerTypes").StreamFrameType.REQUEST){var u=a.getRequest(),l=this.$6.get(u.streamId);null!=l&&this.$24(l,u.streamId,r("BladeRunnerStreamStatus").StreamStatus.CLOSED,!0,null)}else a.type===r("BladeRunnerTypes").StreamFrameType.DATA&&(u=(l=a.getData()).dataId,null!=l.shouldAck&&l.shouldAck&&null!=u&&((a=new(r("BladeRunnerTypesInternal").GatewayStreamDataAck)).streamId=l.streamId,a.dataId=u,a.success=!1,a.code=r("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND,a.message=i,this.$25(a)))}n("BladeRunnerLogger").info("Failed publishing to MQTT: "+e.message),n("BladeRunnerLogger").bumpCounter("mqtt_publish_error")},i.$25=function(t){var e=this.$8.get(t.dataId);null!=e&&(this.$8["delete"](t.dataId),t.success?e.resolve(!0):t.code===r("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?e.resolve(!1):e.reject(t.message))},i.processBatch=function(t){try{r("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(t.getInstrumentationData(),r("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,n("RequestStreamE2EClientLoggerMessageType").RESPONSE,n("RequestStreamE2EClientLoggerEvent").RECEIVED,c(t),t.getInstrumentationDataDfTraceId()),n("BladeRunnerLogger").bumpCounter("socket_process_batch");var e=JSON.stringify(t);n("BladeRunnerLogger").info("Received batch ("+e.length+" bytes)"),e=null;var i=t.getFrames(),o=Array.isArray(i),s=0;for(i=o?i:i["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var a;if(o){if(s>=i.length)break;a=i[s++]}else{if((s=i.next()).done)break;a=s.value}var u=(a=a).getStreamId();if(null==e&&(e=u),null!=u&&e!=u)throw new Error("Received batch with frames for multiple streams");a.type==r("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$25(a.getDataAck())}null!=e?null!=(u=this.$6.get(e))?u.onProxyResponse(t):n("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+e):n("BladeRunnerLogger").info("Received batch with no frames")}catch(t){throw n("BladeRunnerLogger").exception(t,"Failed processing batch from MQTT"),n("BladeRunnerLogger").bumpCounter("socket_process_batch_error"),t}},i.$18=function(){this.$6.forEach(function(t){t.onDisconnect()})},i.$11=function(t,e){this.$24(t,e,r("BladeRunnerStreamStatus").StreamStatus.REJECTED,!1,0)},i.$24=function(t,e,n,i,o){var s=new(r("BladeRunnerTypesInternal").GatewayStreamStatusUpdate);s.streamId=e,s.status=n,s.shouldRetry=i,s.retryDelayMs=o,e=new(r("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[r("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(s)]),t.onProxyResponse(e)},i.$10=function(){return!!n("CurrentUser").isLoggedIn()||(n("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out"),!1)},i.$21=function(){var t=1048576,e=524288;try{e=n("justknobx")._("317")*t}catch(t){}return Math.max(e-1024,0)},t}()).maxStreamCount=2e3,s["default"]=t},98),__d("BladeRunnerStream",["Promise","regeneratorRuntime"],function(t,e,n,r,i,o){t=function(){function t(t){this.$1=t}var n=t.prototype;return n.getStreamHandler=function(){return this.$1},n.cancel=function(){},n.amendWithAck=function(){return e("regeneratorRuntime").async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!1);case 1:case"end":return t.stop()}},null,this)},n.amendFireAndForget=function(){},n.amendWithoutAck=function(){},n.start=function(){return e("Promise").resolve()},n.isAlive=function(){return!1},n.canAmend=function(){return!1},n.getStatus=function(){return null},n.getStreamId=function(){return 0},t}(),o["default"]=t},66),__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes"],function(t,e,n,r,i,o,s){t=function(){function t(t){this.$1=t,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var e=t.prototype;return e.getRequest=function(){return this.$1},e.updateRetryRequestPayload=function(t){this.$1.updateRetryRequestPayload(t)},e.isAlive=function(){return!(this.$2==r("BladeRunnerStreamStatus").StreamStatus.CLOSED||this.$2==r("BladeRunnerStreamStatus").StreamStatus.REJECTED)},e.canAmend=function(){return this.$2==r("BladeRunnerStreamStatus").StreamStatus.ACCEPTED||this.$2==r("BladeRunnerStreamStatus").StreamStatus.STARTED||this.$2==r("BladeRunnerStreamStatus").StreamStatus.STOPPED},e.getLastStatus=function(){return this.$2},e.setLastStatus=function(t){this.$2=t},e.onError=function(){this.$3+=1},e.getErrorCount=function(){return this.$3},e.resetErrors=function(){this.$3=0},e.getRetryRequestScheduled=function(){return this.$6},e.setRetryRequestScheduled=function(t){this.$6=t},e.witnessFrame=function(t){switch(t.type){case r("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var e=t.getStatusUpdate(),n=!0;switch(e.status){case r("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:n=!this.$4,this.$4||(this.$4=!0);break;case r("BladeRunnerStreamStatus").StreamStatus.STARTED:n=this.getLastStatus()!=r("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case r("BladeRunnerStreamStatus").StreamStatus.STOPPED:n=this.getLastStatus()==r("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case r("BladeRunnerStreamStatus").StreamStatus.CLOSED:case r("BladeRunnerStreamStatus").StreamStatus.REJECTED:default:n=!0}return this.setLastStatus(e.status),n;case r("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:return this.$7(t.getRewriteRequest()),!1;default:return!0}},e.setRetriesAllowed=function(t){this.$5=t},e.getRetriesAllowed=function(){return this.$5},e.$7=function(t){if(null==t.temporary&&1!=t.temporary){if(null!=t.newBody&&(this.$1.payload=t.newBody),null!=t.newExtraHeader&&(this.$1.extraHeader=t.newExtraHeader,this.$1.headers=JSON.parse(t.newExtraHeader)),null!=t.patchExtraHeader)try{var e=JSON.parse(t.patchExtraHeader),r=null!=this.$1.extraHeader?JSON.parse(this.$1.extraHeader):{};null==this.$1.headers&&(this.$1.headers={});for(var i=Object.keys(e),o=0;o<i.length;o++){var s=i[o];this.$1.headers[s]=e[s],r[s]=e[s]}this.$1.extraHeader=JSON.stringify(r)}catch(e){n("BladeRunnerLogger").warn("Failed to patch header: "+t.patchExtraHeader)}null!=t.killBody&&1==t.killBody&&(this.$1.payload=null)}},t}(),s["default"]=t},98),__d("BladeRunnerSocketStream",["BladeRunnerStream","BladeRunnerStreamState","BladeRunnerStreamStatus","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","regeneratorRuntime","uuid"],function(t,e,n,r,i,o,s){var a=4,u={reason:"stream_dead"};t=function(t){function i(e,r,i){return(e=t.call(this,e)||this).$BladeRunnerSocketStream1=i,e.$BladeRunnerSocketStream2=new(n("BladeRunnerStreamState"))(r),e.$BladeRunnerSocketStream2.setRetriesAllowed(a),e}babelHelpers.inheritsLoose(i,t);var o=i.prototype;return o.start=function(){var t=this;return new(e("Promise"))(function(e){t.send(),e()})},o.send=function(){var t,e=this.$BladeRunnerSocketStream2.getRequest();null==(t=e.e2eLogger)||t.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,n("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_base64_size:null==(t=e.payload)?void 0:null==(e=t.length)?void 0:e.toString()}),this.$BladeRunnerSocketStream1.sendNewStreamRequest(this.$BladeRunnerSocketStream2,this.getStreamHandler())},o.amendWithAck=function(t){var r,i,o,s,a,l,c;return e("regeneratorRuntime").async(function(h){for(;;)switch(h.prev=h.next){case 0:if(i=this.$BladeRunnerSocketStream2.getRequest(),(o=i.getInstrumentationData())&&(o.auxId=n("uuid")(),null==(s=i.e2eLogger)||s.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").AMENDMENT,n("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:null==t?void 0:null==(a=t.length)?void 0:a.toString()},o.auxId)),!this.canAmend()){h.next=6;break}return o&&(null==(l=i.e2eLogger)||l.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").AMENDMENT,n("RequestStreamE2EClientLoggerEvent").SENT,{data_size:null==t?void 0:null==(c=t.length)?void 0:c.toString()},o.auxId)),h.abrupt("return",this.$BladeRunnerSocketStream1.sendAmendmentWithAck(i.streamId,this.$BladeRunnerSocketStream3(t),null==o?null:JSON.stringify(o)));case 6:return null==(r=i.e2eLogger)||r.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").AMENDMENT,n("RequestStreamE2EClientLoggerEvent").FAILURE,u,null==o?void 0:o.auxId),h.abrupt("return",e("Promise").reject("Stream is closed or not accepted"));case 8:case"end":return h.stop()}},null,this)},o.amendFireAndForget=function(t){var e,r=this.$BladeRunnerSocketStream2.getRequest(),i=r.getInstrumentationData();i&&(i.auxId=n("uuid")(),null==(e=r.e2eLogger)||e.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").AMENDMENT,n("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:null==t?void 0:null==(e=t.length)?void 0:e.toString()},i.auxId));if(!this.canAmend())throw null==(t=r.e2eLogger)||t.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").AMENDMENT,n("RequestStreamE2EClientLoggerEvent").FAILURE,u,null==i?void 0:i.auxId),new Error("Stream is closed or not accepted");this.$BladeRunnerSocketStream1.sendAmendment(this.$BladeRunnerSocketStream2.getRequest().streamId,this.$BladeRunnerSocketStream3(t),null==i?null:JSON.stringify(i)),i&&(null==(e=r.e2eLogger)||e.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").AMENDMENT,n("RequestStreamE2EClientLoggerEvent").SENT,{data_size:null==t?void 0:null==(e=t.length)?void 0:e.toString()},i.auxId))},o.amendWithoutAck=function(t){this.amendFireAndForget(t)},o.$BladeRunnerSocketStream3=function(t){return"object"==typeof t?btoa(new TextDecoder("utf8").decode(t)):t},o.cancel=function(){var t=this.$BladeRunnerSocketStream2.getRequest();null==(t=t.e2eLogger)||t.logE2EEvent(n("RequestStreamE2EClientLoggerMessageType").CANCEL,n("RequestStreamE2EClientLoggerEvent").RECEIVED),this.isAlive()&&(this.$BladeRunnerSocketStream1.sendCancel(this.$BladeRunnerSocketStream2.getRequest()),this.$BladeRunnerSocketStream2.setLastStatus(r("BladeRunnerStreamStatus").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())},o.isAlive=function(){return this.$BladeRunnerSocketStream2.isAlive()},o.canAmend=function(){return this.$BladeRunnerSocketStream2.canAmend()},o.getStatus=function(){return this.$BladeRunnerSocketStream2.getLastStatus()},o.getStreamId=function(){return this.$BladeRunnerSocketStream2.getRequest().streamId},i}(n("BladeRunnerStream")),s["default"]=t},98),__d("RequestStreamE2ESampling",["invariant","Random","RequestStreamE2EClientSamplingConfig","uuid"],function(t,e,n,r,i,o,s,a){"use strict";function u(t){return null!=t&&(null!=t.requestId&&"string"==typeof t.requestId&&null!=t.forceLogContext&&"string"==typeof t.forceLogContext)}function l(t,e){var r=n("RequestStreamE2EClientSamplingConfig").sampleRate;return r>1&&null!=t&&(0==(t=n("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[t])?r=0:null!=t&&(r/=t)),1==r?1:r/e}function c(t,e,r,i){var o=n("uuid")();for((null==e.requestId||""===e.requestId||"string"!=typeof e.requestId)&&(null!=t.requestId&&"string"==typeof t.requestId?e.requestId=t.requestId:e.requestId=o),e.requestId+="/_"+o.substring(0,4),e.resumeId="0",e.sampleRate=null!=r?r:void 0,o="",null!=i&&i.length>0&&(o=i),o.length>0&&(null!=e.requestLogContext&&e.requestLogContext.length>0?e.requestLogContext+=":":e.requestLogContext="",e.requestLogContext+=o),"Falco"===(null==t?void 0:t.method)&&(e.clientLoggingDisabled="Falco"),r={},i=Object.keys(e).sort(),t=0,i=(o=Array.isArray(i))?i:i["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var s;if(o){if(t>=i.length)break;s=i[t++]}else{if((t=i.next()).done)break;s=t.value}r[s=s]=e[s]}return JSON.stringify(r)}function t(t,e,r,i){return e&&(!e.requestId.includes("/")&&!e.requestId.includes("#")||a(0,41721)),i=l(t.method,null!=(i=i)?i:1),n("Random").coinflip(i)?c(t,e||{requestId:""},i,r):u(e)?c(t,e||{requestId:""},null,r):""}s.isForceLogged=u,s.getSampleRateForLogging=l,s.normalizeInstrumentationData=c,s.validateInstrumentationData=t},98),__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamTransport","cr:2046346"],function(t,e,n,r,i,o,s){t=function(){function t(t,e){this.$2=r("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,this.$1=null!=t?t:n("BladeRunnerSocket").get(),e&&(this.$2=e)}var i=t.prototype;return i.createStream=function(t,e,n,r){return this.$3(t,e,n,r)},i.requestStream=function(t,n,r,i){return(t=this.$3(t,n,r,i)).send(),null!=e("cr:2046346")&&e("cr:2046346").startPulsarTest(),t},i.logInfo=function(t){n("BladeRunnerLogger").info(t)},i.bumpCounter=function(t){n("BladeRunnerLogger").bumpCounter(t)},i.$3=function(t,e,i,o){var s=new(r("BladeRunnerTypesInternal").GatewayStreamRequest);return s.streamId=this.$1.getNextStreamId(),s.requestType=r("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER,s.headers=n("BladeRunnerConfig").patchRequestHeaders(t),s.extraHeader=JSON.stringify(s.headers),s.payload=null!=e?n("Base64").encode(e):null,null!=o&&(o.transport="WEB_RS_MQTT"),s.instrumentationData=r("RequestStreamE2ESampling").validateInstrumentationData(s.headers||{},o),s.e2eLogger=r("RequestStreamE2ELogger").createStreamLogger(s.headers,s.instrumentationData,this.$2),new(n("BladeRunnerSocketStream"))(i,s,this.$1)},t}(),s["default"]=t},98),__d("InflightAmends",["Deferred","err"],function(t,e,n,r,i,o,s){"use strict";var a="inflight_amends_timeout",u="inflight_amends_duplicate_id";t=function(){function t(t,e,n){this.$1=t,this.$3=e,this.$4=n,this.$2=new Map}var e=t.prototype;return e.add=function(t){var e=this;if(this.$2.has(t))throw n("err")(u);var r=new(n("Deferred")),i=Date.now(),o=setTimeout(function(){e.$2.has(t)&&e.reject(t,n("err")(a))},this.$1);return this.$2.set(t,{id:t,deferred:r,createdTimestampMs:i,timeoutId:o}),r.getPromise()},e.getPromise=function(t){return null==(t=this.$5(t))?void 0:t.deferred.getPromise()},e.resolve=function(t,e){(t=this.$5(t))&&(null==t.deferred.resolve||t.deferred.resolve(e),this.$3(t.id,Date.now()-t.createdTimestampMs),this.$6(t))},e.reject=function(t,e){(t=this.$5(t))&&(null==t.deferred.reject||t.deferred.reject(e),this.$4(t.id,e),this.$6(t))},e.rejectAll=function(t){var e=this.$2.entries(),n=Array.isArray(e),r=0;for(e=n?e:e["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var i;if(n){if(r>=e.length)break;i=e[r++]}else{if((r=e.next()).done)break;i=r.value}var o=(i=i)[0];i[1],this.reject(o,t)}},e.getSize=function(){return this.$2.size},e.getAllPromises=function(){var t=[],e=this.$2.values(),n=Array.isArray(e),r=0;for(e=n?e:e["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var i;if(n){if(r>=e.length)break;i=e[r++]}else{if((r=e.next()).done)break;i=r.value}i=i,t.push(i.deferred.getPromise())}return t},e.$6=function(t){clearTimeout(t.timeoutId),this.$2["delete"](t.id)},e.$5=function(t){return this.$2.get(t)},t}(),s["default"]=t},98),__d("ThriftTypes",[],function(t,e,n,r,i,o){e=Object.freeze({STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,STRUCT:12,MAP:13,SET:14,LIST:15,FLOAT:19}),o["default"]=e},66),__d("TWriteBuffer",[],function(t,e,n,r,i,o){(t=function(){function t(e){void 0===e&&(e=t.DEFAULT_BYTE_BUFFER_SIZE),this.$1=new DataView(new ArrayBuffer(e)),this.$2=0}var e=t.prototype;return e.write=function(t){this.$2+t.length>this.$1.byteLength&&this.$3(this.$2+t.length);for(var e=0;e<t.length;e++)this.$1.setUint8(this.$2+e,t[e]);return this.$2+=t.length,t.length},e.writeByte=function(t){return this.$2+1>this.$1.byteLength&&this.$3(this.$2+1),this.$1.setUint8(this.$2,t),this.$2++,1},e.writeFloatBE=function(t){return this.$2+Float32Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float32Array.BYTES_PER_ELEMENT),this.$1.setFloat32(this.$2,t),this.$2+=Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT},e.writeDoubleBE=function(t){return this.$2+Float64Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float64Array.BYTES_PER_ELEMENT),this.$1.setFloat64(this.$2,t),this.$2+=Float64Array.BYTES_PER_ELEMENT,Float64Array.BYTES_PER_ELEMENT},e.toByteArray=function(){return new Uint8Array(this.$1.buffer,0,this.$2)},e.currentSize=function(){return this.$2},e.getUnderlyingDataView=function(){return this.$1},e.$3=function(t){if(t*=2,!Number.isSafeInteger(t))throw new Error("unable to resize");t=new DataView(new ArrayBuffer(t));for(var e=0;e<this.$2;e++)t.setUint8(e,this.$1.getUint8(e));this.$1=t},e.readByte=function(){throw new Error("operation not supported")},e.readBytes=function(){throw new Error("operation not supported")},e.readFloatBE=function(){throw new Error("operation not supported")},e.readDoubleBE=function(){throw new Error("operation not supported")},t}()).DEFAULT_BYTE_BUFFER_SIZE=16,o["default"]=t},66),__d("StringToUtf8",["TWriteBuffer"],function(t,e,n,r,i,o,s){t=function(t){for(var e,r=new(n("TWriteBuffer"))(t.length),i=0;i<t.length;i++)if((e=t.charCodeAt(i))<128)r.writeByte(e);else if(e<2048)r.writeByte(e>>6|192),r.writeByte(63&e|128);else if(55296==(64512&e)){if(i+1>=t.length)throw new Error("UTF-16 string is truncated: ["+e.toString(16)+"]");if(56320!=(64512&t.charCodeAt(i+1)))throw new Error("Invalid UTF-16 string: ["+e.toString(16)+", "+t.charCodeAt(i+1).toString(16)+"]");e=65536+((1023&e)<<10)+(1023&t.charCodeAt(++i)),r.writeByte(e>>18|240),r.writeByte(e>>12&63|128),r.writeByte(e>>6&63|128),r.writeByte(63&e|128)}else r.writeByte(e>>12|224),r.writeByte(e>>6&63|128),r.writeByte(63&e|128);return r.toByteArray()},s.StringToUtf8=t},98),__d("Utf8ToString",[],function(t,e,n,r,i,o){var s=function(t,e){throw new Error(t+": ["+e.map(function(t){return t.toString(16)}).toString()+"]")},a=function(t){s("Invalid UTF-8 sequence",t)},u=function(t,e){s("Not enough bytes for "+t+"-byte sequence",e)};t=function(t){for(var e=0,n=[];e<t.length;){var r=t[e++];if(r<128)n.push(String.fromCharCode(r));else if(r>=128&&r<194)a([r]);else if(r>=194&&r<224){e>=t.length&&u(2,[r]);var i=t[e++];128!=(192&i)&&a([r,i]),n.push(String.fromCharCode((31&r)<<6|63&i))}else if(r>=240&&r<245){e+2>=t.length&&u(4,[r]),i=t[e++];var o=t[e++],s=t[e++];(240==r&&(!(i>=144&&i<192)||128!=(192&o)||128!=(192&s))||r>=241&&r<244&&(128!=(192&i)||128!=(192&o)||128!=(192&s))||244==r&&(!(i>=128&&i<144)||128!=(192&o)||128!=(192&s)))&&a([r,i,o,s]),i=((7&r)<<18|(63&i)<<12|(63&o)<<6|63&s)-65536,n.push(String.fromCharCode(55296+(i>>10))),n.push(String.fromCharCode(56320+(1023&i)))}else r>=245?a([r]):(e+1>=t.length&&u(3,[r]),o=t[e++],s=t[e++],224==r?o>=160&&o<192||a([r,o,s]):r>=225&&r<237?o>=128&&o<192||a([r,o,s]):237==r?o>=128&&o<160||a([r,o,s]):r>=238&&r<240&&(o>=128&&o<192||a([r,o,s])),s>=128&&s<192||a([r,o,s]),n.push(String.fromCharCode((15&r)<<12|(63&o)<<6|63&s)))}return n.join("")},o.Utf8ToString=t},66),__d("jsbi",[],function(t,e,n,r,i,o){!function(t,e){"object"==typeof o&&void 0!==i?i.exports=e():"function"==typeof define&&define.amd?define(e):t.JSBI=e()}(this,function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n,r=0;r<e.length;r++)(n=e[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function u(){return(u=a()?Reflect.construct:function(t,e,n){var r=[null];return r.push.apply(r,e),t=new(e=Function.bind.apply(t,r)),n&&s(t,n.prototype),t}).apply(null,arguments)}function l(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function c(t){var e="function"==typeof Map?new Map:void 0;return(c=function(t){function n(){return u(t,arguments,o(this).constructor)}if(null===t||!l(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),s(n,t)})(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?h(t):e}var f=function(n){function s(t,n){if(e(this,s),t>s.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return(t=d(this,o(s).call(this,t))).sign=n,t}var a=Math.abs,u=Math.max,l=Math.imul,c=Math.clz32;return i(s,n),r(s,[{key:"toDebugString",value:function(){var t=["BigInt["],e=!0,n=!1,r=void 0;try{for(var i,o=this[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)i=i.value,t.push((i?(i>>>0).toString(16):i)+", ")}catch(t){n=!0,r=t}finally{try{e||null==o["return"]||o["return"]()}finally{if(n)throw r}}return t.push("]"),t.join("")}},{key:"toString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>t||36<t)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(t&t-1)?s.__toStringBasePowerOfTwo(this,t):s.__toStringGeneric(this,t,!1)}},{key:"__copy",value:function(){for(var t=new s(this.length,this.sign),e=0;e<this.length;e++)t[e]=this[e];return t}},{key:"__trim",value:function(){for(var t=this.length,e=this[t-1];0===e;)e=this[--t-1],this.pop();return 0===t&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var t=0;t<this.length;t++)this[t]=0}},{key:"__clzmsd",value:function(){return c(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(t,e,n){n>this.length&&(n=this.length);for(var r=65535&t,i=(t=t>>>16,0),o=65535&e,s=(e=e>>>16,0);s<n;s++){var a=this.__digit(s),u=65535&a;a>>>=16;var c=l(u,r);u=l(u,t);var h=l(a,r),d=o+(65535&c);i=(o=(u>>>16)+(h>>>16)+(65535&(a=l(a,t)))+((c=e+i+(d>>>16)+(c>>>16)+(65535&u)+(65535&h))>>>16))>>>16,o&=65535,e=a>>>16,this.__setDigit(s,65535&d|c<<16)}if(0!==i||0!==o||0!==e)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(t,e,n){for(var r,i=0,o=0;o<n;o++)i=(r=this.__halfDigit(e+o)+t.__halfDigit(o)+i)>>>16,this.__setHalfDigit(e+o,r);return i}},{key:"__inplaceSub",value:function(t,e,n){var r=0;if(1&e){e>>=1;for(var i=this.__digit(e),o=65535&i,s=0;s<n-1>>>1;s++){var a=t.__digit(s),u=(i>>>16)-(65535&a)-r;r=1&u>>>16,this.__setDigit(e+s,u<<16|65535&o),r=1&(o=(65535&(i=this.__digit(e+s+1)))-(a>>>16)-r)>>>16}if(r=1&(a=(i>>>16)-(65535&(u=t.__digit(s)))-r)>>>16,this.__setDigit(e+s,a<<16|65535&o),e+s+1>=this.length)throw new RangeError("out of bounds");0==(1&n)&&(r=1&(o=(65535&(i=this.__digit(e+s+1)))-(u>>>16)-r)>>>16,this.__setDigit(e+t.length,4294901760&i|65535&o))}else{for(e>>=1,a=0;a<t.length-1;a++)r=1&(o=((s=this.__digit(e+a))>>>16)-((u=t.__digit(a))>>>16)-(r=1&(i=(65535&s)-(65535&u)-r)>>>16))>>>16,this.__setDigit(e+a,o<<16|65535&i);r=1&(o=(65535&(s=this.__digit(e+a)))-(65535&(u=t.__digit(a)))-r)>>>16,i=0,0==(1&n)&&(r=1&(i=(s>>>16)-(u>>>16)-r)>>>16),this.__setDigit(e+a,i<<16|65535&o)}return r}},{key:"__inplaceRightShift",value:function(t){if(0!==t){for(var e,n=this.__digit(0)>>>t,r=this.length-1,i=0;i<r;i++)e=this.__digit(i+1),this.__setDigit(i,e<<32-t|n),n=e>>>t;this.__setDigit(r,n)}}},{key:"__digit",value:function(t){return this[t]}},{key:"__unsignedDigit",value:function(t){return this[t]>>>0}},{key:"__setDigit",value:function(t,e){this[t]=0|e}},{key:"__setDigitGrow",value:function(t,e){this[t]=0|e}},{key:"__halfDigitLength",value:function(){var t=this.length;return 65535>=this.__unsignedDigit(t-1)?2*t-1:2*t}},{key:"__halfDigit",value:function(t){return 65535&this[t>>>1]>>>((1&t)<<4)}},{key:"__setHalfDigit",value:function(t,e){var n=t>>>1,r=this.__digit(n);t=1&t?65535&r|e<<16:4294901760&r|65535&e,this.__setDigit(n,t)}}],[{key:"BigInt",value:function(e){var n=Math.floor,r=Number.isFinite;if("number"==typeof e){if(0===e)return s.__zero();if((0|e)===e)return 0>e?s.__oneDigit(-e,!0):s.__oneDigit(e,!1);if(!r(e)||n(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return s.__fromDouble(e)}if("string"==typeof e){if(null===(r=s.__fromString(e)))throw new SyntaxError("Cannot convert "+e+" to a BigInt");return r}if("boolean"==typeof e)return!0===e?s.__oneDigit(1,!1):s.__zero();if("object"===t(e))return e.constructor===s?e:(n=s.__toPrimitive(e),s.BigInt(n));throw new TypeError("Cannot convert "+e+" to a BigInt")}},{key:"toNumber",value:function(t){var e=t.length;if(0===e)return 0;if(1===e){var n=t.__unsignedDigit(0);return t.sign?-n:n}n=t.__digit(e-1);var r=c(n),i=32*e-r;if(1024<i)return t.sign?-Infinity:1/0;i-=1,n=n,e-=1;var o=32===(r+=1)?0:n<<r;o>>>=12;var a=r-12,u=12<=r?0:n<<20+r;return r=20+r,0<a&&0<e&&(e--,o|=(n=t.__digit(e))>>>32-a,u=n<<a,r=a),0<r&&0<e&&(e--,u|=(n=t.__digit(e))>>>32-r,r-=32),(1===(a=s.__decideRounding(t,r,e,n))||0===a&&1==(1&u))&&(0===(u=u+1>>>0)&&(0!=++o>>>20&&(o=0,1023<++i)))?t.sign?-Infinity:1/0:(r=t.sign?-2147483648:0,i=i+1023<<20,s.__kBitConversionInts[1]=r|i|o,s.__kBitConversionInts[0]=u,s.__kBitConversionDouble[0])}},{key:"unaryMinus",value:function(t){if(0===t.length)return t;var e=t.__copy();return e.sign=!t.sign,e}},{key:"bitwiseNot",value:function(t){return t.sign?s.__absoluteSubOne(t).__trim():s.__absoluteAddOne(t,!0)}},{key:"exponentiate",value:function(t,e){if(e.sign)throw new RangeError("Exponent must be positive");if(0===e.length)return s.__oneDigit(1,!1);if(0===t.length)return t;if(1===t.length&&1===t.__digit(0))return t.sign&&0==(1&e.__digit(0))?s.unaryMinus(t):t;if(1<e.length)throw new RangeError("BigInt too big");if(1===(e=e.__unsignedDigit(0)))return t;if(e>=s.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===t.length&&2===t.__digit(0)){var n=1+(e>>>5),r=t.sign&&0!=(1&e);(r=new s(n,r)).__initializeDigits();var i=1<<(31&e);return r.__setDigit(n-1,i),r}for(n=null,i=t,0!=(1&e)&&(n=t),e>>=1;0!==e;e>>=1)i=s.multiply(i,i),0!=(1&e)&&(n=null===n?i:s.multiply(n,i));return n}},{key:"multiply",value:function(t,e){if(0===t.length)return t;if(0===e.length)return e;var n=t.length+e.length;32<=t.__clzmsd()+e.__clzmsd()&&n--,(n=new s(n,t.sign!==e.sign)).__initializeDigits();for(var r=0;r<t.length;r++)s.__multiplyAccumulate(e,t.__digit(r),n,r);return n.__trim()}},{key:"divide",value:function(t,e){if(0===e.length)throw new RangeError("Division by zero");if(0>s.__absoluteCompare(t,e))return s.__zero();var n=t.sign!==e.sign,r=e.__unsignedDigit(0);if(1===e.length&&65535>=r){if(1===r)return n===t.sign?t:s.unaryMinus(t);r=s.__absoluteDivSmall(t,r,null)}else r=s.__absoluteDivLarge(t,e,!0,!1);return r.sign=n,r.__trim()}},{key:"remainder",value:function(t,e){if(0===e.length)throw new RangeError("Division by zero");if(0>s.__absoluteCompare(t,e))return t;var n=e.__unsignedDigit(0);return 1===e.length&&65535>=n?1===n?s.__zero():0===(n=s.__absoluteModSmall(t,n))?s.__zero():s.__oneDigit(n,t.sign):((n=s.__absoluteDivLarge(t,e,!1,!0)).sign=t.sign,n.__trim())}},{key:"add",value:function(t,e){var n=t.sign;return n===e.sign?s.__absoluteAdd(t,e,n):0<=s.__absoluteCompare(t,e)?s.__absoluteSub(t,e,n):s.__absoluteSub(e,t,!n)}},{key:"subtract",value:function(t,e){var n=t.sign;return n===e.sign?0<=s.__absoluteCompare(t,e)?s.__absoluteSub(t,e,n):s.__absoluteSub(e,t,!n):s.__absoluteAdd(t,e,n)}},{key:"leftShift",value:function(t,e){return 0===e.length||0===t.length?t:e.sign?s.__rightShiftByAbsolute(t,e):s.__leftShiftByAbsolute(t,e)}},{key:"signedRightShift",value:function(t,e){return 0===e.length||0===t.length?t:e.sign?s.__leftShiftByAbsolute(t,e):s.__rightShiftByAbsolute(t,e)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(t,e){return 0>s.__compareToBigInt(t,e)}},{key:"lessThanOrEqual",value:function(t,e){return 0>=s.__compareToBigInt(t,e)}},{key:"greaterThan",value:function(t,e){return 0<s.__compareToBigInt(t,e)}},{key:"greaterThanOrEqual",value:function(t,e){
return 0<=s.__compareToBigInt(t,e)}},{key:"equal",value:function(t,e){if(t.sign!==e.sign)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t.__digit(n)!==e.__digit(n))return!1;return!0}},{key:"notEqual",value:function(t,e){return!s.equal(t,e)}},{key:"bitwiseAnd",value:function(t,e){if(!t.sign&&!e.sign)return s.__absoluteAnd(t,e).__trim();if(t.sign&&e.sign){var n=u(t.length,e.length)+1;n=s.__absoluteSubOne(t,n);var r=s.__absoluteSubOne(e);return n=s.__absoluteOr(n,r,n),s.__absoluteAddOne(n,!0,n).__trim()}return t.sign&&(t=(r=[e,t])[0],e=r[1]),s.__absoluteAndNot(t,s.__absoluteSubOne(e)).__trim()}},{key:"bitwiseXor",value:function(t,e){if(!t.sign&&!e.sign)return s.__absoluteXor(t,e).__trim();if(t.sign&&e.sign){var n=u(t.length,e.length);n=s.__absoluteSubOne(t,n);var r=s.__absoluteSubOne(e);return s.__absoluteXor(n,r,n).__trim()}return r=u(t.length,e.length)+1,t.sign&&(t=(n=[e,t])[0],e=n[1]),n=s.__absoluteSubOne(e,r),n=s.__absoluteXor(n,t,n),s.__absoluteAddOne(n,!0,n).__trim()}},{key:"bitwiseOr",value:function(t,e){var n=u(t.length,e.length);if(!t.sign&&!e.sign)return s.__absoluteOr(t,e).__trim();if(t.sign&&e.sign){var r=s.__absoluteSubOne(t,n),i=s.__absoluteSubOne(e);return r=s.__absoluteAnd(r,i,r),s.__absoluteAddOne(r,!0,r).__trim()}return t.sign&&(t=(i=[e,t])[0],e=i[1]),r=s.__absoluteSubOne(e,n),r=s.__absoluteAndNot(r,t,r),s.__absoluteAddOne(r,!0,r).__trim()}},{key:"asIntN",value:function(t,e){if(0===e.length)return e;if(0===t)return s.__zero();if(t>=s.__kMaxLengthBits)return e;var n=t+31>>>5;if(e.length<n)return e;var r=e.__unsignedDigit(n-1),i=1<<(31&t-1);if(e.length===n&&r<i)return e;if((r&i)!==i)return s.__truncateToNBits(t,e);if(!e.sign)return s.__truncateAndSubFromPowerOfTwo(t,e,!0);if(0==(r&i-1)){for(var o=n-2;0<=o;o--)if(0!==e.__digit(o))return s.__truncateAndSubFromPowerOfTwo(t,e,!1);return e.length===n&&r===i?e:s.__truncateToNBits(t,e)}return s.__truncateAndSubFromPowerOfTwo(t,e,!1)}},{key:"asUintN",value:function(t,e){if(0===e.length)return e;if(0===t)return s.__zero();if(e.sign){if(t>s.__kMaxLengthBits)throw new RangeError("BigInt too big");return s.__truncateAndSubFromPowerOfTwo(t,e,!1)}if(t>=s.__kMaxLengthBits)return e;var n=t+31>>>5;if(e.length<n)return e;var r=31&t;if(e.length==n){if(0==r)return e;if(0==(n=e.__digit(n-1))>>>r)return e}return s.__truncateToNBits(t,e)}},{key:"ADD",value:function(t,e){if(t=s.__toPrimitive(t),e=s.__toPrimitive(e),"string"==typeof t)return"string"!=typeof e&&(e=e.toString()),t+e;if("string"==typeof e)return t.toString()+e;if(t=s.__toNumeric(t),e=s.__toNumeric(e),s.__isBigInt(t)&&s.__isBigInt(e))return s.add(t,e);if("number"==typeof t&&"number"==typeof e)return t+e;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(t,e){return s.__compare(t,e,0)}},{key:"LE",value:function(t,e){return s.__compare(t,e,1)}},{key:"GT",value:function(t,e){return s.__compare(t,e,2)}},{key:"GE",value:function(t,e){return s.__compare(t,e,3)}},{key:"EQ",value:function(e,n){for(;;){if(s.__isBigInt(e))return s.__isBigInt(n)?s.equal(e,n):s.EQ(n,e);if("number"==typeof e){if(s.__isBigInt(n))return s.__equalToNumber(n,e);if("object"!==t(n))return e==n;n=s.__toPrimitive(n)}else if("string"==typeof e){if(s.__isBigInt(n))return null!==(e=s.__fromString(e))&&s.equal(e,n);if("object"!==t(n))return e==n;n=s.__toPrimitive(n)}else if("boolean"==typeof e){if(s.__isBigInt(n))return s.__equalToNumber(n,+e);if("object"!==t(n))return e==n;n=s.__toPrimitive(n)}else if("symbol"===t(e)){if(s.__isBigInt(n))return!1;if("object"!==t(n))return e==n;n=s.__toPrimitive(n)}else{if("object"!==t(e))return e==n;if("object"===t(n)&&n.constructor!==s)return e==n;e=s.__toPrimitive(e)}}}},{key:"NE",value:function(t,e){return!s.EQ(t,e)}},{key:"__zero",value:function(){return new s(0,!1)}},{key:"__oneDigit",value:function(t,e){return(e=new s(1,e)).__setDigit(0,t),e}},{key:"__decideRounding",value:function(t,e,n,r){if(0<e)return-1;if(0>e)e=-e-1;else{if(0===n)return-1;n--,r=t.__digit(n),e=31}if(0==(r&(e=1<<e)))return-1;if(0!=(r&(e-=1)))return 1;for(;0<n;)if(n--,0!==t.__digit(n))return 1;return 0}},{key:"__fromDouble",value:function(t){s.__kBitConversionDouble[0]=t;var e,n=2047&s.__kBitConversionInts[1]>>>20,r=1+((n-=1023)>>>5);t=new s(r,0>t);var i=1048575&s.__kBitConversionInts[1]|1048576,o=s.__kBitConversionInts[0],a=20,u=0;if((n&=31)<a){var l=a-n;u=l+32,e=i>>>l,i=i<<32-l|o>>>l,o<<=32-l}else n===a?(u=32,e=i,i=o):(u=32-(l=n-a),e=i<<l|o>>>32-l,i=o<<l);for(t.__setDigit(r-1,e),n=r-2;0<=n;n--)0<u?(u-=32,e=i,i=o):e=0,t.__setDigit(n,e);return t.__trim()}},{key:"__isWhitespace",value:function(t){return!!(13>=t&&9<=t)||(159>=t?32==t:131071>=t?160==t||5760==t:196607>=t?10>=(t&=131071)||40==t||41==t||47==t||95==t||4096==t:65279==t)}},{key:"__fromString",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=0,r=t.length,i=0;if(i===r)return s.__zero();for(var o=t.charCodeAt(i);s.__isWhitespace(o);){if(++i===r)return s.__zero();o=t.charCodeAt(i)}if(43===o){if(++i===r)return null;o=t.charCodeAt(i),n=1}else if(45===o){if(++i===r)return null;o=t.charCodeAt(i),n=-1}if(0===e){if(e=10,48===o){if(++i===r)return s.__zero();if(88===(o=t.charCodeAt(i))||120===o){if(e=16,++i===r)return null;o=t.charCodeAt(i)}else if(79===o||111===o){if(e=8,++i===r)return null;o=t.charCodeAt(i)}else if(66===o||98===o){if(e=2,++i===r)return null;o=t.charCodeAt(i)}}}else if(16===e&&48===o){if(++i===r)return s.__zero();if(88===(o=t.charCodeAt(i))||120===o){if(++i===r)return null;o=t.charCodeAt(i)}}for(;48===o;){if(++i===r)return s.__zero();o=t.charCodeAt(i)}var a=r-i,u=s.__kMaxBitsPerChar[e],l=s.__kBitsPerCharTableMultiplier-1;if(a>1073741824/u)return null;var c=new s((u*a+l>>>s.__kBitsPerCharTableShift)+31>>>5,!1),h=10>e?e:10,d=10<e?e-10:0;if(0==(e&e-1)){u>>=s.__kBitsPerCharTableShift;var f=[],g=[],p=!1;do{for(var _,m=0,v=0;;){if(o-48>>>0<h)_=o-48;else{if(!((32|o)-97>>>0<d)){p=!0;break}_=(32|o)-87}if(v+=u,m=m<<u|_,++i===r){p=!0;break}if(o=t.charCodeAt(i),32<v+u)break}f.push(m),g.push(v)}while(!p);s.__fillFromParts(c,f,g)}else{c.__initializeDigits();var E=!1,y=0;do{for(var S,b=0,T=1;;){if(o-48>>>0<h)S=o-48;else{if(!((32|o)-97>>>0<d)){E=!0;break}S=(32|o)-87}var $=T*e;if(4294967295<$)break;if(T=$,b=b*e+S,y++,++i===r){E=!0;break}o=t.charCodeAt(i)}var C=u*y+(l=32*s.__kBitsPerCharTableMultiplier-1)>>>s.__kBitsPerCharTableShift+5;c.__inplaceMultiplyAdd(T,b,C)}while(!E)}if(i!==r){if(!s.__isWhitespace(o))return null;for(i++;i<r;i++)if(o=t.charCodeAt(i),!s.__isWhitespace(o))return null}return 0!==n&&10!==e?null:(c.sign=-1===n,c.__trim())}},{key:"__fillFromParts",value:function(t,e,n){for(var r=0,i=0,o=0,s=e.length-1;0<=s;s--){var a=e[s],u=n[s];i|=a<<o,32===(o+=u)?(t.__setDigit(r++,i),o=0,i=0):32<o&&(t.__setDigit(r++,i),i=a>>>u-(o-=32))}if(0!==i){if(r>=t.length)throw new Error("implementation bug");t.__setDigit(r++,i)}for(;r<t.length;r++)t.__setDigit(r,0)}},{key:"__toStringBasePowerOfTwo",value:function(t,e){var n=t.length,r=e-1;r=r=(15&(r=(51&(r=(85&r>>>1)+(85&r))>>>2)+(51&r))>>>4)+(15&r),e-=1;var i=t.__digit(n-1);if(a=0|(32*n-(a=c(i))+r-1)/r,t.sign&&a++,268435456<a)throw new Error("string too long");for(var o=Array(a),a=a-1,u=0,l=0,h=0;h<n-1;h++){var d=t.__digit(h),f=(u|d<<l)&e;for(o[a--]=s.__kConversionChars[f],u=d>>>(f=r-l),l=32-f;l>=r;)o[a--]=s.__kConversionChars[u&e],u>>>=r,l-=r}for(d=(u|i<<l)&e,o[a--]=s.__kConversionChars[d],u=i>>>r-l;0!==u;)o[a--]=s.__kConversionChars[u&e],u>>>=r;if(t.sign&&(o[a--]="-"),-1!==a)throw new Error("implementation bug");return o.join("")}},{key:"__toStringGeneric",value:function(t,e,n){var r,i=t.length;if(0===i)return"";if(1===i){var o=t.__unsignedDigit(0).toString(e);return!1===n&&t.sign&&(o="-"+o),o}o=32*i-c(t.__digit(i-1)),i=s.__kMaxBitsPerChar[e],i-=1,o*=s.__kBitsPerCharTableMultiplier,i=(o=0|(o+=i-1)/i)+1>>1;var a=(o=s.exponentiate(s.__oneDigit(e,!1),s.__oneDigit(i,!1))).__unsignedDigit(0);if(1===o.length&&65535>=a){(r=new s(t.length,!1)).__initializeDigits();for(var u,l=0,h=2*t.length-1;0<=h;h--)u=l<<16|t.__halfDigit(h),r.__setHalfDigit(h,0|u/a),l=0|u%a;u=l.toString(e)}else r=(a=s.__absoluteDivLarge(t,o,!0,!0)).quotient,h=a.remainder.__trim(),u=s.__toStringGeneric(h,e,!0);for(r.__trim(),l=s.__toStringGeneric(r,e,!0);u.length<i;)u="0"+u;return!1===n&&t.sign&&(l="-"+l),l+u}},{key:"__unequalSign",value:function(t){return t?-1:1}},{key:"__absoluteGreater",value:function(t){return t?-1:1}},{key:"__absoluteLess",value:function(t){return t?1:-1}},{key:"__compareToBigInt",value:function(t,e){var n=t.sign;return n!==e.sign?s.__unequalSign(n):0<(t=s.__absoluteCompare(t,e))?s.__absoluteGreater(n):0>t?s.__absoluteLess(n):0}},{key:"__compareToNumber",value:function(t,e){if(!0|e){var n=t.sign,r=0>e;if(n!==r)return s.__unequalSign(n);if(0===t.length){if(r)throw new Error("implementation bug");return 0===e?0:-1}if(1<t.length)return s.__absoluteGreater(n);r=a(e);var i=t.__unsignedDigit(0);return i>r?s.__absoluteGreater(n):i<r?s.__absoluteLess(n):0}return s.__compareToDouble(t,e)}},{key:"__compareToDouble",value:function(t,e){if(e!=e)return e;if(e===1/0)return-1;if(e===-Infinity)return 1;var n=t.sign;if(n!==0>e)return s.__unequalSign(n);if(0===e)throw new Error("implementation bug: should be handled elsewhere");if(0===t.length)return-1;if(s.__kBitConversionDouble[0]=e,2047==(e=2047&s.__kBitConversionInts[1]>>>20))throw new Error("implementation bug: handled elsewhere");if(0>(e-=1023))return s.__absoluteGreater(n);var r=t.length,i=t.__digit(r-1),o=c(i),a=32*r-o;if(a<(e+=1))return s.__absoluteLess(n);if(a>e)return s.__absoluteGreater(n);e=1048576|1048575&s.__kBitConversionInts[1];var u,l=s.__kBitConversionInts[0],h=20;if((o=31-o)!==(a-1)%31)throw new Error("implementation bug");if(a=0,o<h){var d=h-o;a=d+32,u=e>>>d,e=e<<32-d|l>>>d,l<<=32-d}else o===h?(a=32,u=e,e=l):(a=32-(d=o-h),u=e<<d|l>>>32-d,e=l<<d);if((i>>>=0)>(u>>>=0))return s.__absoluteGreater(n);if(i<u)return s.__absoluteLess(n);for(o=r-2;0<=o;o--){if(0<a?(a-=32,u=e>>>0,e=l,l=0):u=0,(h=t.__unsignedDigit(o))>u)return s.__absoluteGreater(n);if(h<u)return s.__absoluteLess(n)}if(0!==e||0!==l){if(0===a)throw new Error("implementation bug");return s.__absoluteLess(n)}return 0}},{key:"__equalToNumber",value:function(t,e){return e|0===e?0===e?0===t.length:1===t.length&&t.sign===0>e&&t.__unsignedDigit(0)===a(e):0===s.__compareToDouble(t,e)}},{key:"__comparisonResultToBool",value:function(t,e){switch(e){case 0:return 0>t;case 1:return 0>=t;case 2:return 0<t;case 3:return 0<=t}throw new Error("unreachable")}},{key:"__compare",value:function(t,e,n){if(t=s.__toPrimitive(t),e=s.__toPrimitive(e),"string"==typeof t&&"string"==typeof e)switch(n){case 0:return t<e;case 1:return t<=e;case 2:return t>e;case 3:return t>=e}if(s.__isBigInt(t)&&"string"==typeof e)return null!==(e=s.__fromString(e))&&s.__comparisonResultToBool(s.__compareToBigInt(t,e),n);if("string"==typeof t&&s.__isBigInt(e))return null!==(t=s.__fromString(t))&&s.__comparisonResultToBool(s.__compareToBigInt(t,e),n);if(t=s.__toNumeric(t),e=s.__toNumeric(e),s.__isBigInt(t)){if(s.__isBigInt(e))return s.__comparisonResultToBool(s.__compareToBigInt(t,e),n);if("number"!=typeof e)throw new Error("implementation bug");return s.__comparisonResultToBool(s.__compareToNumber(t,e),n)}if("number"!=typeof t)throw new Error("implementation bug");if(s.__isBigInt(e))return s.__comparisonResultToBool(s.__compareToNumber(e,t),2^n);if("number"!=typeof e)throw new Error("implementation bug");return 0===n?t<e:1===n?t<=e:2===n?t>e:3===n?t>=e:void 0}},{key:"__absoluteAdd",value:function(t,e,n){if(t.length<e.length)return s.__absoluteAdd(e,t,n);if(0===t.length)return t;if(0===e.length)return t.sign===n?t:s.unaryMinus(t);var r=t.length;(0===t.__clzmsd()||e.length===t.length&&0===e.__clzmsd())&&r++;r=new s(r,n),n=0;for(var i=0;i<e.length;i++){var o=e.__digit(i),a=t.__digit(i),u=(65535&a)+(65535&o)+n;n=(a=(a>>>16)+(o>>>16)+(u>>>16))>>>16,r.__setDigit(i,65535&u|a<<16)}for(;i<t.length;i++)n=(a=((o=t.__digit(i))>>>16)+((u=(65535&o)+n)>>>16))>>>16,r.__setDigit(i,65535&u|a<<16);return i<r.length&&r.__setDigit(i,n),r.__trim()}},{key:"__absoluteSub",value:function(t,e,n){if(0===t.length)return t;if(0===e.length)return t.sign===n?t:s.unaryMinus(t);n=new s(t.length,n);for(var r=0,i=0;i<e.length;i++){var o=t.__digit(i),a=e.__digit(i),u=(65535&o)-(65535&a)-r;r=1&(o=(o>>>16)-(a>>>16)-(r=1&u>>>16))>>>16,n.__setDigit(i,65535&u|o<<16)}for(;i<t.length;i++)r=1&(o=((a=t.__digit(i))>>>16)-(r=1&(u=(65535&a)-r)>>>16))>>>16,n.__setDigit(i,65535&u|o<<16);return n.__trim()}},{key:"__absoluteAddOne",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=t.length;null===n?n=new s(r,e):n.sign=e;for(var i=!0,o=0;o<r;o++){var a=t.__digit(o),u=-1===a;i&&(a=0|a+1),i=u,n.__setDigit(o,a)}return i&&n.__setDigitGrow(r,1),n}},{key:"__absoluteSubOne",value:function(t,e){for(var n=t.length,r=new s(e=e||n,!1),i=!0,o=0;o<n;o++){var a=t.__digit(o),u=0===a;i&&(a=0|a-1),i=u,r.__setDigit(o,a)}for(u=n;u<e;u++)r.__setDigit(u,0);return r}},{key:"__absoluteAnd",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=t.length,i=e.length,o=i;if(r<i){o=r;var a=t;t=e,e=a}var u=o;null===n?n=new s(u,!1):u=n.length;for(var l=0;l<o;l++)n.__setDigit(l,t.__digit(l)&e.__digit(l));for(;l<u;l++)n.__setDigit(l,0);return n}},{key:"__absoluteAndNot",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=t.length,i=e.length,o=i;r<i&&(o=r);var a=r;null===n?n=new s(a,!1):a=n.length;for(var u=0;u<o;u++)n.__setDigit(u,t.__digit(u)&~e.__digit(u));for(;u<r;u++)n.__setDigit(u,t.__digit(u));for(;u<a;u++)n.__setDigit(u,0);return n}},{key:"__absoluteOr",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=t.length,i=e.length,o=i;if(r<i){o=r;var a=t;t=e,r=i,e=a}var u=r;null===n?n=new s(u,!1):u=n.length;for(var l=0;l<o;l++)n.__setDigit(l,t.__digit(l)|e.__digit(l));for(;l<r;l++)n.__setDigit(l,t.__digit(l));for(;l<u;l++)n.__setDigit(l,0);return n}},{key:"__absoluteXor",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=t.length,i=e.length,o=i;if(r<i){o=r;var a=t;t=e,r=i,e=a}var u=r;null===n?n=new s(u,!1):u=n.length;for(var l=0;l<o;l++)n.__setDigit(l,t.__digit(l)^e.__digit(l));for(;l<r;l++)n.__setDigit(l,t.__digit(l));for(;l<u;l++)n.__setDigit(l,0);return n}},{key:"__absoluteCompare",value:function(t,e){var n=t.length-e.length;if(0!=n)return n;for(n=t.length-1;0<=n&&t.__digit(n)===e.__digit(n);)n--;return 0>n?0:t.__unsignedDigit(n)>e.__unsignedDigit(n)?1:-1}},{key:"__multiplyAccumulate",value:function(t,e,n,r){if(0!==e){for(var i=65535&e,o=(e=e>>>16,0),s=0,a=0,u=0;u<t.length;u++,r++){var c=n.__digit(r),h=65535&c,d=c>>>16,f=t.__digit(u),g=65535&f;f>>>=16;var p=l(g,i);g=l(g,e);var _=l(f,i);o=(s=(g>>>16)+(_>>>16)+(65535&(f=l(f,e)))+(o=(d+=a+o+((h+=s+(65535&p))>>>16)+(p>>>16)+(65535&g)+(65535&_))>>>16))>>>16,s&=65535,a=f>>>16,c=65535&h|d<<16,n.__setDigit(r,c)}for(;0!==o||0!==s||0!==a;r++)_=((p=n.__digit(r))>>>16)+((g=(65535&p)+s)>>>16)+a+o,s=0,a=0,o=_>>>16,p=65535&g|_<<16,n.__setDigit(r,p)}}},{key:"__internalMultiplyAdd",value:function(t,e,n,r,i){n=n;for(var o=0,s=0;s<r;s++){var a=t.__digit(s),u=l(65535&a,e),c=(65535&u)+o+n;n=c>>>16,n=(u=(65535&(a=l(a>>>16,e)))+(u>>>16)+n)>>>16,o=a>>>16,i.__setDigit(s,u<<16|65535&c)}if(i.length>r)for(i.__setDigit(r++,n+o);r<i.length;)i.__setDigit(r++,0);else if(0!==n+o)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(t,e,n){null===n&&(n=new s(t.length,!1));for(var r=0,i=2*t.length-1;0<=i;i-=2){var o=(r<<16|t.__halfDigit(i))>>>0,a=0|o/e,u=0|(o=((r=0|o%e)<<16|t.__halfDigit(i-1))>>>0)/e;r=0|o%e,n.__setDigit(i>>>1,a<<16|u)}return n}},{key:"__absoluteModSmall",value:function(t,e){for(var n=0,r=2*t.length-1;0<=r;r--)n=0|((n<<16|t.__halfDigit(r))>>>0)%e;return n}},{key:"__absoluteDivLarge",value:function(t,e,n,r){var i=e.__halfDigitLength(),o=e.length,a=t.__halfDigitLength()-i,u=null;n&&(u=new s(a+2>>>1,!1)).__initializeDigits();var c=new s(i+2>>>1,!1);c.__initializeDigits();var h=s.__clz16(e.__halfDigit(i-1));0<h&&(e=s.__specialLeftShift(e,h,0));t=s.__specialLeftShift(t,h,1);var d=e.__halfDigit(i-1),f=0;for(a=a;0<=a;a--){var g=65535;if((p=t.__halfDigit(a+i))!==d){g=0|(p=(p<<16|t.__halfDigit(a+i-1))>>>0)/d;for(var p=0|p%d,_=e.__halfDigit(i-2),m=t.__halfDigit(a+i-2);l(g,_)>>>0>(p<<16|m)>>>0&&(g--,!(65535<(p+=d))););}s.__internalMultiplyAdd(e,g,0,o,c),0!==(_=t.__inplaceSub(c,a,i+1))&&(_=t.__inplaceAdd(e,a,i),t.__setHalfDigit(a+i,t.__halfDigit(a+i)+_),g--),n&&(1&a?f=g<<16:u.__setDigit(a>>>1,f|g))}return r?(t.__inplaceRightShift(h),n?{quotient:u,remainder:t}:t):n?u:void 0}},{key:"__clz16",value:function(t){return c(t)-16}},{key:"__specialLeftShift",value:function(t,e,n){var r=t.length,i=new s(r+n,!1);if(0===e){for(var o=0;o<r;o++)i.__setDigit(o,t.__digit(o));return 0<n&&i.__setDigit(r,0),i}o=0;for(var a,u=0;u<r;u++)a=t.__digit(u),i.__setDigit(u,a<<e|o),o=a>>>32-e;return 0<n&&i.__setDigit(r,o),i}},{key:"__leftShiftByAbsolute",value:function(t,e){if(0>(e=s.__toShiftAmount(e)))throw new RangeError("BigInt too big");var n=e>>>5;e&=31;var r=t.length,i=0!==e&&0!=t.__digit(r-1)>>>32-e,o=new s(l=r+n+(i?1:0),t.sign);if(0===e){for(var a=0;a<n;a++)o.__setDigit(a,0);for(;a<l;a++)o.__setDigit(a,t.__digit(a-n))}else{for(a=0,l=0;l<n;l++)o.__setDigit(l,0);for(var u,l=0;l<r;l++)u=t.__digit(l),o.__setDigit(l+n,u<<e|a),a=u>>>32-e;if(i)o.__setDigit(r+n,a);else if(0!==a)throw new Error("implementation bug")}return o.__trim()}},{key:"__rightShiftByAbsolute",value:function(t,e){var n=t.length,r=t.sign;if(0>(e=s.__toShiftAmount(e)))return s.__rightShiftByMaximum(r);var i=e>>>5;if(e&=31,0>=(l=n-i))return s.__rightShiftByMaximum(r);var o=!1;if(r)if(0!=(t.__digit(i)&(1<<e)-1))o=!0;else for(var a=0;a<i;a++)if(0!==t.__digit(a)){o=!0;break}if(o&&0===e&&0==~(a=t.__digit(n-1))&&l++,a=new s(l,r),0===e)for(l=i;l<n;l++)a.__setDigit(l-i,t.__digit(l));else{r=t.__digit(i)>>>e;var u,l=n-i-1;for(n=0;n<l;n++)u=t.__digit(n+i+1),a.__setDigit(n,u<<32-e|r),r=u>>>e;a.__setDigit(l,r)}return o&&(a=s.__absoluteAddOne(a,!0,a)),a.__trim()}},{key:"__rightShiftByMaximum",value:function(t){return t?s.__oneDigit(1,!0):s.__zero()}},{key:"__toShiftAmount",value:function(t){return 1<t.length?-1:(t=t.__unsignedDigit(0))>s.__kMaxLengthBits?-1:t}},{key:"__toPrimitive",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==t(e))return e;if(e.constructor===s)return e;var r=e[Symbol.toPrimitive];if(r){var i=r(n);if("object"!==t(i))return i;throw new TypeError("Cannot convert object to primitive value")}var o=e.valueOf;if(o){var a=o.call(e);if("object"!==t(a))return a}var u=e.toString;if(u){var l=u.call(e);if("object"!==t(l))return l}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(t){return s.__isBigInt(t)?t:+t}},{key:"__isBigInt",value:function(e){return"object"===t(e)&&e.constructor===s}},{key:"__truncateToNBits",value:function(t,e){for(var n=new s(r=t+31>>>5,e.sign),r=r-1,i=0;i<r;i++)n.__setDigit(i,e.__digit(i));return i=e.__digit(r),0!=(31&t)&&(i=i<<(e=32-(31&t))>>>e),n.__setDigit(r,i),n.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(t,e,n){var r,i=Math.min,o=(n=new s(r=t+31>>>5,n),0),a=0;for(i=i(r=r-1,e.length);o<i;o++){var u=e.__digit(o),l=0-(65535&u)-a;a=1&(u=0-(u>>>16)-(a=1&l>>>16))>>>16,n.__setDigit(o,65535&l|u<<16)}for(;o<r;o++)n.__setDigit(o,0|-a);return l=r<e.length?e.__digit(r):0,0===(u=31&t)?e=65535&(i=0-(65535&l)-a)|(o=0-(l>>>16)-(a=1&i>>>16))<<16:(e=65535&(o=(65535&(i=1<<32-(t=32-u)))-(65535&(l=l<<t>>>t))-a)|(u=(i>>>16)-(l>>>16)-(a=1&o>>>16))<<16,e&=i-1),n.__setDigit(r,e),n.__trim()}},{key:"__digitPow",value:function(t,e){for(var n=1;0<e;)1&e&&(n*=t),e>>>=1,t*=t;return n}}]),s}(c(Array));return f.__kMaxLength=33554432,f.__kMaxLengthBits=f.__kMaxLength<<5,f.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],f.__kBitsPerCharTableShift=5,f.__kBitsPerCharTableMultiplier=1<<f.__kBitsPerCharTableShift,f.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],f.__kBitConversionBuffer=new ArrayBuffer(8),f.__kBitConversionDouble=new Float64Array(f.__kBitConversionBuffer),f.__kBitConversionInts=new Int32Array(f.__kBitConversionBuffer),f})},null),__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],function(t,e,n,r,i,o,s){var a=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),u=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:a.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:a.CT_BOOLEAN_FALSE}),l=[a.CT_STOP,0,a.CT_BOOLEAN_TRUE,a.CT_BYTE,a.CT_DOUBLE,0,a.CT_I16,0,a.CT_I32,0,a.CT_I64,a.CT_BINARY,a.CT_STRUCT,a.CT_MAP,a.CT_SET,a.CT_LIST,0,0,0,a.CT_FLOAT],c=Math.pow(2,7)-1,h=-1*Math.pow(2,7),d=Math.pow(2,15)-1,f=-1*Math.pow(2,15),g=Math.pow(2,31)-1,p=-1*Math.pow(2,31),_=Math.pow(2,32)-1,m=n("jsbi").BigInt("9223372036854775807"),v=n("jsbi").BigInt("-9223372036854775808"),E=n("jsbi").BigInt("18446744073709551615"),y=n("jsbi").BigInt(63),S=n("jsbi").BigInt(1),b=n("jsbi").BigInt(0),T=n("jsbi").BigInt(7),$=n("jsbi").BigInt(70),C=n("jsbi").BigInt(127),w=n("jsbi").BigInt(128),R=Math.pow(2,4);t=function(){function t(t){this.$4=null,this.$5=null,this.$1=t,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var e=t.prototype;return e.readStructBegin=function(){this.$2.push(this.$3),this.$3=0},e.readStructEnd=function(){return this.$3=this.$2.pop(),0},e.writeStructBegin=function(){return this.$2.push(this.$3),this.$3=0,0},e.writeStructEnd=function(){return this.$3=this.$2.pop(),0},e.writeFieldBegin=function(t){return t.ftype===n("ThriftTypes").BOOL?(this.$4={fid:t.fid,fname:t.fname,ftype:t.ftype},0):this.$7(t,u.NONE)},e.writeListBegin=function(t){return this.$8(t)},e.writeListEnd=function(){return 0},e.writeSetBegin=function(t){return this.$8(t)},e.writeSetEnd=function(){return 0},e.writeMapBegin=function(t){var e=0;if(0===t.size)e+=this.$1.writeByte(0);else{if(e+=this.writeVarint32(t.size),null==t.ktype||null==t.vtype)throw new Error("received invalid map info: "+JSON.stringify(t));e+=this.$1.writeByte(this.$9(t.ktype)<<4|this.$9(t.vtype))}return e},e.writeMapEnd=function(){return 0},e.$7=function(t,e){var n=0;return e=e===u.NONE?this.$9(t.ftype):e,t.fid>this.$3&&t.fid-this.$3<=R-1?n+=this.$1.writeByte(t.fid-this.$3<<4|e):(n+=this.$1.writeByte(e),n+=this.writeI16(t.fid)),this.$3=t.fid,n},e.$8=function(t){var e=0,n=this.$9(t.etype);return t.size<=R-2?e+=this.$1.writeByte(t.size<<4|n):(e+=this.$1.writeByte(240|n),e+=this.writeVarint32(t.size)),e},e.readFieldBegin=function(){var t,e=this.$1.readByte(),r=15&e;return r===n("ThriftTypes").STOP?{ftype:n("ThriftTypes").STOP,fid:0}:(t=0===(e=(240&e)>>>4)?this.readI16():this.$3+e,e=this.$10(r),(r===a.CT_BOOLEAN_TRUE||r===a.CT_BOOLEAN_FALSE)&&(this.$5=r===a.CT_BOOLEAN_TRUE),this.$3=t,{ftype:e,fid:t})},e.readListBegin=function(){return this.$11()},e.readListEnd=function(){return 0},e.readSetBegin=function(){return this.$11()},e.readSetEnd=function(){return 0},e.readMapBegin=function(){var t=this.readVarint32();if(t>0){var e=this.$1.readByte(),n=this.$12(e>>4,"readMapBegin:key");return e=this.$12(15&e,"readMapBegin:value"),{ktype:this.$10(n),vtype:this.$10(e),size:t}}return{size:t}},e.readMapEnd=function(){return 0},e.$12=function(t,e){if(t<0||t>13)throw new Error(e+" read invalid compact type: "+t);return t},e.$11=function(){var t=this.$1.readByte(),e=this.$12(15&t,"_readListOrSetBegin");return e=this.$10(e),15===(t=t>>4&15)&&(t=this.readVarint32()),{etype:e,size:t}},e.readFieldEnd=function(){return 0},e.readByte=function(){return this.$6.setUint8(0,this.$1.readByte()),this.$6.getInt8(0)},e.writeByte=function(t){if(t<h||t>c)throw new Error("byte to write is out of range: "+t);return this.$6.setInt8(0,t),this.$1.writeByte(this.$6.getUint8(0))},e.readFloat=function(){return this.$1.readFloatBE()},e.writeFloat=function(t){return this.$1.writeFloatBE(t)},e.readDouble=function(){return this.$1.readDoubleBE()},e.writeDouble=function(t){return this.$1.writeDoubleBE(t)},e.writeString=function(t){return this.writeBinary(r("StringToUtf8").StringToUtf8(t))},e.skip=function(t){switch(t){case n("ThriftTypes").STOP:return;case n("ThriftTypes").BOOL:this.readBool();break;case n("ThriftTypes").BYTE:this.readByte();break;case n("ThriftTypes").DOUBLE:this.readDouble();break;case n("ThriftTypes").I16:this.readI16();break;case n("ThriftTypes").I32:this.readI32();break;case n("ThriftTypes").I64:this.readI64();break;case n("ThriftTypes").STRING:this.readString();break;case n("ThriftTypes").STRUCT:var e;for(this.readStructBegin();(e=this.readFieldBegin()).ftype!==n("ThriftTypes").STOP;)this.skip(e.ftype);this.readStructEnd();break;case n("ThriftTypes").MAP:if((e=this.readMapBegin()).size>0&&null!=e.ktype&&null!=e.vtype)for(var r=e.ktype,i=e.vtype,o=0;o<e.size;o++)this.skip(r),this.skip(i);break;case n("ThriftTypes").SET:case n("ThriftTypes").LIST:for(o=this.$11(),r=0;r<o.size;r++)this.skip(o.etype);break;case n("ThriftTypes").FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+t+" in skip")}},e.toByteArray=function(){return this.$1.toByteArray()},e.writeFieldEnd=function(){return 0},e.writeFieldStop=function(){return this.$1.writeByte(n("ThriftTypes").STOP)},e.writeI16=function(t){if(t<f||t>d)throw new Error("trying to write i16 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},e.readI16=function(){var t=this.zigzagToI32(this.readVarint32());if(t<f||t>d)throw new Error("read invalid i16: "+t);return t},e.writeI32=function(t){if(t<p||t>g)throw new Error("i32 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},e.readI32=function(){return this.zigzagToI32(this.readVarint32())},e.writeI64=function(t){return this.writeVarint64(this.i64ToZigzag(t))},e.readI64=function(){return this.zigzagToI64(this.readVarint64())},e.readBool=function(){var t;return null!=this.$5?(t=this.$5,this.$5=null):t=this.$1.readByte()===a.CT_BOOLEAN_TRUE,t},e.writeBool=function(t){var e=0;return null!=this.$4?(e+=this.$7(this.$4,t?u.CT_BOOLEAN_TRUE:u.CT_BOOLEAN_FALSE),this.$4=null):e+=this.$1.writeByte(t?a.CT_BOOLEAN_TRUE:a.CT_BOOLEAN_FALSE),e},e.readBinary=function(){var t=this.readVarint32();return 0===t?new Uint8Array(0):this.$1.readBytes(t)},e.writeBinary=function(t){var e=0;return e+=this.writeVarint32(t.length),e+=this.$1.write(t)},e.i32ToZigzag=function(t){if(t<p||t>g)throw new Error("number: "+t+" is out of range of i32");return(t<<1^(t<0?4294967295:0))>>>0},e.zigzagToI32=function(t){if(t<0||t>_)throw new Error("number: "+t+" is out of range of uint32");return t>>>1^-1*(1&t)},e.i64ToZigzag=function(t){if(n("jsbi").greaterThan(t,m)||n("jsbi").lessThan(t,v))throw new Error("i64 out of range: "+t.toString());return n("jsbi").bitwiseXor(n("jsbi").signedRightShift(t,y),n("jsbi").leftShift(t,S))},e.zigzagToI64=function(t){if(n("jsbi").lessThan(t,0)||n("jsbi").greaterThan(t,E))throw new Error("invalid uint64: "+t.toString());return n("jsbi").equal(n("jsbi").bitwiseAnd(t,S),S)?n("jsbi").bitwiseNot(n("jsbi").signedRightShift(t,S)):n("jsbi").signedRightShift(t,S)},e.writeVarint32=function(t){if(t<0||t>_)throw new Error("writeVarint32 received out of range uint32: "+t);t=t;for(var e=0;;){if(t>>>7==0){this.$1.writeByte(t),e++;break}this.$1.writeByte(127&t|128),e++,t>>>=7}return e},e.readVarint32=function(){for(var t,e=0,n=0;;){if(e=(e|(127&(t=this.$1.readByte()))<<n)>>>0,n+=7,0==(128&t)){if(35===n&&0!=(240&t))throw new Error("result exceeded 32 bit limit");break}if(n>28)throw new Error("result exceeded 32 bit limit")}return e},e.writeVarint64=function(t){if(n("jsbi").lessThan(t,b)||n("jsbi").greaterThan(t,E))throw new Error("invalid uint64: "+t.toString());t=t;for(var e=0;;){if(n("jsbi").equal(n("jsbi").signedRightShift(t,T),b)){this.$1.writeByte(n("jsbi").toNumber(t)),e++;break}var r=n("jsbi").toNumber(n("jsbi").bitwiseOr(n("jsbi").bitwiseAnd(t,C),w));this.$1.writeByte(r),e++,t=n("jsbi").signedRightShift(t,T)}return e},e.readVarint64=function(){for(var t,e=b,r=b;;){if(t=n("jsbi").BigInt(this.$1.readByte()),e=n("jsbi").bitwiseOr(e,n("jsbi").leftShift(n("jsbi").bitwiseAnd(t,C),r)),r=n("jsbi").add(r,T),n("jsbi").equal(n("jsbi").bitwiseAnd(t,w),b)){if(n("jsbi").equal(r,$)&&n("jsbi").notEqual(t,S))throw new Error("result exceeded 64 bit limit");break}if(n("jsbi").greaterThan(r,y))throw new Error("result exceeded 64 bit limit")}return e},e.readString=function(){return r("Utf8ToString").Utf8ToString(this.readBinary())},e.getLastFieldId=function(){return this.$3},e.getLastField=function(){return this.$2},e.getBooleanFieldInfo=function(){return this.$4},e.getBooleanValue=function(){return this.$5},e.$9=function(t){return l[t]},e.$10=function(t){switch(t){case a.CT_STOP:return n("ThriftTypes").STOP;case a.CT_BOOLEAN_FALSE:case a.CT_BOOLEAN_TRUE:return n("ThriftTypes").BOOL;case a.CT_BYTE:return n("ThriftTypes").BYTE;case a.CT_I16:return n("ThriftTypes").I16;case a.CT_I32:return n("ThriftTypes").I32;case a.CT_I64:return n("ThriftTypes").I64;case a.CT_DOUBLE:return n("ThriftTypes").DOUBLE;case a.CT_FLOAT:return n("ThriftTypes").FLOAT;case a.CT_BINARY:return n("ThriftTypes").STRING;case a.CT_LIST:return n("ThriftTypes").LIST;case a.CT_SET:return n("ThriftTypes").SET;case a.CT_MAP:return n("ThriftTypes").MAP;case a.CT_STRUCT:return n("ThriftTypes").STRUCT;default:throw new Error("don't know what type")}},t}(),s["default"]=t},98),__d("TNoOpWriteBuffer",[],function(t,e,n,r,i,o){t=function(){function t(){this.$1=0}var e=t.prototype;return e.write=function(t){return this.$1+=t.length,t.length},e.writeByte=function(){return this.$1++,1},e.writeFloatBE=function(){return this.$1+=Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT},e.writeDoubleBE=function(){return this.$1+=Float64Array.BYTES_PER_ELEMENT,Float64Array.BYTES_PER_ELEMENT},e.toByteArray=function(){throw new Error("operation not supported")},e.currentSize=function(){return this.$1},e.readByte=function(){throw new Error("operation not supported")},e.readBytes=function(){throw new Error("operation not supported")},e.readFloatBE=function(){throw new Error("operation not supported")},e.readDoubleBE=function(){throw new Error("operation not supported")},t}(),o["default"]=t},66),__d("TReadBuffer",[],function(t,e,n,r,i,o){t=function(){function t(t){this.$1=t,this.$2=0}var e=t.prototype;return e.readByte=function(){if(this.$2<this.$1.length)return this.$1[this.$2++];throw new Error("no available byte to read")},e.readBytes=function(t){if(t<0)throw new Error("cannot readBytes of negative length: "+t);if(t+this.$2>this.$1.length)throw new Error("not enough bytes to read");var e=new Uint8Array(this.$1.buffer,this.$3(),t);return this.$2+=t,e},e.readFloatBE=function(){if(Float32Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var t=new DataView(this.$1.buffer).getFloat32(this.$3());return this.$2+=Float32Array.BYTES_PER_ELEMENT,t},e.readDoubleBE=function(){if(Float64Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var t=new DataView(this.$1.buffer).getFloat64(this.$3());return this.$2+=Float64Array.BYTES_PER_ELEMENT,t},e.$3=function(){return this.$2+this.$1.byteOffset},e.getCurrentCursor=function(){return this.$2},e.writeByte=function(){throw new Error("operation not supported")},e.write=function(){throw new Error("operation not supported")},e.toByteArray=function(){throw new Error("operation not supported")},e.writeFloatBE=function(){throw new Error("operation not supported")},e.writeDoubleBE=function(){throw new Error("operation not supported")},t}(),o["default"]=t},66),__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],function(t,e,n,r,i,o,s){"use strict";function a(t,e){return t=new(n("TReadBuffer"))(t),e(t=new(n("TCompactProtocolPolyfill"))(t))}function t(t,e,n){try{return a(t,e)}catch(t){null!=n&&n(t)}return null}function u(t,e,r){if(void 0===r&&(r=!1),r){r=new(n("TNoOpWriteBuffer"));var i=new(n("TCompactProtocolPolyfill"))(r);e(t,i),i=new(n("TWriteBuffer"))(r.currentSize())}else i=new(n("TWriteBuffer"));return e(t,r=new(n("TCompactProtocolPolyfill"))(i)),r.toByteArray()}function e(t,e,n,r){void 0===n&&(n=!1);try{return u(t,e,n)}catch(t){null!=r&&r(t)}return null}s.deserialize=a,s.deserializeNoThrow=t,s.serialize=u,s.serializeNoThrow=e},98),__d("ContextualConfigConstants",[],function(t,e,n,r,i,o){"use strict";t=1e3,e=", ",n={SAME:"same",
NULL:"null",NNULL:"nnull",CATCH_ALL:"catch_all",EQ:"eq",NEQ:"neq",LT:"lt",LTE:"lte",GT:"gt",GTE:"gte",COR:"cor",CONTAINS:"contains",REGEX:"regex",IN:"in",NIN:"nin"},r={DENSE:"dense",MULTI_OUTPUT_RESOLVED:"multi-output-resolved",TABLE:"table"},i=[];var s=[],a=[],u={BAD_BOOLEAN_FORMAT:"Bad boolean format",BAD_CONFIG:"Bad config",BAD_CONTEXT_IDENTIFIER:"Bad context identifier",BAD_CONTEXT_VALUE:"Bad context value",BAD_MONITORED_CONTEXTS:"Bad monitored contexts",BAD_NUMBER_FORMAT:"Bad number format",BAD_OUTPUT_NAME:"Bad output name",BAD_OUTPUT_TYPE:"Bad output type",BAD_VALUE_ORDER:"Bad values order",DUPLICATE_OUTPUT_NAME:"Duplicate output name",ILLEGAL_BOOLEAN_STRATEGY:"Illegal boolean strategy",ILLEGAL_BUCKET_VALUES:"Illegal bucket values",ILLEGAL_NUMERIC_STRATEGY:"Illegal numeric strategy",ILLEGAL_STRING_STRATEGY:"Illegal string strategy",INVALID_BOOLEAN:"Invalid boolean",INVALID_FLOAT:"Invalid float",INVALID_INTEGER:"Invalid integer",INVALID_STRING:"Invalid string",INVALID_VALUE_TYPE:"Invalid value type",MISMATCH_NUMBER_OF_VALUES:"Mismatching number of values",MISSING_BUCKETS:"Missing buckets",MISSING_BUCKET_MATCH:"Missing bucket match",MISSING_BUCKET_NAME:"Missing bucket name",MISSING_BUCKET_STRATEGY:"Missing bucket strategy",MISSING_CONTEXT_IN_CONFIG:"Missing context in config",MISSING_DEFAULT_VALUE:"Missing default value",MISSING_OUTPUTS_DEFINITION:"Missing outputs field definition",MISSING_RESULTS:"Missing results",MISSING_TABLE:"Missing table",MISSING_TABLE_ITEM_BUCKET:"Missing table item bucket",MISSING_TABLE_ITEM_VALUES:"Missing table item values",MISSING_VECTOR:"Missing vector",REGEX_SYNTAX_ERROR:"Regex syntax error",REQUESTED_PARAM_NOT_FOUND:"Requested param not found",RESULTS_VECTOR_SIZE_MISMATCH:"Results vector size mismatch",UNDECLARED_OUTPUT_PARAM:"Undeclared output param",UNKNOWN_BUCKET_DEFINITION:"Unknown bucket definition",UNKNOWN_CONFIG_TYPE:"Unknown config type",UNSUPPORTED_CONFIG_VERSION:"Unsupported config version"},l=10,c=", ",h={BOOL:"BOOL",FLOAT:"FLOAT",INT:"INT",STRING:"STRING"};o.ANALYTICS_SAMPLE_RATE=t,o.BUCKET_DELIMITER=e,o.CONTEXT_BUCKET_STRATEGY=n,o.CONFIG_TYPE=r,o.EMPTY_RESOLVED_CONTEXTS=i,o.EMPTY_RESOLVED_MONITORS=s,o.EMPTY_RESULT_PARAMS=a,o.ERROR=u,o.JSON_SUB_SAMPLE_RATE=l,o.LIST_DELIMITER=c,o.TYPE=h},66),__d("ContextualConfigValidators",["ContextualConfigConstants"],function(t,e,n,r,i,o,s){"use strict";t=function(t){return Array.isArray(t)},e=function(t){return"boolean"==typeof t},n=function(t){return null!=t},i=function(t){return function(e){return Object.prototype.hasOwnProperty.call(t,e)}},o=function(t){return u(t)&&t%1==0};var a=function(t){return l(t)&&t.length>0},u=function(t){return"number"==typeof t&&!isNaN(t)&&t!==Infinity&&t!==-Infinity},l=function(t){return"string"==typeof t},c=function(t){switch(t){case r("ContextualConfigConstants").TYPE.BOOL:case r("ContextualConfigConstants").TYPE.FLOAT:case r("ContextualConfigConstants").TYPE.INT:case r("ContextualConfigConstants").TYPE.STRING:return!0;default:return!1}};s.isArray=t,s.isBoolean=e,s.isDefined=n,s.isKey=i,s.isInteger=o,s.isNonEmptyString=a,s.isNumber=u,s.isString=l,s.isType=c},98),__d("MarauderLogger",["Banzai","CacheStorage","MarauderConfig"],function(t,e,n,r,i,o){function t(){g().set(w,s())}function s(){return y=y||g().get(w)||0}function a(){O||(S=g().get(R),O=!0);var t=Date.now();return(!S||t-$>s())&&(S=t.toString(16)+"-"+(~~(16777215*Math.random())).toString(16),g().set(R,S)),S}function u(){return{user_agent:window.navigator.userAgent,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,density:window.screen.devicePixelRatio||null,platform:window.navigator.platform||null,locale:window.navigator.language||null}}function l(){return{locale:navigator.language}}function c(t,e,n,r,i,o,s){var a=null!=s&&0!=s?s:Date.now();return y=null!=s&&0!=s?Date.now():a,{name:t,time:a/1e3,module:s=null!=e&&""!=e?e:M,obj_type:r,obj_id:i,uuid:o,extra:n}}function h(t,e,n){return c("content",null,{flags:e},null,null,t,n)}function d(t){var e=window.__mrdr;if(e)for(var n in e){var r=e[n];if(0!==r[3]){if(delete e[n],"1"===n){if(null===k)continue;n=k}t.push(h(n,1,r[1])),t.push(h(n,2,r[2])),t.push(h(n,3,r[3]))}}}function f(t,n){if(d(t),0!==t.length){I&&t.push(c("counters",null,B));var r=e("Banzai").BASIC;"vital"===n&&(r=e("Banzai").VITAL);var i=e("MarauderConfig").gk_enabled;if(0===q&&i&&(t.push(c("device_status",null,l())),r={delay:5e3}),"signal"===n&&(r={signal:!0}),i&&Math.random()<.01&&t.push(c("device_info",null,u())),null!==k)for(n=0;n<t.length;n++)(null===(i=t[n]).uuid||void 0===i.uuid)&&(i.uuid=k);i={app_ver:e("MarauderConfig").app_version,data:t,device_id:void 0,log_type:b,seq:q++,session_id:a()},(n=g().get("device_id"))&&(i.device_id=n),B={},I=!1,e("Banzai").post(C,i,r)}}function g(){return L||(L=new(e("CacheStorage"))("localstorage","")),L}function n(t){B[t]||(B[t]=0),B[t]++,I=!0}function p(t,e,n,r,i,o,s,a){f([c(t,e,n,r,i,o,s)],a)}function _(t,e){M!==e&&(A.push(c(T,M,{dest_module:e,source_url:D,destination_url:t})),M=e,D=t)}function r(t,e){M!==e&&(k=null,_(t,e))}function o(t,e,n){p(e?"show_module":"hide_module",t,n)}function m(t){M=t}function v(){return M}function E(t){null===k&&(k=t,null!==t&&(f(A),A=[]))}var y,S,b="client_event",T="navigation",$=18e4,C="marauder",w="marauder_last_event_time",R="marauder_last_session_id",B={},A=[],I=!1,M=null,D=null,k=null,q=0,O=!1,L=null;e("Banzai").subscribe(e("Banzai").SHUTDOWN,t),i.exports={count:n,log:p,navigateTo:r,navigateWithinSession:_,toggleModule:o,setUUID:E,setNavigationModule:m,getNavigationModule:v}},null),__d("EventProfilerSham",[],function(t,e,n,r,i,o){e={__wrapEventListenHandler:function(t){return t},tagCurrentActiveInteractionsAs:function(){},setCurrentAdAccountId:function(){},setAdsConfig:function(){}},o["default"]=e},66),__d("exponentialBackoff",["MqttEnv"],function(t,e,n,r,i,o,s){function t(t,e){function n(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];var u=function(){t.apply(e,s)};if(null===i){var l=Math.max(0,Math.pow(2,Math.min(o,6))*(1e3+100*r("MqttEnv").Env.random())-2e3);i=r("MqttEnv").Env.setTimeout(function(){u(),i=null},l)}o++}void 0===e&&(e=null);var i=null,o=0;return n.reset=function(){o=0,null!=i&&(r("MqttEnv").Env.clearTimeout(i),i=null)},n.isPending=function(){return null!=i},n}s["default"]=t},98);