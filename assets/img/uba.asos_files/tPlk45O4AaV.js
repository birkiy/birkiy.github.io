__d("PolarisMediaBrowserConstants",[],function(s,o,t,e,i,n){"use strict";s=3,n.POSTS_PER_ROW=s},66),__d("PolarisAdvisoryMessage.react",["cx","joinClasses","react"],function(s,o,t,e,i,n,r){"use strict";function s(s){var o=s.children;return s=s.className,a.jsx("div",{className:t("joinClasses")("_aady",s),children:o})}var a=e("react");s.displayName=s.name+" [from "+n.id+"]",r["default"]=s},98),__d("PolarisPaddedSectionHeader.react",["cx","react"],function(s,o,t,e,i,n,r){"use strict";function s(s){return s=s.children,a.jsx("h2",{className:"_aanc",children:s})}var a=e("react");s.displayName=s.name+" [from "+n.id+"]",r["default"]=s},98),__d("PolarisMediaBrowser.react",["cx","fbt","IGRouter","PolarisAdvisoryMessage.react","PolarisConfig","PolarisLinkBuilder","PolarisMediaBrowserConstants","PolarisMediaImpressionsLogger","PolarisPaddedSectionHeader.react","PolarisSizeCache","PolarisSizing","PolarisUA","PolarisVirtualPostsGrid.react","PolarisVirtualPostsGridConstants","browserHistory","deferredLoadComponent","memoizeStringOnly","nullthrows","polarisGetPostFromGraphMediaInterface","polarisIsUserLoggedIn","polarisPostModalHelpers","polarisUnexpected","react","requireDeferred"],function(s,o,t,e,i,n,r,a,l){"use strict";function p(s,o){return s.topPosts?[].concat(s.topPosts,o):s.posts}function d(s){return s.topPosts?s.posts.filter(function(o){return!(s.topPosts||[]).some(function(s){return s.id===o.id})}):s.posts}function u(s,o){if(o={combinedPosts:[],prevValues:{maxPostsToDisplay:s.maxPostsToDisplay,postsLength:s.posts.length},modalEntryPath:null==o?void 0:o.modalEntryPath,modalPostId:null==o?void 0:o.modalPostId,showModal:!!(null==o?void 0:o.showModal),uniquePosts:[],visibleUniquePostsCount:0},s.posts.length>0||s.topPosts&&s.topPosts.length>0){var t=d(s);if(o.uniquePosts=t,o.combinedPosts=p(s,t),t.length>0){o.earliestPostIdToDisplay=t[0].id,t=t.length;var i=s.isOldestPostLoaded?0:t%e("PolarisMediaBrowserConstants").POSTS_PER_ROW;o.visibleUniquePostsCount=Math.min(t-i,s.maxPostsToDisplay)}}return o}var h=e("react"),c=t("deferredLoadComponent")(t("requireDeferred")("PolarisMediaBrowserPostModal.react").__setRef("PolarisMediaBrowser.react")),P=5,m=12,g=l._("Top posts"),f=l._("Most recent"),C=l._("No posts yet."),v=t("memoizeStringOnly")(function(){return new(t("PolarisSizeCache"))({estimatedSize:e("PolarisVirtualPostsGridConstants").POSTS_ROW_ESTIMATED_HEIGHT})});(s=function(s){function o(o){var i;return(i=s.call(this,o)||this).$6=function(s){i.setState({modalEntryPath:i.props.history.location.pathname,modalPostId:s,showModal:!0})},i.$7=function(s,o){i.$6(s);var n=i.state.combinedPosts.find(function(o){return o.id===s});if(0===(n=null!=n?e("polarisGetPostFromGraphMediaInterface").getPostMediaType(n):0)&&t("polarisUnexpected")("MediaBrowser: missing media type for post modal log event"),e("polarisPostModalHelpers").logPostModalOpen(i.props.analyticsContext,n,"media_browser"),null!=o){var r=(n=i.props).isOldestPostLoaded;n=n.maxPostsToDisplay,!r&&i.state.combinedPosts.length-1-o<=P&&i.props.onPostLoadTargetChange(n+m)}},i.$8=function(s,o,t){var n=i.props,r=n.onIntentClick;n=n.shouldSpawnPostModal,!r||e("polarisIsUserLoggedIn").isUserLoggedIn()||!e("PolarisUA").isDesktop()&&!e("PolarisConfig").isNetzDGEligible()||e("PolarisConfig").isAllowlistedCrawlBot()?!0===n&&e("PolarisSizing").shouldSpawnModals(i.props.viewportWidth)&&(r=i.state.combinedPosts.map(function(s){return s.id}).findIndex(function(s){return s===o.id}),i.$7(o.id,r),s.preventDefault()):(s.preventDefault(),r(i.props.history.location.pathname,"profile_posts",i.props.match.params.username,o.id)),i.props.onClick&&i.props.onClick(o,t)},i.$4=function(s){i.setState({modalEntryPath:null,modalPostId:null,showModal:!1}),i.props.onPostModalClose&&i.props.onPostModalClose(s)},i.$9=function(s){e("PolarisMediaImpressionsLogger").logImpressionForPost(s,"permalink")},i.$5=function(){var s=i.props,o=s.isOldestPostLoaded;s=s.maxPostsToDisplay,o||i.props.onPostLoadTargetChange(s+m)},i.$13=function(s){var o=i.props.loggingData;return null!=(null==o?void 0:o.hashtagName)?babelHelpers["extends"]({},o,{hashtagFeedType:s}):null!=(null==o?void 0:o.entityPageName)?babelHelpers["extends"]({},o,{feedType:s}):{hashtagFeedType:null,feedType:null}},i.$11=function(s){return h.jsx(t("PolarisVirtualPostsGrid.react"),{analyticsContext:i.props.analyticsContext,hasNextPage:!1,isFetching:!1,loggingData:i.$13("top"),mediaLinkBuilder:i.props.mediaLinkBuilder,onClick:i.$8,onImpression:i.props.onImpression,overscanRowsCount:i.props.overscanRowsCount,PostGridItem:i.props.PostGridItem,posts:s,shouldSpawnModals:e("PolarisSizing").shouldSpawnModals(i.props.viewportWidth),sizeCache:i.$3,visibleCount:s?s.length:0},"virtual_top_posts")},i.state=u(o),i.$2=v(i.props.analyticsContext+"_recentPosts"),i.$3=v(i.props.analyticsContext+"_topSetPosts"),i}babelHelpers.inheritsLoose(o,s),o.getDerivedStateFromProps=function(s,o){var t=o.prevValues,e=d(s).map(function(s){return s.id});return!o.uniquePosts.every(function(s){return e.includes(s.id)})||t.maxPostsToDisplay!==s.maxPostsToDisplay?u(s,o):null};var i=o.prototype;return i.componentDidMount=function(){var s=this;this.$1=this.props.history.listen(function(o,t){t===e("browserHistory").ACTION.POP&&s.$4()})},i.componentWillUnmount=function(){this.$1()},i.componentDidUpdate=function(s,o){this.state.uniquePosts.length!==o.uniquePosts.length&&this.state.visibleUniquePostsCount===o.visibleUniquePostsCount&&this.$5()},i.renderPhotosComponent=function(){var s,o,e=this.state,i=e.combinedPosts;return e=e.uniquePosts,this.props.hidePhotoComponentRenderer?null:0!==i.length||this.props.isFetching?(this.props.topPosts&&this.props.topPosts.length>0&&0===this.props.posts.length?(s=this.$10(),o=this.props.noRecentPostExplanation||null):this.props.topPosts&&0===this.props.topPosts.length?(s=this.props.noTopPostExplanation,o=null):0===i.length?s=o=null:0===e.length?(s=null,o=this.props.isTopMediaOnly?this.props.noRecentPostExplanation:this.$11(this.props.topPosts)):(s=this.$10(),o=this.props.isTopMediaOnly?this.props.noRecentPostExplanation:this.props.isMostRecentPostNumLimited?this.$11(this.props.posts):this.$12()),[s,o]):h.jsx(t("PolarisAdvisoryMessage.react"),{className:"_aaq6",children:h.jsx("h2",{className:"_aaq7",children:C})})},i.renderPostModal=function(){var s=t("nullthrows")(this.state.modalPostId);return h.jsx(c,{analyticsContext:this.props.analyticsContext,combinedPosts:this.state.combinedPosts,mediaLinkBuilder:this.props.mediaLinkBuilder,modalEntryPath:this.state.modalEntryPath,onClose:this.$4,onImpression:this.$9,onOpen:this.$7,postId:s})},i.$10=function(){return!this.props.topPosts||this.props.topPosts.length<1?null:[h.jsxs("div",{className:"_aaq8",children:[h.jsx(t("PolarisPaddedSectionHeader.react"),{children:h.jsxs("div",{className:"_aaq9",children:[g,this.props.isSmallScreen&&this.props.postCount&&h.jsx("div",{className:"_aaqa",children:this.props.postCount})]})}),this.$11(this.props.topPosts)]},"top_posts_container"),!this.props.isTopMediaOnly&&this.props.posts.length>0&&h.jsx(t("PolarisPaddedSectionHeader.react"),{children:f},"most_recent_container")]},i.$12=function(){var s;return h.jsx(t("PolarisVirtualPostsGrid.react"),{allowSampledScrollLogging:this.props.allowSampledScrollLogging,analyticsContext:this.props.analyticsContext,hasNextPage:!this.props.isOldestPostLoaded,isFetching:null!=(s=this.props.isFetching)&&s,loggingData:this.$13("recent"),mediaLinkBuilder:this.props.mediaLinkBuilder,onClick:this.$8,onImpression:this.props.onImpression,onNextPage:this.$5,overscanRowsCount:this.props.overscanRowsCount,PostGridItem:this.props.PostGridItem,posts:this.state.uniquePosts,postsPerRow:e("PolarisMediaBrowserConstants").POSTS_PER_ROW,profileUser:this.props.profileUser,shouldSpawnModals:e("PolarisSizing").shouldSpawnModals(this.props.viewportWidth),sizeCache:this.$2,visibleCount:this.state.visibleUniquePostsCount},"virtual_posts_grid")},i.render=function(){return h.jsxs("article",{className:this.props.className,children:[this.props.children,"function"==typeof this.props.photoComponentRenderer?this.props.photoComponentRenderer():this.renderPhotosComponent(),this.state.showModal?this.renderPostModal():null]})},o}(h.Component)).defaultProps={mediaLinkBuilder:e("PolarisLinkBuilder").buildMediaLink,shouldSpawnPostModal:!0},o=e("IGRouter").withIGRouter(s),r["default"]=o},98);